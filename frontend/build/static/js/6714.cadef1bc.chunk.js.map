{"version":3,"file":"static/js/6714.cadef1bc.chunk.js","mappings":"sKAGe,SAASA,IACpB,MAAMC,EAAcC,IAAgBC,EAAAA,EAAAA,WAAS,GAC7C,OACIC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBC,SAAA,EAEvCC,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACP,cAAeA,EAAeC,eAAgBA,KACtDE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBC,SAAA,EACnCC,EAAAA,EAAAA,KAAA,OAAAD,UAEEC,EAAAA,EAAAA,KAACE,EAAAA,EAAO,CAACR,cAAeA,OAI1BM,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mFAAkFC,UACjGF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,6BAA4BC,SAAA,EACzCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uFACfE,EAAAA,EAAAA,KAAA,KAAGF,UAAU,2CAA0CC,SAAC,yBAOlE,C,iICXF,MAAMI,EAAsB,CAE1BC,UAAgB,CAAC,aAAa,YAAY,eAAe,QAAQ,YAAY,QAAQ,WAAW,SAChGC,MAAgB,CAAC,aAAa,YAAY,eAAe,QAAQ,YAAY,QAAQ,YACrFC,YAAgB,CAAC,aAAa,YAAY,eAAe,QAAQ,WAAW,eAG5EC,UAAgB,CAAC,aAAa,YAAY,eAAe,QAAQ,YAAY,QAAQ,WAAW,eAChGC,gBAAgB,CAAC,aAAa,YAAY,eAAe,QAAQ,YAGjEC,eAAgB,CAAC,aAAa,SAC9BC,iBAAiB,CAAC,aAAa,SAG/BC,eAAgB,CAAC,WAAW,aAAa,UACzCC,SAAgB,CAAC,WAAW,aAAa,UACzCC,YAAgB,CAAC,WAAW,cAG5BC,MAAO,CACL,SAAS,aAAa,gBAAgB,mBACtC,QAAQ,YAAY,QAAQ,YAE9BC,eAAgB,CAAC,QAAQ,aAAa,UAGtCC,UAAgB,CAAC,eAMnB,SAASC,EAAkBC,EAAMC,EAAKC,GACpC,MAAMC,EAAOlB,EAAoBgB,IAAQ,GACnCG,EAAS,IAAKJ,EAAM,CAACC,GAAMC,GAIjC,OAHAC,EAAKE,SAASC,IACZF,EAAOE,GAAKC,MAAMC,KAAK,IAAIC,IAAI,IAAKL,EAAOE,IAAM,MAAQJ,IAAU,IAE9DE,CACT,CACA,SAASM,EAAkBC,GACzB,IAAIC,EAAM,IAAKD,GAIf,OAHAE,OAAOC,QAAQH,GAAKN,SAAQU,IAAgB,IAAdC,EAAGC,GAAKF,EACpCH,EAAMb,EAAkBa,EAAKI,EAAGC,EAAK,IAEhCL,CACT,CAKA,MAwTA,EAxTuBM,KAErB,MAAOC,EAAiBC,IAAiB1C,EAAAA,EAAAA,UAAS,KAC3C2C,EAAiBC,IAAiB5C,EAAAA,EAAAA,UAAS,KAC3C6C,EAAiBC,IAAiB9C,EAAAA,EAAAA,UAAS,CAAC,IAC5CF,EAAiBC,IAAiBC,EAAAA,EAAAA,WAAS,IAC3C+C,EAAiBC,IAAiBhD,EAAAA,EAAAA,UAAS,KAC3CiD,EAAiBC,IAAiBlD,EAAAA,EAAAA,WAAS,GAE5CmD,GAAWC,EAAAA,EAAAA,OACVC,IAAgBC,EAAAA,EAAAA,MACjBC,EAAKF,EAAaG,IAAI,OAE5BC,EAAAA,EAAAA,YAAU,KACJC,OAAOC,WAAa,KAAK5D,GAAe,EAAM,GACjD,KAGH0D,EAAAA,EAAAA,YAAU,KACR,WACE,IAAKF,EAAI,OACTL,GAAW,GACX,MAAMU,EAAQC,aAAaC,QAAQ,SACnC,IAAKF,EAAO,OAAOT,EAAS,KAE5B,IACE,MAAM,KAAEY,SAAeC,EAAAA,EAAMR,IAAI,+BAAgC,CAC/DS,QAAS,CAAEC,cAAe,UAAUN,OAEhCO,EAAUJ,EAAKK,MAAMC,MAAMC,GAAMA,EAAEC,MAAQhB,IACjD,GAAIY,EAAS,CACXzB,EAAYyB,EAAQ1B,UAAY,IAChCG,EAAeuB,EAAQxB,aAAe,IACtC,MAAM6B,EAAML,EAAQtB,YAAY4B,QAAO,CAACC,EAAGC,KACzCD,EAAEC,EAAEC,OAAOC,eAAiBF,EAAEnD,QACvBkD,IACN,CAAC,GACJ5B,EAAe0B,EACjB,CACF,CAAE,MAAOM,GACPC,QAAQC,MAAMF,EAChB,CAAC,QACC5B,GAAW,EACb,CACD,EAzBD,EAyBI,GACH,CAACK,EAAIJ,KAGRM,EAAAA,EAAAA,YAAU,KACR,IACET,EAAciC,KAAKC,MAAMrB,aAAaC,QAAQ,gBAAkB,MAClE,CAAE,MAAQd,EAAc,GAAK,IAC5B,IAWH,GAT0B4B,EASJ,QATYO,EASH,MAR8B,WAAtDtB,aAAaC,QAAQ,SAAW,IAAIe,gBAElC9B,EAAiBqC,MACrBT,GACCA,EAAEC,OAAOC,gBAAkBD,EAAOC,eAClCF,EAAEnD,QAAQgD,KAAKE,GAAMA,EAAEG,gBAAeQ,SAASF,EAAON,iBAI1D,OAAOzE,EAAAA,EAAAA,KAAA,OAAKF,UAAU,MAAKC,SAAC,8CAVLmF,IAACV,EAAQO,EAalC,MAAMI,EAAkB,CAAC,MAAO,OAAQ,SAAU,QAC5CC,EAAU,CACd,CAAEjC,GAAK,EAAGkC,KAAM,YAChB,CAAElC,GAAK,EAAGkC,KAAM,kBAChB,CAAElC,GAAK,EAAGkC,KAAM,UAChB,CAAElC,GAAK,EAAGkC,KAAM,cAChB,CAAElC,GAAK,EAAGkC,KAAM,aAChB,CAAElC,GAAK,EAAGkC,KAAM,WAChB,CAAElC,GAAK,EAAGkC,KAAM,mBAChB,CAAElC,GAAK,EAAGkC,KAAM,aAChB,CAAElC,GAAK,EAAGkC,KAAM,YAChB,CAAElC,GAAI,GAAIkC,KAAM,QAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,gBAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,mBAChB,CAAElC,GAAI,GAAIkC,KAAM,cAChB,CAAElC,GAAI,GAAIkC,KAAM,UAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,eAChB,CAAElC,GAAI,GAAIkC,KAAM,gBAChB,CAAElC,GAAI,GAAIkC,KAAM,YAChB,CAAElC,GAAI,GAAIkC,KAAM,UAChB,CAAElC,GAAI,GAAIkC,KAAM,oBAChB,CAAElC,GAAI,GAAIkC,KAAM,kBAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,UAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,YAChB,CAAElC,GAAI,GAAIkC,KAAM,cAChB,CAAElC,GAAI,GAAIkC,KAAM,qBAChB,CAAElC,GAAI,GAAIkC,KAAM,iBAChB,CAAElC,GAAI,GAAIkC,KAAM,oBAChB,CAAElC,GAAI,GAAIkC,KAAM,kBAChB,CAAElC,GAAI,GAAIkC,KAAM,YAChB,CAAElC,GAAI,GAAIkC,KAAM,eAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,kBAChB,CAAElC,GAAI,GAAIkC,KAAM,UAChB,CAAElC,GAAI,GAAIkC,KAAM,aAChB,CAAElC,GAAI,GAAIkC,KAAM,WAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,gBAChB,CAAElC,GAAI,GAAIkC,KAAM,SAChB,CAAElC,GAAI,GAAIkC,KAAM,oBAChB,CAAElC,GAAI,GAAIkC,KAAM,aAIZC,EAAuBA,IAC3BF,EAAQG,OACLC,IACE/C,EAAY+C,EAAEH,KAAKZ,gBAAkB,IAAIgB,SAC1CN,EAAgBM,SAmEtB,OAAI5C,GAAgB7C,EAAAA,EAAAA,KAACP,EAAAA,EAAa,KAEhCI,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBC,SAAA,EACrCC,EAAAA,EAAAA,KAACC,EAAAA,EAAM,CAACP,cAAeA,EAAeC,eAAgBA,KACtDE,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iBAAgBC,SAAA,EAC7BC,EAAAA,EAAAA,KAACE,EAAAA,EAAO,CAACR,cAAeA,KACxBG,EAAAA,EAAAA,MAAA,QAAMC,UAAU,2BAA0BC,SAAA,EACxCC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,0BAAyBC,SACpCoD,EAAK,cAAgB,iBAGxBtD,EAAAA,EAAAA,MAAA,QAAM6F,SAhDOC,UAEnB,GADAC,EAAEC,kBACGxD,EAASyD,OAAQ,OAAOC,MAAM,yBAEnC,MAAMvC,EAAQC,aAAaC,QAAQ,SACnC,IAAKF,EAAO,OAAOT,EAAS,UAE5B,MAAMiD,EAAU,CACd3D,SAAUA,EAASyD,OACnBvD,cACAE,YAAaV,OAAOC,QAAQJ,EAAkBa,IAAc2B,KAC1D6B,IAAA,IAAEzB,EAAQpD,GAAQ6E,EAAA,MAAM,CAAEzB,OAAQA,EAAO0B,QAAQ,IAAK,KAAM9E,UAAS,KAIzE0B,GAAW,GACX,IACMK,SACIS,EAAAA,EAAMuC,IAAI,sBAAsBhD,IAAM6C,EAAS,CACnDnC,QAAS,CAAEC,cAAe,UAAUN,OAEtCuC,MAAM,wBAEAnC,EAAAA,EAAMwC,KAAK,+BAAgCJ,EAAS,CACxDnC,QAAS,CAAEC,cAAe,UAAUN,OAEtCuC,MAAM,iBAERhD,EAAS,mBACX,CAAE,MAAO2B,GAAM,IAAD2B,EAAAC,EACZP,OAAkB,QAAZM,EAAA3B,EAAI6B,gBAAQ,IAAAF,GAAM,QAANC,EAAZD,EAAc1C,YAAI,IAAA2C,OAAN,EAAZA,EAAoBE,UAAW9B,EAAI8B,QAC3C,CAAC,QACC1D,GAAW,EACb,GAemC/C,SAAA,EAE3BF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMC,SAAA,EACnBC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,2BAA0BC,SAAC,eAC5CC,EAAAA,EAAAA,KAAA,SACEF,UAAU,4BACV2G,MAAOpE,EACPqE,SAAWd,GAAMtD,EAAYsD,EAAEe,OAAOF,aAG1C5G,EAAAA,EAAAA,MAAA,OAAKC,UAAU,OAAMC,SAAA,EACnBC,EAAAA,EAAAA,KAAA,SAAOF,UAAU,2BAA0BC,SAAC,iBAC5CC,EAAAA,EAAAA,KAAA,YACE4G,KAAK,IACL9G,UAAU,4BACV2G,MAAOlE,EACPmE,SAAWd,GAAMpD,EAAeoD,EAAEe,OAAOF,aAK7CzG,EAAAA,EAAAA,KAAA,OAAKF,UAAU,gBAAeC,UAC5BF,EAAAA,EAAAA,MAAA,SAAOC,UAAU,wBAAuBC,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SAAAD,UACEF,EAAAA,EAAAA,MAAA,MAAIC,UAAU,cAAaC,SAAA,EACzBC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,mBAAkBC,SAAC,OACjCC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,mBAAkBC,SAAC,YACjCC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,+BAA8BC,SAAC,iBAC7CC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,+BAA8BC,SAAC,aAC7CC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,+BAA8BC,UAC1CC,EAAAA,EAAAA,KAAA,SACE6G,KAAK,WACLC,QAASxB,IACToB,SA5GJK,IAChBrE,GAAgBsE,IACd,GAAI1B,IAAwB,MAAO,CAAC,EACpC,MAAM2B,EAAM,CAAC,EAIb,OAHA7B,EAAQ7D,SACLiE,GAAOyB,EAAIzB,EAAEH,KAAKZ,eAAiB,IAAIU,KAEnCvD,EAAkBqF,EAAI,IAsGXC,MAAM,kDAKdlH,EAAAA,EAAAA,KAAA,SAAAD,SACGqF,EAAQhB,KAAI,CAACoB,EAAG2B,KACf,MAAMhG,EAAMqE,EAAEH,KAAKZ,cACb2C,EAAW3E,EAAYtB,IAAQ,GACrC,OACEtB,EAAAA,EAAAA,MAAA,MAAAE,SAAA,EACEC,EAAAA,EAAAA,KAAA,MAAIF,UAAU,mBAAkBC,SAAEoH,EAAM,KACxCnH,EAAAA,EAAAA,KAAA,MAAIF,UAAU,mBAAkBC,SAAEyF,EAAEH,QACpCrF,EAAAA,EAAAA,KAAA,MAAIF,UAAU,mBAAkBC,UAC9BC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,uBAAsBC,SAClCoF,EAAgBf,KAAKiD,IACpBxH,EAAAA,EAAAA,MAAA,SAEEC,UAAU,0BAAyBC,SAAA,EAEnCC,EAAAA,EAAAA,KAAA,SACE6G,KAAK,WACLC,QAASM,EAASnC,SAASoC,GAC3BX,SAAUA,IA1HjBY,EAAC9C,EAAQO,KAChC,MAAM5D,EAAQqD,EAAOC,cACfuC,EAAQvE,EAAYtB,IAAQ,GAC5BoG,EAAQP,EAAK/B,SAASF,GACxBiC,EAAKQ,QAAQjD,GAAMA,IAAMQ,IACzB,IAAIiC,EAAMjC,GACdrC,GAAgB6B,GAAMtD,EAAkBsD,EAAGpD,EAAKoG,IAAM,EAoHRD,CAAiB9B,EAAEH,KAAMgC,MAE3CrH,EAAAA,EAAAA,KAAA,QAAAD,SAAOsH,MARF,GAAG7B,EAAEH,QAAQgC,YAa1BrH,EAAAA,EAAAA,KAAA,MAAIF,UAAU,+BAA8BC,UAC1CC,EAAAA,EAAAA,KAAA,SACE6G,KAAK,WACLC,QACEM,EAAS3B,SAAWN,EAAgBM,OAEtCiB,SAAUA,IA9HXlC,KACvB,MAAMrD,EAAOqD,EAAOC,cAEd8C,GADQ9E,EAAYtB,IAAQ,IAAIsE,SAAWN,EAAgBM,OAC7C,GAAK,IAAIN,GAC7BzC,GAAgB6B,GAAMtD,EAAkBsD,EAAGpD,EAAKoG,IAAM,EA0HdE,CAAgBjC,EAAEH,YA1B/BG,EAAErC,GA6BN,YAQftD,EAAAA,EAAAA,MAAA,OAAKC,UAAU,iCAAgCC,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,UACE6G,KAAK,SACL/G,UAAU,sDAAqDC,SAE9DoD,EAAK,SAAW,UAEnBnD,EAAAA,EAAAA,KAAA,UACE6G,KAAK,SACL/G,UAAU,uDACV4H,QAASA,KACPpF,EAAY,IACZE,EAAe,IACfE,EAAe,CAAC,EAAE,EAClB3C,SACH,wBAOL,C","sources":["Loading.jsx","components/User/CreateRolist.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport Navbar from \"./components/Navbar\";\nimport Sidebar from \"./components/Sidebar\";\nexport default function LoadingScreen() {\n    const[isSidebarOpen,setSidebarOpen]=useState(false)\n    return (\n        <div className='flex flex-col h-screen'>\n        {/* Navbar component with sidebar open state */}\n        <Navbar isSidebarOpen={isSidebarOpen} setSidebarOpen={setSidebarOpen} />\n        <div className='flex flex-grow mt-20'>\n          <div>\n            {/* Sidebar component with open state */}\n            <Sidebar isSidebarOpen={isSidebarOpen} />\n          </div>\n  \n          {/* Container for the entire component */}\n          <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm\">\n          <div className=\"flex flex-col items-center\">\n            <div className=\"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin\"></div>\n            <p className=\"mt-3 text-lg font-semibold text-gray-700\">Loading...</p>\n          </div>\n        </div>\n          \n        </div>\n      </div>\n    );\n  }\n  ","/*  ────────────────────────────────────────────────────────────────\r\n    CreateRolelist.jsx  •  Auto-cascading permissions\r\n    Last edit: 24-Jun-2025\r\n   ───────────────────────────────────────────────────────────────── */\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Navbar from \"../Navbar\";\r\nimport Sidebar from \"../Sidebar\";\r\nimport LoadingScreen from \"../../Loading\";\r\n\r\n/* ╭──────────────────────────────────────────────────────────────╮\r\n   │ 1.  Parent → helper dependency map                           │\r\n   ╰──────────────────────────────────────────────────────────────╯ */\r\nconst MODULE_DEPENDENCIES = {\r\n  /*  POS / Sales  */\r\n  posorders:      [\"warehouses\",\"customers\",\"paymenttypes\",\"items\",\"taxgroups\",\"taxes\",\"accounts\",\"sales\"],\r\n  sales:          [\"warehouses\",\"customers\",\"paymenttypes\",\"items\",\"taxgroups\",\"taxes\",\"accounts\"],\r\n  salesreturn:    [\"warehouses\",\"customers\",\"paymenttypes\",\"items\",\"accounts\",\"cashsummary\"],\r\n\r\n  /*  Purchases  */\r\n  purchases:      [\"warehouses\",\"suppliers\",\"paymenttypes\",\"items\",\"taxgroups\",\"taxes\",\"accounts\",\"cashsummary\"],\r\n  purchasesreturn:[\"warehouses\",\"suppliers\",\"paymenttypes\",\"items\",\"accounts\"],\r\n\r\n  /*  Stock movement  */\r\n  stocktransfers: [\"warehouses\",\"items\"],\r\n  stockadjustments:[\"warehouses\",\"items\"],\r\n\r\n  /*  Cash / bank  */\r\n  moneytransfers: [\"accounts\",\"warehouses\",\"stores\"],\r\n  deposits:       [\"accounts\",\"warehouses\",\"stores\"],\r\n  cashsummary:    [\"accounts\",\"warehouses\"],\r\n\r\n  /*  Catalogue  */\r\n  items: [\r\n    \"brands\",\"categories\",\"subcategories\",\"subsubcategories\",\r\n    \"units\",\"taxgroups\",\"taxes\",\"variants\"\r\n  ],\r\n  marketingitems: [\"items\",\"categories\",\"brands\"],\r\n\r\n  /*  Misc  */\r\n  terminals:      [\"warehouses\"],\r\n};\r\n\r\n/* ╭──────────────────────────────────────────────────────────────╮\r\n   │ 2.  Helper utilities                                         │\r\n   ╰──────────────────────────────────────────────────────────────╯ */\r\nfunction applyDependencies(base, key, actions) {\r\n  const deps = MODULE_DEPENDENCIES[key] || [];\r\n  const merged = { ...base, [key]: actions };\r\n  deps.forEach((d) => {\r\n    merged[d] = Array.from(new Set([...(merged[d] || []), ...actions]));\r\n  });\r\n  return merged;\r\n}\r\nfunction expandPermissions(obj) {\r\n  let out = { ...obj };\r\n  Object.entries(obj).forEach(([k, acts]) => {\r\n    out = applyDependencies(out, k, acts);\r\n  });\r\n  return out;\r\n}\r\n\r\n/* ╭──────────────────────────────────────────────────────────────╮\r\n   │ 3.  Component                                                │\r\n   ╰──────────────────────────────────────────────────────────────╯ */\r\nconst CreateRolelist = () => {\r\n  /* ───────────────── state & hooks ───────────────── */\r\n  const [roleName,        setRoleName]   = useState(\"\");\r\n  const [description,     setDescription]= useState(\"\");\r\n  const [permissions,     setPermissions]= useState({});\r\n  const [isSidebarOpen,   setSidebarOpen]= useState(true);\r\n  const [localPermissions,setLocalPerms] = useState([]);\r\n  const [loading,         setLoading]    = useState(false);\r\n\r\n  const navigate = useNavigate();\r\n  const [searchParams] = useSearchParams();\r\n  const id = searchParams.get(\"id\");\r\n\r\n  useEffect(() => {\r\n    if (window.innerWidth < 768) setSidebarOpen(false);\r\n  }, []);\r\n\r\n  /* ────────── fetch existing role (edit mode) ────────── */\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!id) return;\r\n      setLoading(true);\r\n      const token = localStorage.getItem(\"token\");\r\n      if (!token) return navigate(\"/\");\r\n\r\n      try {\r\n        const { data } = await axios.get(\"/admincreatingrole/api/roles\", {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        const current = data.roles.find((r) => r._id === id);\r\n        if (current) {\r\n          setRoleName(current.roleName || \"\");\r\n          setDescription(current.description || \"\");\r\n          const map = current.permissions.reduce((a, p) => {\r\n            a[p.module.toLowerCase()] = p.actions;\r\n            return a;\r\n          }, {});\r\n          setPermissions(map);\r\n        }\r\n      } catch (err) {\r\n        console.error(err);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  }, [id, navigate]);\r\n\r\n  /* ────────── get current user’s own perms (for guard) ────────── */\r\n  useEffect(() => {\r\n    try {\r\n      setLocalPerms(JSON.parse(localStorage.getItem(\"permissions\") || \"[]\"));\r\n    } catch { setLocalPerms([]); }\r\n  }, []);\r\n\r\n  const hasPermissionFor = (module, action) => {\r\n    if ((localStorage.getItem(\"role\") || \"\").toLowerCase() === \"admin\")\r\n      return true;\r\n    return localPermissions.some(\r\n      (p) =>\r\n        p.module.toLowerCase() === module.toLowerCase() &&\r\n        p.actions.map((a) => a.toLowerCase()).includes(action.toLowerCase())\r\n    );\r\n  };\r\n  if (!hasPermissionFor(\"roles\", \"add\"))\r\n    return <div className=\"p-8\">Insufficient permissions to create roles.</div>;\r\n\r\n  /* ────────── master lists ────────── */\r\n  const permissionTypes = [\"Add\", \"Edit\", \"Delete\", \"View\"];\r\n  const modules = [\r\n    { id:  1, name: \"Accounts\" },\r\n    { id:  2, name: \"AdvancePayment\" },\r\n    { id:  3, name: \"Brands\" },\r\n    { id:  4, name: \"Categories\" },\r\n    { id:  5, name: \"Countries\" },\r\n    { id:  6, name: \"Coupons\" },\r\n    { id:  7, name: \"CustomerCoupons\" },\r\n    { id:  8, name: \"Customers\" },\r\n    { id:  9, name: \"Expenses\" },\r\n    { id: 10, name: \"Help\" },\r\n    { id: 11, name: \"Items\" },\r\n    { id: 12, name: \"PaymentTypes\" },\r\n    { id: 13, name: \"POSOrders\" },\r\n    { id: 14, name: \"Purchases\" },\r\n    { id: 15, name: \"PurchasesReturn\" },\r\n    { id: 16, name: \"Quotations\" },\r\n    { id: 17, name: \"Report\" },\r\n    { id: 18, name: \"Roles\" },\r\n    { id: 19, name: \"Sales\" },\r\n    { id: 20, name: \"SalesReturn\" },\r\n    { id: 21, name: \"SendMessages\" },\r\n    { id: 22, name: \"Services\" },\r\n    { id: 23, name: \"States\" },\r\n    { id: 24, name: \"StockAdjustments\" },\r\n    { id: 25, name: \"StockTransfers\" },\r\n    { id: 26, name: \"Store\" },\r\n    { id: 27, name: \"Stores\" },\r\n    { id: 28, name: \"Suppliers\" },\r\n    { id: 29, name: \"Taxes\" },\r\n    { id: 30, name: \"TaxGroups\" },\r\n    { id: 31, name: \"Units\" },\r\n    { id: 32, name: \"Users\" },\r\n    { id: 33, name: \"Variants\" },\r\n    { id: 34, name: \"Warehouses\" },\r\n    { id: 35, name: \"ExpenseCategories\" },\r\n    { id: 36, name: \"SubCategories\" },\r\n    { id: 37, name: \"SubSubCategories\" },\r\n    { id: 38, name: \"MoneyTransfers\" },\r\n    { id: 39, name: \"Deposits\" },\r\n    { id: 40, name: \"CashSummary\" },\r\n    { id: 41, name: \"Dashboard\" },\r\n    { id: 42, name: \"MarketingItems\" },\r\n    { id: 43, name: \"Banner\" },\r\n    { id: 44, name: \"Terminals\" },\r\n    { id: 45, name: \"Product\" },\r\n    { id: 46, name: \"Order\" },\r\n    { id: 47, name: \"Rider\" },\r\n    { id: 48, name: \"DeliverySlot\" },\r\n    { id: 49, name: \"Audit\" },\r\n    { id: 50, name: \"Image Management\" },\r\n    { id: 51, name: \"Bookings\"}\r\n  ];\r\n\r\n  /* ────────── checkbox helpers ────────── */\r\n  const isEverythingSelected = () =>\r\n    modules.every(\r\n      (m) =>\r\n        (permissions[m.name.toLowerCase()] || []).length ===\r\n        permissionTypes.length\r\n    );\r\n\r\n  const toggleAll = () =>\r\n    setPermissions((prev) => {\r\n      if (isEverythingSelected()) return {};\r\n      const all = {};\r\n      modules.forEach(\r\n        (m) => (all[m.name.toLowerCase()] = [...permissionTypes])\r\n      );\r\n      return expandPermissions(all);\r\n    });\r\n\r\n  const togglePermission = (module, action) => {\r\n    const key   = module.toLowerCase();\r\n    const prev  = permissions[key] || [];\r\n    const next  = prev.includes(action)\r\n      ? prev.filter((p) => p !== action)\r\n      : [...prev, action];\r\n    setPermissions((p) => applyDependencies(p, key, next));\r\n  };\r\n\r\n  const handleSelectAll = (module) => {\r\n    const key  = module.toLowerCase();\r\n    const full = (permissions[key] || []).length === permissionTypes.length;\r\n    const next = full ? [] : [...permissionTypes];\r\n    setPermissions((p) => applyDependencies(p, key, next));\r\n  };\r\n\r\n  /* ────────── submit ────────── */\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!roleName.trim()) return alert(\"Role name is required\");\r\n\r\n    const token = localStorage.getItem(\"token\");\r\n    if (!token) return navigate(\"/login\");\r\n\r\n    const payload = {\r\n      roleName: roleName.trim(),\r\n      description,\r\n      permissions: Object.entries(expandPermissions(permissions)).map(\r\n        ([module, actions]) => ({ module: module.replace(\" \", \"_\"), actions })\r\n      ),\r\n    };\r\n\r\n    setLoading(true);\r\n    try {\r\n      if (id) {\r\n        await axios.put(`/admincreatingrole/${id}`, payload, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        alert(\"Role updated\");\r\n      } else {\r\n        await axios.post(\"/admincreatingrole/api/roles\", payload, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        alert(\"Role created\");\r\n      }\r\n      navigate(\"/admin/role/list\");\r\n    } catch (err) {\r\n      alert(err.response?.data?.message || err.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  /* ────────── render ────────── */\r\n  if (loading) return <LoadingScreen />;\r\n  return (\r\n    <div className=\"flex h-screen flex-col\">\r\n      <Navbar isSidebarOpen={isSidebarOpen} setSidebarOpen={setSidebarOpen} />\r\n      <div className=\"flex flex-grow\">\r\n        <Sidebar isSidebarOpen={isSidebarOpen} />\r\n        <main className=\"w-full p-8 overflow-auto\">\r\n          <h1 className=\"text-2xl font-bold mb-6\">\r\n            {id ? \"Update Role\" : \"Create Role\"}\r\n          </h1>\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            {/* name & description */}\r\n            <div className=\"mb-4\">\r\n              <label className=\"block font-semibold mb-2\">Role Name</label>\r\n              <input\r\n                className=\"border rounded p-2 w-full\"\r\n                value={roleName}\r\n                onChange={(e) => setRoleName(e.target.value)}\r\n              />\r\n            </div>\r\n            <div className=\"mb-6\">\r\n              <label className=\"block font-semibold mb-2\">Description</label>\r\n              <textarea\r\n                rows=\"3\"\r\n                className=\"border rounded p-2 w-full\"\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            {/* permissions grid */}\r\n            <div className=\"overflow-auto\">\r\n              <table className=\"min-w-full bg-gray-50\">\r\n                <thead>\r\n                  <tr className=\"bg-gray-300\">\r\n                    <th className=\"border px-4 py-2\">#</th>\r\n                    <th className=\"border px-4 py-2\">Module</th>\r\n                    <th className=\"border px-4 py-2 text-center\">Permissions</th>\r\n                    <th className=\"border px-4 py-2 text-center\">Row All</th>\r\n                    <th className=\"border px-4 py-2 text-center\">\r\n                      <input\r\n                        type=\"checkbox\"\r\n                        checked={isEverythingSelected()}\r\n                        onChange={toggleAll}\r\n                        title=\"Select ALL permissions on ALL modules\"\r\n                      />\r\n                    </th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {modules.map((m, idx) => {\r\n                    const key = m.name.toLowerCase();\r\n                    const selected = permissions[key] || [];\r\n                    return (\r\n                      <tr key={m.id}>\r\n                        <td className=\"border px-4 py-2\">{idx + 1}</td>\r\n                        <td className=\"border px-4 py-2\">{m.name}</td>\r\n                        <td className=\"border px-4 py-2\">\r\n                          <div className=\"flex flex-wrap gap-2\">\r\n                            {permissionTypes.map((perm) => (\r\n                              <label\r\n                                key={`${m.name}-${perm}`}\r\n                                className=\"flex items-center gap-1\"\r\n                              >\r\n                                <input\r\n                                  type=\"checkbox\"\r\n                                  checked={selected.includes(perm)}\r\n                                  onChange={() => togglePermission(m.name, perm)}\r\n                                />\r\n                                <span>{perm}</span>\r\n                              </label>\r\n                            ))}\r\n                          </div>\r\n                        </td>\r\n                        <td className=\"border px-4 py-2 text-center\">\r\n                          <input\r\n                            type=\"checkbox\"\r\n                            checked={\r\n                              selected.length === permissionTypes.length\r\n                            }\r\n                            onChange={() => handleSelectAll(m.name)}\r\n                          />\r\n                        </td>\r\n                      </tr>\r\n                    );\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n\r\n            {/* buttons */}\r\n            <div className=\"flex justify-center gap-8 mt-8\">\r\n              <button\r\n                type=\"submit\"\r\n                className=\"bg-green-600 text-white px-6 py-2 rounded w-[150px]\"\r\n              >\r\n                {id ? \"Update\" : \"Save\"}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                className=\"bg-orange-500 text-white px-6 py-2 rounded w-[150px]\"\r\n                onClick={() => {\r\n                  setRoleName(\"\");\r\n                  setDescription(\"\");\r\n                  setPermissions({});\r\n                }}\r\n              >\r\n                Clear\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </main>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CreateRolelist;\r\n"],"names":["LoadingScreen","isSidebarOpen","setSidebarOpen","useState","_jsxs","className","children","_jsx","Navbar","Sidebar","MODULE_DEPENDENCIES","posorders","sales","salesreturn","purchases","purchasesreturn","stocktransfers","stockadjustments","moneytransfers","deposits","cashsummary","items","marketingitems","terminals","applyDependencies","base","key","actions","deps","merged","forEach","d","Array","from","Set","expandPermissions","obj","out","Object","entries","_ref","k","acts","CreateRolelist","roleName","setRoleName","description","setDescription","permissions","setPermissions","localPermissions","setLocalPerms","loading","setLoading","navigate","useNavigate","searchParams","useSearchParams","id","get","useEffect","window","innerWidth","token","localStorage","getItem","data","axios","headers","Authorization","current","roles","find","r","_id","map","reduce","a","p","module","toLowerCase","err","console","error","JSON","parse","action","some","includes","hasPermissionFor","permissionTypes","modules","name","isEverythingSelected","every","m","length","onSubmit","async","e","preventDefault","trim","alert","payload","_ref2","replace","put","post","_err$response","_err$response$data","response","message","value","onChange","target","rows","type","checked","toggleAll","prev","all","title","idx","selected","perm","togglePermission","next","filter","handleSelectAll","onClick"],"sourceRoot":""}