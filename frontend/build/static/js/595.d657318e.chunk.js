(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[595],{14840:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var n=s(65043),r=s(21197),a=s(59255),i=s(70579);function c(){const[e,t]=(0,n.useState)(!1);return(0,i.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,i.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,i.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,i.jsx)("div",{children:(0,i.jsx)(a.A,{isSidebarOpen:e})}),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,i.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},60446:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,s=36e5,n="millisecond",r="second",a="minute",i="hour",c="day",l="week",u="month",o="quarter",d="year",h="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,x={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],s=e%100;return"["+e+(t[(s-20)%10]||t[s]||t[0])+"]"}},k=function(e,t,s){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(s)+e},b={s:k,z:function(e){var t=-e.utcOffset(),s=Math.abs(t),n=Math.floor(s/60),r=s%60;return(t<=0?"+":"-")+k(n,2,"0")+":"+k(r,2,"0")},m:function e(t,s){if(t.date()<s.date())return-e(s,t);var n=12*(s.year()-t.year())+(s.month()-t.month()),r=t.clone().add(n,u),a=s-r<0,i=t.clone().add(n+(a?-1:1),u);return+(-(n+(s-r)/(a?r-i:i-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:l,d:c,D:h,h:i,m:a,s:r,ms:n,Q:o}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",$={};$[v]=x;var y="$isDayjsObject",g=function(e){return e instanceof w||!(!e||!e[y])},S=function e(t,s,n){var r;if(!t)return v;if("string"==typeof t){var a=t.toLowerCase();$[a]&&(r=a),s&&($[a]=s,r=a);var i=t.split("-");if(!r&&i.length>1)return e(i[0])}else{var c=t.name;$[c]=t,r=c}return!n&&r&&(v=r),r||!n&&v},j=function(e,t){if(g(e))return e.clone();var s="object"==typeof t?t:{};return s.date=e,s.args=arguments,new w(s)},N=b;N.l=S,N.i=g,N.w=function(e,t){return j(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var w=function(){function x(e){this.$L=S(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[y]=!0}var k=x.prototype;return k.parse=function(e){this.$d=function(e){var t=e.date,s=e.utc;if(null===t)return new Date(NaN);if(N.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var r=n[2]-1||0,a=(n[7]||"0").substring(0,3);return s?new Date(Date.UTC(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)):new Date(n[1],r,n[3]||1,n[4]||0,n[5]||0,n[6]||0,a)}}return new Date(t)}(e),this.init()},k.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},k.$utils=function(){return N},k.isValid=function(){return!(this.$d.toString()===f)},k.isSame=function(e,t){var s=j(e);return this.startOf(t)<=s&&s<=this.endOf(t)},k.isAfter=function(e,t){return j(e)<this.startOf(t)},k.isBefore=function(e,t){return this.endOf(t)<j(e)},k.$g=function(e,t,s){return N.u(e)?this[t]:this.set(s,e)},k.unix=function(){return Math.floor(this.valueOf()/1e3)},k.valueOf=function(){return this.$d.getTime()},k.startOf=function(e,t){var s=this,n=!!N.u(t)||t,o=N.p(e),f=function(e,t){var r=N.w(s.$u?Date.UTC(s.$y,t,e):new Date(s.$y,t,e),s);return n?r:r.endOf(c)},p=function(e,t){return N.w(s.toDate()[e].apply(s.toDate("s"),(n?[0,0,0,0]:[23,59,59,999]).slice(t)),s)},m=this.$W,x=this.$M,k=this.$D,b="set"+(this.$u?"UTC":"");switch(o){case d:return n?f(1,0):f(31,11);case u:return n?f(1,x):f(0,x+1);case l:var v=this.$locale().weekStart||0,$=(m<v?m+7:m)-v;return f(n?k-$:k+(6-$),x);case c:case h:return p(b+"Hours",0);case i:return p(b+"Minutes",1);case a:return p(b+"Seconds",2);case r:return p(b+"Milliseconds",3);default:return this.clone()}},k.endOf=function(e){return this.startOf(e,!1)},k.$set=function(e,t){var s,l=N.p(e),o="set"+(this.$u?"UTC":""),f=(s={},s[c]=o+"Date",s[h]=o+"Date",s[u]=o+"Month",s[d]=o+"FullYear",s[i]=o+"Hours",s[a]=o+"Minutes",s[r]=o+"Seconds",s[n]=o+"Milliseconds",s)[l],p=l===c?this.$D+(t-this.$W):t;if(l===u||l===d){var m=this.clone().set(h,1);m.$d[f](p),m.init(),this.$d=m.set(h,Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},k.set=function(e,t){return this.clone().$set(e,t)},k.get=function(e){return this[N.p(e)]()},k.add=function(n,o){var h,f=this;n=Number(n);var p=N.p(o),m=function(e){var t=j(f);return N.w(t.date(t.date()+Math.round(e*n)),f)};if(p===u)return this.set(u,this.$M+n);if(p===d)return this.set(d,this.$y+n);if(p===c)return m(1);if(p===l)return m(7);var x=(h={},h[a]=t,h[i]=s,h[r]=e,h)[p]||1,k=this.$d.getTime()+n*x;return N.w(k,this)},k.subtract=function(e,t){return this.add(-1*e,t)},k.format=function(e){var t=this,s=this.$locale();if(!this.isValid())return s.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=N.z(this),a=this.$H,i=this.$m,c=this.$M,l=s.weekdays,u=s.months,o=s.meridiem,d=function(e,s,r,a){return e&&(e[s]||e(t,n))||r[s].slice(0,a)},h=function(e){return N.s(a%12||12,e,"0")},p=o||function(e,t,s){var n=e<12?"AM":"PM";return s?n.toLowerCase():n};return n.replace(m,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return N.s(t.$y,4,"0");case"M":return c+1;case"MM":return N.s(c+1,2,"0");case"MMM":return d(s.monthsShort,c,u,3);case"MMMM":return d(u,c);case"D":return t.$D;case"DD":return N.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(s.weekdaysMin,t.$W,l,2);case"ddd":return d(s.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(a);case"HH":return N.s(a,2,"0");case"h":return h(1);case"hh":return h(2);case"a":return p(a,i,!0);case"A":return p(a,i,!1);case"m":return String(i);case"mm":return N.s(i,2,"0");case"s":return String(t.$s);case"ss":return N.s(t.$s,2,"0");case"SSS":return N.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")}))},k.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},k.diff=function(n,h,f){var p,m=this,x=N.p(h),k=j(n),b=(k.utcOffset()-this.utcOffset())*t,v=this-k,$=function(){return N.m(m,k)};switch(x){case d:p=$()/12;break;case u:p=$();break;case o:p=$()/3;break;case l:p=(v-b)/6048e5;break;case c:p=(v-b)/864e5;break;case i:p=v/s;break;case a:p=v/t;break;case r:p=v/e;break;default:p=v}return f?p:N.a(p)},k.daysInMonth=function(){return this.endOf(u).$D},k.$locale=function(){return $[this.$L]},k.locale=function(e,t){if(!e)return this.$L;var s=this.clone(),n=S(e,t,!0);return n&&(s.$L=n),s},k.clone=function(){return N.w(this.$d,this)},k.toDate=function(){return new Date(this.valueOf())},k.toJSON=function(){return this.isValid()?this.toISOString():null},k.toISOString=function(){return this.$d.toISOString()},k.toString=function(){return this.$d.toUTCString()},x}(),M=w.prototype;return j.prototype=M,[["$ms",n],["$s",r],["$m",a],["$H",i],["$W",c],["$M",u],["$y",d],["$D",h]].forEach((function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),j.extend=function(e,t){return e.$i||(e(t,w,j),e.$i=!0),j},j.locale=S,j.isDayjs=g,j.unix=function(e){return j(1e3*e)},j.en=$[v],j.Ls=$,j.p={},j}()},90595:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var n=s(65043),r=s(66727),a=s(60446),i=s.n(a),c=s(86213),l=s(21197),u=s(59255),o=s(14840),d=s(70579);function h(e){var t,s;let{open:r,onClose:a,onSave:i,lot:c}=e;const[l,u]=(0,n.useState)(null!==(t=null===c||void 0===c?void 0:c.packSize)&&void 0!==t?t:""),[o,h]=(0,n.useState)(""),[f,p]=(0,n.useState)(!1);if((0,n.useEffect)((()=>{var e;c&&(u(null!==(e=c.packSize)&&void 0!==e?e:""),h(""),p(!1))}),[c]),!r||!c)return null;const m=((c.packSize||l)>0?Math.floor(c.bulkQty/(c.packSize||l)):0)-(c.packSize?Math.floor((c.packedQty||0)/c.packSize):0),x=(c.packSize||l)>0&&o>0&&(f||o<=m);return(0,d.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,d.jsxs)("div",{className:"w-96 rounded bg-white p-6 shadow-lg space-y-4",children:[(0,d.jsxs)("h2",{className:"text-lg font-semibold text-center",children:["Pack \u201c",null===(s=c.item)||void 0===s?void 0:s.itemName,"\u201d"]}),c.packSize?(0,d.jsxs)("p",{className:"text-sm",children:["Pack size:"," ",(0,d.jsxs)("span",{className:"font-medium",children:[c.packSize," ",c.bulkUnit]})]}):(0,d.jsxs)("label",{className:"block text-sm",children:["Pack size (in ",c.bulkUnit,"):",(0,d.jsx)("input",{type:"number",min:"0.001",step:"0.001",value:l,onChange:e=>u(+e.target.value),className:"mt-1 w-full rounded border px-2 py-1",autoFocus:!0})]}),(0,d.jsxs)("label",{className:"block text-sm",children:["Packs to make"," ",(0,d.jsxs)("span",{className:"text-gray-500",children:["(max ",m,")"]}),(0,d.jsx)("input",{type:"number",min:"1",step:"1",value:o,onChange:e=>h(+e.target.value),className:"mt-1 w-full rounded border px-2 py-1"})]}),(0,d.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,d.jsx)("input",{type:"checkbox",checked:f,onChange:e=>p(e.target.checked),className:"accent-blue-600"}),"Mark as fully packed"]}),(0,d.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,d.jsx)("button",{className:"rounded bg-gray-300 px-4 py-1 hover:bg-gray-400",onClick:a,children:"Cancel"}),(0,d.jsx)("button",{className:"rounded bg-blue-600 px-4 py-1 text-white hover:bg-blue-700 disabled:opacity-50",disabled:!x,onClick:()=>{var e;return i({packSize:null!==(e=c.packSize)&&void 0!==e?e:+l,packs:+o,isFullyPacked:f})},children:"Save"})]})]})})}function f(){const e={headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}},[t,s]=(0,n.useState)([]),[a,f]=(0,n.useState)(!0),[p,m]=(0,n.useState)(!0),[x,k]=(0,n.useState)({open:!1,lot:null}),[b,v]=(0,n.useState)(window.innerWidth>=768);(0,n.useEffect)((()=>{(async()=>{try{f(!0);const{data:t}=await c.A.get("/api/raw-lots",{...e,params:{packed:p?0:void 0,withPacks:1}});s(t.data||[])}catch(r){var t,n;alert((null===(t=r.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||r.message),s([])}finally{f(!1)}})()}),[p]);return a?(0,d.jsx)(o.A,{}):(0,d.jsxs)("div",{className:"flex h-screen",children:[(0,d.jsx)(u.A,{isSidebarOpen:b}),(0,d.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,d.jsx)(l.A,{isSidebarOpen:b,setSidebarOpen:v}),(0,d.jsxs)("header",{className:"flex items-center justify-between bg-gray-100 px-4 py-3",children:[(0,d.jsx)("h1",{className:"text-xl font-semibold",children:"Raw Lots"}),(0,d.jsxs)("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[(0,d.jsx)("input",{type:"checkbox",className:"accent-cyan-600",checked:p,onChange:e=>m(e.target.checked)}),"Show only ",(0,d.jsx)("em",{children:"open"})," lots"]})]}),0===t.length?(0,d.jsx)("p",{className:"p-6 text-center text-gray-500",children:"No raw lots found."}):(0,d.jsx)("div",{className:"overflow-auto p-4",children:(0,d.jsxs)("table",{className:"w-full min-w-[1100px] border text-sm",children:[" ",(0,d.jsx)("thead",{className:"bg-sky-600 text-white",children:(0,d.jsx)("tr",{children:["Date","Item","Bulk Qty","Bulk Cost (\u20b9)","Pack Size","Pack Cost","Packs Made","Packs Left","Warehouse","Status","Action"].map((e=>(0,d.jsx)("th",{className:"border p-2",children:e},e)))})}),(0,d.jsx)("tbody",{children:t.map((e=>{var t,s,n,a;const c=null!==(t=e.unitCost)&&void 0!==t?t:e.bulkCost/e.bulkQty,l=e.packsMade||0,u=e.packSize&&c?e.isPacked&&l>0?(c*(e.bulkQty/l)).toFixed(2):(c*e.packSize).toFixed(2):null,o=e.packSize?e.isPacked?"Packed":"Partial":"Open";return(0,d.jsxs)("tr",{className:"text-center",children:[(0,d.jsx)("td",{className:"border p-2",children:i()(e.createdAt).format("DD-MMM-YY")}),(0,d.jsx)("td",{className:"border p-2",children:(null===(s=e.item)||void 0===s?void 0:s.itemName)||"\u2014"}),(0,d.jsxs)("td",{className:"border p-2",children:[e.bulkQty," ",e.bulkUnit]}),(0,d.jsx)("td",{className:"border p-2",children:e.bulkCost.toFixed(2)}),(0,d.jsx)("td",{className:"border p-2",children:e.packSize?`${e.packSize.toFixed(4)} ${e.bulkUnit}`:"\u2014"}),(0,d.jsx)("td",{className:"border p-2",children:null!==u&&void 0!==u?u:"\u2014"}),(0,d.jsx)("td",{className:"border p-2",children:null!==l&&void 0!==l?l:"\u2014"}),(0,d.jsx)("td",{className:"border p-2",children:null!==(n=e.packsLeft)&&void 0!==n?n:"\u2014"}),(0,d.jsx)("td",{className:"border p-2",children:(null===(a=e.warehouse)||void 0===a?void 0:a.warehouseName)||"\u2014"}),(0,d.jsx)("td",{className:"border p-2",children:o}),(0,d.jsx)("td",{className:"border p-2",children:null==e.packSize?(0,d.jsx)(r.N_,{to:"#",className:"text-blue-600 hover:text-blue-800",onClick:()=>k({open:!0,lot:e}),children:"Define Pack"}):e.packsLeft>0||!e.isPacked?(0,d.jsx)(r.N_,{to:"#",className:"text-blue-600 hover:text-blue-800",onClick:()=>k({open:!0,lot:e}),children:"Pack More"}):(0,d.jsx)("span",{className:"text-gray-400",children:"Done"})})]},e._id)}))})]})}),(0,d.jsx)(h,{open:x.open,lot:x.lot,onClose:()=>k({open:!1,lot:null}),onSave:async t=>{let{packSize:n,packs:r,isFullyPacked:a}=t;try{const{data:t}=await c.A.patch(`/api/raw-lots/${x.lot._id}/pack`,{packSize:n,packs:r,isFullyPacked:a},e);u=t.data,s((e=>e.map((e=>e._id===u._id?u:e)))),k({open:!1,lot:null})}catch(o){var i,l;alert((null===(i=o.response)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.message)||o.message)}var u}})]})]})}}}]);
//# sourceMappingURL=595.d657318e.chunk.js.map