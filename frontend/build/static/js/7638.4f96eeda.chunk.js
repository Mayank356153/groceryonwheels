"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7638],{14840:(e,t,s)=>{s.d(t,{A:()=>c});var a=s(65043),r=s(21197),l=s(59255),n=s(70579);function c(){const[e,t]=(0,a.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,n.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.A,{isSidebarOpen:e})}),(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},47638:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(65043),r=s(37762),l=s(64857),n=s(11238),c=s(49804),o=s(60184),d=s(21197),i=s(59255),x=s(14840),m=s(86213),p=s(66727),h=s(70579);const u=()=>{const e=(0,p.Zp)(),[t,s]=(0,a.useState)(10),[u,f]=(0,a.useState)(""),[b,y]=(0,a.useState)(1),[j,g]=(0,a.useState)(!0),[N,w]=(0,a.useState)([]),[v,C]=(0,a.useState)([]);function S(e,t){return"admin"===(localStorage.getItem("role")||"guest").toLowerCase()||v.some((s=>s.module.toLowerCase()===e.toLowerCase()&&s.actions.map((e=>e.toLowerCase())).includes(t.toLowerCase())))}(0,a.useEffect)((()=>{const e=localStorage.getItem("permissions");e&&C(JSON.parse(e))}),[]);const[E,A]=(0,a.useState)(!0),[k,$]=(0,a.useState)(null);(0,a.useEffect)((()=>{window.innerWidth<768&&g(!1)}),[]);const L=N.filter((e=>{var t;return((null===(t=e.category)||void 0===t?void 0:t.name)||"").toLowerCase().includes(u.toLowerCase())})),_=Math.ceil(L.length/t),D=L.slice((b-1)*t,b*t),O=D.reduce(((e,t)=>e+t.amount),0).toFixed(2),F=async()=>{try{A(!0);const e=localStorage.getItem("token"),t=await m.A.get("api/expenses",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});console.log(t.data),w(t.data.data)}catch(e){console.log(e.message)}finally{A(!1)}};return(0,a.useEffect)((()=>{F()}),[]),E?(0,h.jsx)(x.A,{}):(0,h.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,h.jsx)(d.A,{isSidebarOpen:j,setSidebarOpen:g}),(0,h.jsxs)("div",{className:"flex flex-grow mt",children:[(0,h.jsx)("div",{className:"w-auto",children:(0,h.jsx)(i.A,{isSidebarOpen:j})}),(0,h.jsxs)("div",{className:"overflow-x-auto  flex flex-col p-2 md:p-2 min-h-screen w-full",children:[(0,h.jsxs)("header",{className:"flex flex-col items-center justify-between p-4 mb-2 bg-gray-100 rounded-md shadow sm:flex-row",children:[(0,h.jsxs)("div",{className:"flex items-baseline gap-1 text-center sm:flex-row sm:text-left",children:[(0,h.jsx)("h1",{className:"text-sm font-semibold truncate sm:text-xl",children:"Expenses List"}),(0,h.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"View/Search Expenses"})]}),(0,h.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,h.jsxs)("a",{href:"#",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,h.jsx)(o.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,h.jsx)(c.XWt,{className:"mx-1 sm:mx-2"}),(0,h.jsx)("a",{href:"#",className:"text-gray-700 no-underline hover:text-cyan-600",children:"Expenses List"})]})]}),(0,h.jsxs)("div",{className:"p-4 bg-white border-t-4 rounded-lg shadow-md border-cyan-500",children:[(0,h.jsxs)("header",{className:"flex items-center justify-between mb-4",children:[(0,h.jsx)("div",{}),S("Expenses","Add")&&(0,h.jsx)("button",{className:"px-4 py-2 text-white rounded bg-cyan-500",onClick:()=>e("/add-expense"),children:"+ New Expense"})]}),(0,h.jsxs)("div",{className:"flex flex-col justify-between w-full mt-4 mb-4 space-y-2 lg:flex-row lg:space-y-0 lg:items-center",children:[(0,h.jsxs)("div",{className:"flex items-center px-2 space-x-2",children:[(0,h.jsx)("span",{className:"text-sm",children:"Show"}),(0,h.jsxs)("select",{className:"p-2 text-sm border border-gray-300 rounded-md",value:t,onChange:e=>{s(Number(e.target.value)),y(1)},children:[(0,h.jsx)("option",{children:"10"}),(0,h.jsx)("option",{children:"20"}),(0,h.jsx)("option",{children:"50"})]}),(0,h.jsx)("span",{className:"text-sm",children:"Entries"})]}),(0,h.jsxs)("div",{className:"flex flex-col justify-around w-full gap-2 lg:flex-row",children:[(0,h.jsxs)("div",{className:"flex items-center justify-around flex-1 w-full gap-1 px-2",children:[(0,h.jsx)("button",{onClick:()=>{const e=D.map((e=>{var t;return`${e.date}, ${(null===(t=e.category)||void 0===t?void 0:t.name)||"No Category"}, ${e.referenceNO||"NA"}, ${e.expenseFor}, ${e.amount}, ${e.account}, ${e.note}, ${e.createdBy}`})).join("\n");navigator.clipboard.writeText(e),alert("Data copied to clipboard!")},className:"w-full px-3 py-2 text-sm text-white bg-cyan-500",children:"Copy"}),(0,h.jsx)("button",{onClick:()=>{const e=n.utils.json_to_sheet(N),t=n.utils.book_new();n.utils.book_append_sheet(t,e,"Expenses"),n.writeFile(t,"expenses.xlsx")},className:"w-full px-3 py-2 text-sm text-white bg-cyan-500",children:"Excel"}),(0,h.jsx)("button",{onClick:()=>{const e=new r.uE;e.text("Expenses List",20,20);const t=N.map((e=>{var t;return[e.date,(null===(t=e.category)||void 0===t?void 0:t.name)||"NA",e.referenceNo,e.expenseFor,e.amount,e.account||"NA",e.note,e.createdBy]}));(0,l.Ay)(e,{head:[["Date","Category","Reference No.","Expense for","Amount","Account","Note","Created by"]],body:t}),e.save("expenses.pdf")},className:"w-full px-3 py-2 text-sm text-white bg-cyan-500",children:"PDF"}),(0,h.jsx)("button",{onClick:()=>{window.print()},className:"w-full px-3 py-2 text-sm text-white bg-cyan-500",children:"Print"}),(0,h.jsx)("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,"+N.map((e=>Object.values(e).join(","))).join("\n"),t=encodeURI(e),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download","expenses.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"w-full px-3 py-2 text-sm text-white bg-cyan-500",children:"CSV"})]}),(0,h.jsx)("input",{type:"text",placeholder:"Search",className:"w-full p-2 text-sm border border-gray-300 rounded-sm md:w-auto",onChange:e=>f(e.target.value)})]})]}),(0,h.jsx)("div",{className:"overflow-x-auto",children:(0,h.jsxs)("table",{className:"min-w-full bg-white border border-gray-300",children:[(0,h.jsx)("thead",{className:"bg-gray-200",children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-left border ",children:"Date"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Category"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Reference No."}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Expense for"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Amount"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Account"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Note"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Created by"}),(0,h.jsx)("th",{className:"px-3 py-2 text-sm text-left border",children:"Action"})]})}),(0,h.jsx)("tbody",{children:0===L.length?(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"9",className:"py-4 text-center",children:"No data available in table"})}):L.slice((b-1)*t,b*t).map((t=>{var s,a;return(0,h.jsxs)("tr",{id:t._id,className:"hover:bg-gray-100",children:[(0,h.jsx)("td",{className:"py-2 text-sm border ",children:new Date(t.date).toDateString()}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:(null===(s=t.category)||void 0===s?void 0:s.categoryName)||"No category"}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:t.referenceNo}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:t.expenseFor}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:t.amount||0}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:(null===(a=t.account)||void 0===a?void 0:a.accountName)||"N/A"}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:t.note}),(0,h.jsx)("td",{className:"px-3 py-2 text-sm border",children:t.creatorName||"NA"}),(0,h.jsxs)("td",{className:"px-3 py-2 text-sm border",children:[(0,h.jsx)("button",{onClick:()=>{$(k===t._id?null:t._id)},className:"px-3 py-1 text-white transition rounded bg-cyan-600 hover:bg-cyan-700",children:"Action \u25bc"}),k===t._id&&(0,h.jsxs)("div",{className:"absolute right-0 z-50 mt-2 bg-white border border-gray-200 rounded-md shadow-lg w-36 animate-fade-in",children:[S("Expenses","Edit")&&(0,h.jsxs)("button",{className:"flex items-center w-full px-3 py-2 text-gray-700 hover:bg-gray-100",onClick:()=>e(`/add-expense?id=${t._id}`),children:[(0,h.jsx)(o.uO9,{className:"mr-2"})," Edit"]}),S("Expenses","Delete")&&(0,h.jsxs)("button",{className:"flex items-center w-full px-3 py-2 text-red-600 hover:bg-gray-100",onClick:()=>(async(e,t)=>{if(e.preventDefault(),window.confirm("Do you want to delete this supplier?"))try{if(A(!0),!(await fetch(`api/expenses/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}})).ok)throw new Error("Failed to delete expense");console.log("Expense deleted successfully!"),F()}catch(s){console.error("Error deleting purchase:",s.message)}finally{A(!1)}})(t._id),children:[(0,h.jsx)(o.qbC,{className:"mr-2"})," Delete"]})]}),"                                          "]})]},t._id)}))}),(0,h.jsx)("tfoot",{children:D.length>0&&(0,h.jsxs)("tr",{className:"bg-gray-200",children:[(0,h.jsx)("td",{colSpan:"4",className:"px-4 py-2 font-bold text-right border",children:"Total:"}),(0,h.jsx)("td",{className:"px-4 py-2 font-bold border",children:O}),(0,h.jsx)("td",{colSpan:"4",className:"px-4 py-2 border"})]})})]})}),(0,h.jsxs)("div",{className:"flex flex-col items-center justify-between mt-4 md:flex-row",children:[(0,h.jsxs)("span",{children:["Showing ",t*(b-1)+1," to ",Math.min(t*b,N.length)," of ",N.length," entries"]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("button",{onClick:()=>y((e=>Math.max(e-1,1))),className:"px-4 py-2 mr-2 text-gray-600 bg-gray-300 disabled:opacity-50",disabled:1===b,children:"Previous"}),(0,h.jsx)("button",{onClick:()=>y((e=>Math.min(e+1,_))),className:"px-4 py-2 text-gray-600 bg-gray-300 disabled:opacity-50",disabled:b===_,children:"Next"})]})]})]})]})]})]})}}}]);
//# sourceMappingURL=7638.4f96eeda.chunk.js.map