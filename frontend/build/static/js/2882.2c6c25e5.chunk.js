"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2882],{14840:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(65043),r=a(21197),i=a(59255),l=a(70579);function o(){const[e,t]=(0,s.useState)(!1);return(0,l.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,l.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,l.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,l.jsx)("div",{children:(0,l.jsx)(i.A,{isSidebarOpen:e})}),(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,l.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},42882:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(65043),r=a(66727),i=a(59255),l=a(21197),o=a(14840),n=a(86213),d=a(11238),c=a(70579);function m(e){let{entity:t}=e;const{entity:a}=(0,r.g)(),m=(0,r.Zp)(),u=(0,r.zy)(),g=null!==t&&void 0!==t?t:a,[p,f]=(0,s.useState)(!0),[b,x]=(0,s.useState)("single"),[h,y]=(0,s.useState)(!1),[j,v]=(0,s.useState)(null),[w,N]=(0,s.useState)([]),[S,k]=(0,s.useState)({name:"",description:"",status:"Active",image:"",images:"",features:""}),[A,$]=(0,s.useState)(!1),[C,I]=(0,s.useState)(null);(0,s.useEffect)((()=>{const e=new URLSearchParams(u.search).get("id");e&&($(!0),I(e),B(e)),window.innerWidth<768&&f(!1)}),[u.search]);const B=async e=>{y(!0);try{const t=(await n.A.get(`/api/${g}/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data;k({name:t.name||"",description:t.description||"",status:t.status||"Active",image:t.image||"",images:Array.isArray(t.images)?t.images.join(";"):"",features:Array.isArray(t.features)?t.features.join(";"):""})}catch(s){var t,a;alert("Failed to fetch: "+((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||s.message))}finally{y(!1)}},L={categories:"Category",subcategories:"SubCategory","sub-subcategories":"Sub-SubCategory"}[g]||"Entity",U={categories:"/categories-list",subcategories:"/subcategories-list","sub-subcategories":"/sub-subcategory-list"}[g]||"/",z=e=>{const{name:t,value:a}=e.target;k((e=>({...e,[t]:a})))};return h?(0,c.jsx)(o.A,{}):(0,c.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,c.jsx)(l.A,{isSidebarOpen:p,setSidebarOpen:f}),(0,c.jsxs)("div",{className:"flex flex-grow md:flex-row",children:[(0,c.jsx)(i.A,{isSidebarOpen:p}),(0,c.jsxs)("main",{className:"flex-1 p-6 lg:p-8 overflow-y-auto",children:[(0,c.jsxs)("header",{className:"flex flex-col md:flex-row items-start md:items-center justify-between mb-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"single"===b?A?`Edit ${L}`:`Create ${L}`:`Bulk Import ${L}s`}),(0,c.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"single"===b?`Manage individual ${L.toLowerCase()} details`:`Import multiple ${L.toLowerCase()}s via file upload`})]}),(0,c.jsxs)("div",{className:"flex gap-3 mt-4 md:mt-0",children:[(0,c.jsx)("button",{onClick:()=>x("single"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("single"===b?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Single"}),(0,c.jsx)("button",{onClick:()=>x("bulk"),className:"px-4 py-2 rounded-lg font-medium transition-colors "+("bulk"===b?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Bulk"}),(0,c.jsxs)(r.k2,{to:U,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition-colors",children:["View ",L," List"]})]})]}),"single"===b?(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),y(!0);const t={name:S.name.trim(),description:S.description.trim(),status:S.status,features:S.features.split(/;|,/).map((e=>e.trim())).filter(Boolean)};"sub-subcategories"===g?t.images=S.images.split(/;|,/).map((e=>e.trim())).filter(Boolean):t.image=S.image;try{A?(await n.A.put(`/api/${g}/${C}`,t,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert(`${L} updated`)):(await n.A.post(`/api/${g}`,t,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert(`${L} created`)),m(U)}catch(r){var a,s;alert((null===(a=r.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||r.message)}finally{y(!1)}},className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 max-w-2xl mx-auto",children:[(0,c.jsxs)("div",{className:"grid gap-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Name ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{name:"name",value:S.name,onChange:z,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter name"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,c.jsx)("textarea",{name:"description",value:S.description,onChange:z,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",rows:"4",placeholder:"Enter description"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,c.jsxs)("select",{name:"status",value:S.status,onChange:z,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[(0,c.jsx)("option",{value:"Active",children:"Active"}),(0,c.jsx)("option",{value:"Inactive",children:"Inactive"})]})]}),"sub-subcategories"!==g?(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Image"}),(0,c.jsx)("input",{type:"file",accept:"image/*",onChange:async e=>{const t=e.target.files[0];if(!t)return;const a=new FormData;a.append("images",t);try{y(!0);const{data:e}=await n.A.post(`/api/${g}/upload-images`,a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});e.success?k((a=>({...a,image:e.uploadedImages[t.name]}))):alert("Upload failed: "+e.message)}catch(s){alert("Upload error: "+s.message)}finally{y(!1)}},className:"w-full px-4 py-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors"}),S.image&&(0,c.jsx)("div",{className:"mt-3",children:(0,c.jsx)("img",{src:`/vps/uploads/${g}/${S.image}`,alt:"preview",className:"w-24 h-24 object-cover rounded-lg border border-gray-200"})})]}):(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Images"}),(0,c.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:async e=>{const t=Array.from(e.target.files),a=new FormData;t.forEach((e=>a.append("images",e)));try{y(!0);const{data:e}=await n.A.post(`/api/${g}/upload-images`,a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});if(e.success){const a=t.map((t=>e.uploadedImages[t.name])).filter(Boolean).join(";");k((e=>({...e,images:a})))}else alert("Upload failed: "+e.message)}catch(s){alert("Upload error: "+s.message)}finally{y(!1)}},className:"w-full px-4 py-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors"}),S.images&&(0,c.jsx)("div",{className:"mt-3 grid grid-cols-2 sm:grid-cols-3 gap-3",children:S.images.split(";").map((e=>(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("img",{src:`/vps/uploads/${g}/${e}`,className:"w-24 h-24 object-cover rounded-lg border border-gray-200",alt:""}),(0,c.jsx)("button",{type:"button",onClick:()=>(e=>{k((t=>({...t,images:t.images.split(";").filter((t=>t!==e)).join(";")})))})(e),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",title:"Remove image",children:(0,c.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},e)))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Features"}),(0,c.jsx)("input",{name:"features",value:S.features,onChange:z,placeholder:"feat1;feat2",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"}),(0,c.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Separate features with semicolons or commas (e.g., feat1;feat2)"})]})]}),(0,c.jsx)("div",{className:"mt-6 flex justify-end",children:(0,c.jsx)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:A?`Update ${L}`:`Create ${L}`})})]}):(0,c.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!j)return alert("Please select a file");y(!0);let t={};try{if(w.length){const e=new FormData;w.forEach((t=>e.append("images",t)));const{data:a}=await n.A.post(`/api/${g}/upload-images`,e,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}});if(!a.success)throw new Error(a.message);t=a.uploadedImages}}catch(s){return y(!1),alert("Image upload failed: "+s.message)}const a=new FileReader;a.onload=async e=>{try{const a=new Uint8Array(e.target.result),s=d.read(a,{type:"array"}),r=d.utils.sheet_to_json(s.Sheets[s.SheetNames[0]],{defval:""}).map((e=>{const a={name:String(e.name||"").trim(),description:String(e.description||"").trim(),status:String(e.status||"Active").trim(),features:String(e.features||"").split(/;|,/).map((e=>e.trim())).filter(Boolean)};if("sub-subcategories"===g){const s=String(e.images||e.image||"").split(/;|,/).map((e=>e.trim())).filter(Boolean);a.images=s.map((e=>{if(!t[e])throw new Error(`Image "${e}" not found`);return t[e]}))}else{const s=String(e.image||"").trim();a.image=s?t[s]||(()=>{throw new Error(`Image "${s}" not found`)})():""}return a}));await n.A.post(`/api/${g}/bulk`,r,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert(`Bulk import of ${L}s successful`),m(U)}catch(s){var a,r;alert("Bulk import failed: "+((null===(a=s.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||s.message))}finally{y(!1)}},a.readAsArrayBuffer(j)},className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 max-w-2xl mx-auto",children:[(0,c.jsxs)("div",{className:"grid gap-6",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Images (Optional)"}),(0,c.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{const t=Array.from(e.target.files);if(w.length+t.length>50)return alert("Max 50 images");for(let a of t)if(a.size>1048576)return alert(`${a.name} too large`);N((e=>[...e,...t]))},className:"w-full px-4 py-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors"}),w.length>0&&(0,c.jsx)("div",{className:"mt-3 space-y-2",children:w.map(((e,t)=>(0,c.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg border border-gray-200",children:[(0,c.jsxs)("span",{className:"text-sm text-gray-700",children:[e.name," (",(e.size/1024).toFixed(1)," KB)"]}),(0,c.jsx)("button",{type:"button",onClick:()=>{return e=t,N((t=>t.filter(((t,a)=>a!==e))));var e},className:"text-red-500 hover:text-red-700 transition-colors",children:"Remove"})]},t)))})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Format Instructions"}),(0,c.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,c.jsx)("p",{className:"text-sm text-gray-700",children:"Upload a CSV, XLS, or XLSX file with the following headers:"}),(0,c.jsx)("p",{className:"mt-1 font-mono text-sm text-gray-900",children:"sub-subcategories"===g?"name,description,status,images,features":"name,description,status,image,features"}),(0,c.jsx)("button",{type:"button",onClick:()=>{const e=new Blob([`${"sub-subcategories"===g?"name,description,status,images,features":"name,description,status,image,features"}\n${"sub-subcategories"===g?"Name,Desc,Active,img1;img2,feat1;feat2":"Name,Desc,Active,img,feat1;feat2"}`],{type:"text/csv"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`sample_${g}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"mt-2 inline-flex items-center px-3 py-1 bg-blue-100 text-blue-700 rounded-lg text-sm font-medium hover:bg-blue-200 transition-colors",children:"Download Sample File"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Upload CSV / XLS / XLSX ",(0,c.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,c.jsx)("input",{type:"file",accept:".csv,.xls,.xlsx",onChange:e=>v(e.target.files[0]),className:"w-full px-4 py-2 border border-gray-300 rounded-lg file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors",required:!0})]})]}),(0,c.jsx)("div",{className:"mt-6 flex justify-end",children:(0,c.jsxs)("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:["Import ",L,"s"]})})]})]})]})]})}}}]);
//# sourceMappingURL=2882.2c6c25e5.chunk.js.map