"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2037],{12037:(e,t,a)=>{a.r(t),a.d(t,{default:()=>o});var s=a(65043),r=a(66727),n=a(86213),l=a(70579);const o=()=>{const e=(0,r.Zp)(),t=(0,r.zy)(),a=new URLSearchParams(t.search).get("saleId"),[o,d]=(0,s.useState)(!1),[i,c]=(0,s.useState)({customer:"",saleCode:"",saleDate:"",totalAmount:0,totalPaid:0,payments:[]});(0,s.useEffect)((()=>{if(!a)return alert("Invalid sale ID"),void e("/sale-list");m()}),[a,e]);const m=async()=>{const t=localStorage.getItem("token");if(!t)return alert("No token found, please log in"),void e("/login");d(!0);try{const e=await n.A.get(`api/payments/${a}`,{headers:{Authorization:`Bearer ${t}`}}),s=await n.A.get("api/pos/invoices",{headers:{Authorization:`Bearer ${t}`}});if(!e.data||!s.data)throw new Error("No data returned from API");const r=s.data.find((e=>e._id.toString()===a));if(!r)throw new Error("Invoice not found for this sale ID");const l=r.amount||0;c({customer:e.data.customer||"N/A",saleCode:e.data.saleCode||"N/A",saleDate:e.data.saleDate&&!isNaN(new Date(e.data.saleDate).getTime())?new Date(e.data.saleDate).toLocaleDateString():"N/A",totalAmount:l,totalPaid:e.data.totalPaid||0,payments:e.data.payments||[]})}catch(s){console.error("Error fetching payment details:",s),alert(`Could not load payment details: ${s.message}`),e("/sale-list")}finally{d(!1)}},x=()=>{window.print()},h=()=>{e("/sale-list")},p=i.totalAmount-i.totalPaid;return o?(0,l.jsx)("div",{children:"Loading..."}):(0,l.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-4xl",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Payments"}),(0,l.jsx)("button",{onClick:h,className:"text-gray-500 hover:text-gray-700",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700",children:"Customer Details"}),(0,l.jsx)("p",{children:i.customer})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700",children:"Sales Details"}),(0,l.jsxs)("p",{children:["Invoice #: ",i.saleCode]}),(0,l.jsxs)("p",{children:["Date: ",i.saleDate]}),(0,l.jsxs)("p",{children:["Grand Total: \u20b9",i.totalAmount.toFixed(2)]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-gray-700",children:"Payment"}),(0,l.jsxs)("p",{children:["Paid Amount: \u20b9",i.totalPaid.toFixed(2)]}),(0,l.jsxs)("p",{children:["Due Amount: \u20b9",p.toFixed(2)]})]})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full bg-white border border-gray-300 shadow-sm",children:[(0,l.jsx)("thead",{className:"bg-cyan-500 text-white",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"#"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Payment Date"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Payment"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Payment Type"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Payment Note"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Created by"}),(0,l.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:"Action"})]})}),(0,l.jsx)("tbody",{children:0===i.payments.length?(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:"8",className:"p-4 text-center text-gray-500 border",children:"No payments available"})}):i.payments.map(((e,t)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border px-4 py-2",children:t+1}),(0,l.jsx)("td",{className:"border px-4 py-2",children:e.paymentDate&&!isNaN(new Date(e.paymentDate).getTime())?new Date(e.paymentDate).toLocaleDateString():"N/A"}),(0,l.jsxs)("td",{className:"border px-4 py-2",children:["\u20b9",e.paymentAmount.toFixed(2)]}),(0,l.jsx)("td",{className:"border px-4 py-2",children:e.paymentType||"Cash"}),(0,l.jsx)("td",{className:"border px-4 py-2",children:e.paymentNote||"N/A"}),(0,l.jsx)("td",{className:"border px-4 py-2",children:e.creatorName||"N/A"}),(0,l.jsxs)("td",{className:"border px-4 py-2 flex space-x-2",children:[(0,l.jsx)("button",{onClick:x,className:"text-blue-500 hover:text-blue-700",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})})}),(0,l.jsx)("button",{onClick:()=>{alert("Delete functionality not implemented. Please add a backend endpoint to handle payment deletion.")},className:"text-red-500 hover:text-red-700",children:(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5-4h4a1 1 0 011 1v1H9V4a1 1 0 011-1zm-5 4h12"})})})]})]},t)))})]})}),(0,l.jsx)("div",{className:"flex justify-end mt-4",children:(0,l.jsx)("button",{onClick:h,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Close"})})]})})}}}]);
//# sourceMappingURL=2037.3cbc09b6.chunk.js.map