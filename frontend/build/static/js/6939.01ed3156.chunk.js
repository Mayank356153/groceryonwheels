"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[6939],{14840:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(65043),l=s(21197),r=s(59255),n=s(70579);function o(){const[e,t]=(0,a.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(l.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,n.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,n.jsx)("div",{children:(0,n.jsx)(r.A,{isSidebarOpen:e})}),(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},46939:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var a=s(65043),l=s(59255),r=s(21197),n=s(66727),o=s(60184),i=s(26873),d=s(86213),c=(s(14840),s(37762)),m=s(64857),x=s(11238),h=(s(79038),s(70579));function u(){const[e,t]=(0,a.useState)(!1),[s,u]=(0,a.useState)(!0),[f,p]=(0,a.useState)(!0),[g,b]=(0,a.useState)([]),[y,N]=(0,a.useState)([]),[j,v]=(0,a.useState)([]),[w,S]=(0,a.useState)([]),[k,I]=(0,a.useState)({warehouses:[]});(0,a.useEffect)((()=>{window.innerWidth<768&&u(!1)}),[]);const A=(0,n.Zp)(),[D,E]=(0,a.useState)(""),[_,z]=(0,a.useState)([]),[C,F]=(0,a.useState)(!1),[T,q]=(0,a.useState)([]),[O,Q]=(0,a.useState)([]),[$,B]=(0,a.useState)("all"),[M,R]=(0,a.useState)("all");(0,a.useEffect)((()=>{(async()=>{try{p(!0);const e=(await d.A.get("api/warehouses",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data.map((e=>({label:e.warehouseName,value:e._id})));I((t=>({...t,warehouses:e})))}catch(e){console.log(e.message)}finally{p(!1)}})(),(async()=>{try{p(!0);const e=await d.A.get("api/sales",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("sale"),console.log(e.data),N(e.data.sales)}catch(e){console.log(e.message)}finally{p(!1)}})(),(async()=>{try{p(!0);const e=await d.A.get("api/stock-transfers",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log("transfer"),console.log(e.data),v(e.data.data)}catch(e){console.log(e.message)}finally{p(!1)}})()}),[]);const L=y.filter((e=>{const{warehouse:t,saleDate:s}=e,a=t&&t._id===D,l=new Date(s),r=new Date($),n=new Date(M);return a&&(l>=r&&l<=n)})),W=j.filter((e=>{const{toWarehouse:t,transferDate:s}=e,a=t&&t._id===D,l=new Date(s),r=new Date($),n=new Date(M);return a&&(l>=r&&l<=n)}));return(0,h.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,h.jsx)(r.A,{isSidebarOpen:s,setSidebarOpen:u}),(0,h.jsxs)("div",{className:"flex flex-grow",children:[(0,h.jsx)(l.A,{isSidebarOpen:s}),(0,h.jsxs)("div",{className:"relative flex flex-col flex-grow w-full px-4 py-6 bg-gray-100",children:[(0,h.jsxs)("header",{className:"flex flex-col items-center justify-between sm:flex-row",children:[(0,h.jsx)("div",{className:"flex items-center gap-1 text-center sm:flex-row sm:text-left",children:(0,h.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"Item Transfer"})}),(0,h.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,h.jsxs)(n.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,h.jsx)(o.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,h.jsx)(n.k2,{to:"/reports/sale-item",className:"text-gray-700 no-underline hover:text-cyan-600",children:"> sale item Report"})]})]}),(0,h.jsxs)("div",{className:"flex flex-col w-full mx-auto mt-4 bg-white border-t-4 rounded-lg shadow-md border-cyan-600",children:[(0,h.jsx)("div",{className:"w-full h-auto px-2 border-b-2 border-gray-200",children:(0,h.jsx)("h4",{className:"text-gray-700",children:"Please Enter Valid Information"})}),(0,h.jsxs)("div",{className:"py-4 ",children:[(0,h.jsxs)("div",{className:"flex flex-col w-full gap-4 px-4 mb-4 md:flex-row md:gap-5",children:[(0,h.jsxs)("div",{className:"flex flex-col w-full",children:[(0,h.jsx)("label",{htmlFor:"",children:"Warehouse"}),(0,h.jsx)(i.Ay,{className:"w-full",options:k.warehouses,onChange:e=>E(e.value),value:k.warehouses.find((e=>e.value===D))})]}),(0,h.jsx)("div",{className:"hidden w-full md:flex"})]}),(0,h.jsxs)("div",{className:"flex w-full gap-5 px-4",children:[(0,h.jsxs)("div",{className:"flex flex-col w-full",children:[(0,h.jsx)("label",{htmlFor:"",children:"From Date"}),(0,h.jsx)("input",{type:"date",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",onChange:e=>B(e.target.value)})]}),(0,h.jsxs)("div",{className:"flex flex-col w-full",children:[(0,h.jsx)("label",{htmlFor:"",children:"To Date"}),(0,h.jsx)("input",{type:"date",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",onChange:e=>R(e.target.value)})]})]}),(0,h.jsxs)("div",{className:"flex flex-col justify-around w-full gap-4 px-2 mt-2 md:justify-center md:flex-row",children:[(0,h.jsx)("button",{className:"px-6 py-2 text-white transition-colors duration-300 bg-blue-600 rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",onClick:e=>{e.preventDefault();try{if(p(!0),F(!1),!D)return void alert("one of the warehouse is not selected");function s(e,t){const s=new Map,a=new Map;e.forEach((e=>{(e.items||[]).forEach((e=>{var t,a;const l=null===(t=e.item)||void 0===t?void 0:t._id;if(!l)return;const r=e.quantity||0,n=(null===(a=e.item)||void 0===a?void 0:a.itemName)||"Unnamed Item";if(s.has(l)){s.get(l).transferred+=r}else s.set(l,{_id:l,itemName:n,transferred:r,sold:0})}))})),t.forEach((e=>{(e.items||[]).forEach((e=>{var t,l;const r=(null===(t=e.item)||void 0===t?void 0:t._id)||e._id;if(!r)return;const n=e.quantity||0,o=(null===(l=e.item)||void 0===l?void 0:l.itemName)||e.itemName||"Unnamed Item";if(s.has(r)){s.get(r).sold+=n}else if(a.has(r)){a.get(r).sold+=n}else a.set(r,{_id:r,itemName:o,transferred:0,sold:n})}))}));const l=[];for(const r of s.values())r.transferred<r.sold&&l.push(r);for(const[r,n]of a.entries())l.push(n);return l}q(L),console.log(W),Q(W);const a=s(W,L);console.log(a),z(s(W,L))}catch(t){console.log("Error in comparing",t.message)}finally{D&&F(!0),p(!1)}},type:"button",children:"Show"}),(0,h.jsx)("button",{className:"px-6 py-2 text-white transition-colors duration-300 bg-gray-600 rounded-lg shadow-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50",onClick:()=>A("/dashboard"),type:"button",children:"Back to Dashboard"})]})]})]}),(0,h.jsxs)("div",{className:"flex flex-col w-full mt-5 border-t-4 border-gray-400",children:[(0,h.jsxs)("div",{className:"flex w-full px-2 py-2 bg-white",children:[(0,h.jsx)("div",{className:"w-full",children:(0,h.jsx)("h4",{className:"text-gray-700",children:"Records Table"})}),(0,h.jsxs)("div",{className:"relative",children:[(0,h.jsxs)("button",{onClick:()=>t(!e),className:"flex items-center px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",children:[(0,h.jsx)(o.OXb,{className:"mr-2"}),"Export",(0,h.jsx)("span",{className:"ml-2 text-sm",children:"\u25bc"})]}),e&&(0,h.jsx)("div",{className:"absolute right-0 z-10 w-40 mt-2 bg-white rounded-md shadow-lg",onMouseLeave:()=>t(!1),children:(0,h.jsxs)("div",{className:"py-1",children:[(0,h.jsxs)("button",{onClick:()=>{(()=>{const e=[];T.forEach(((t,s)=>{var a;null===(a=t.items)||void 0===a||a.forEach((a=>{var l;e.push({"#":s+1,Type:"Items Sold","Item Name":(null===(l=a.item)||void 0===l?void 0:l.itemName)||"NA",Quantity:a.quantity,Date:t.date||"NA"})}))}));const t=[];O.forEach(((e,s)=>{var a;null===(a=e.items)||void 0===a||a.forEach((a=>{var l;t.push({"#":s+1,Type:"Items Transferred","Item Name":(null===(l=a.item)||void 0===l?void 0:l.itemName)||"NA",Quantity:a.quantity,Date:e.date||"NA"})}))}));const s=_.map(((e,t)=>({"#":t+1,Type:"Items to Transfer","Item Name":e.itemName,Quantity:e.sold-e.transferred,Date:"NA"}))),a=[...e,...t,...s],l=x.utils.json_to_sheet(a),r=x.utils.book_new();x.utils.book_append_sheet(r,l,"InventoryReport"),x.writeFile(r,"Inventory_Report.xlsx")})(),t(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,h.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),(0,h.jsxs)("button",{onClick:()=>{(()=>{const e=new c.Ay;let t=10;e.setFontSize(18),e.text("Inventory Movement Report",105,t,{align:"center"}),t+=15,e.setFontSize(14),e.text("Items Sold",14,t),t+=8;const s=[];T.forEach(((e,t)=>{var a;null===(a=e.items)||void 0===a||a.forEach((a=>{var l;s.push([t+1,(null===(l=a.item)||void 0===l?void 0:l.itemName)||"NA",a.quantity,new Date(e.saleDate).toISOString()||"NA"])}))})),(0,m.Ay)(e,{startY:t,head:[["#","Item Name","Quantity","Date"]],body:s.length>0?s:[["No data available","","",""]],margin:{top:10},styles:{fontSize:10}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("Items Transferred to Warehouse",14,t),t+=8;const a=[];O.forEach(((e,t)=>{var s;null===(s=e.items)||void 0===s||s.forEach((s=>{var l;a.push([t+1,(null===(l=s.item)||void 0===l?void 0:l.itemName)||"NA",s.quantity,new Date(e.transferDate).toISOString()||"NA"])}))})),(0,m.Ay)(e,{startY:t,head:[["#","Item Name","Quantity","Date"]],body:a.length>0?a:[["No data available","","",""]],margin:{top:10},styles:{fontSize:10}}),t=e.lastAutoTable.finalY+10,e.setFontSize(14),e.text("Items Required to Transfer",14,t),t+=8;const l=_.map(((e,t)=>[t+1,e.itemName,e.sold-e.transferred,"NA"]));(0,m.Ay)(e,{startY:t,head:[["#","Item Name","Quantity","Date"]],body:l.length>0?l:[["No items to transfer","","",""]],margin:{top:10},styles:{fontSize:10}}),e.save("Inventory_Movement_Report.pdf")})(),t(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,h.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,h.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"PDF"]})]})})]})]}),(0,h.jsxs)("div",{className:"flex flex-col justify-between w-full gap-2 px-2 py-2 overflow-x-auto md:flex-row",children:[(0,h.jsxs)("div",{className:"w-full h-auto bg-white border-2",children:[(0,h.jsx)("h5",{className:"text-center",children:"Items Sold"}),(0,h.jsxs)("table",{className:"min-w-full gap-2 border-separate",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"#"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Item Name"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Quantity"})]})}),(0,h.jsxs)("tbody",{children:[C&&T.length>0&&T.map(((e,t)=>{var s;return null===(s=e.items)||void 0===s?void 0:s.map(((e,s)=>{var a;return(0,h.jsxs)("tr",{className:"bg-gray-100 border-2 border-black",children:[(0,h.jsx)("td",{className:"px-4 py-2",children:t+1}),(0,h.jsx)("td",{className:"px-4 py-2",children:null===(a=e.item)||void 0===a?void 0:a.itemName}),(0,h.jsx)("td",{className:"px-4 py-2",children:e.quantity})]},`${t}-${s}`)}))})),C&&0===T.length&&C&&(0,h.jsx)("tr",{className:"bg-gray-100 border-2 border-black",children:(0,h.jsx)("td",{className:"px-4 py-2 text-center",colSpan:"10",children:(0,h.jsx)("h5",{children:"No Data Found"})})})]})]})]}),(0,h.jsxs)("div",{className:"w-full h-auto bg-white border-2",children:[(0,h.jsx)("h5",{className:"text-center",children:"Items transferred to warehouse "}),(0,h.jsxs)("table",{className:"min-w-full gap-2 border-separate",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"#"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Item Name"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Quantity"})]})}),(0,h.jsxs)("tbody",{children:[C&&O.length>0&&O.map(((e,t)=>{var s;return null===(s=e.items)||void 0===s?void 0:s.map(((e,s)=>{var a;return(0,h.jsxs)("tr",{className:"bg-gray-100 border-2 border-black",children:[(0,h.jsx)("td",{className:"px-4 py-2",children:t+1}),(0,h.jsx)("td",{className:"px-4 py-2",children:(null===(a=e.item)||void 0===a?void 0:a.itemName)||"NA"}),(0,h.jsx)("td",{className:"px-4 py-2",children:e.quantity})]},`${t}-${s}`)}))})),C&&0===O.length&&C&&(0,h.jsx)("tr",{className:"bg-gray-100 border-2 border-black",children:(0,h.jsx)("td",{className:"px-4 py-2 text-center",colSpan:"10",children:(0,h.jsx)("h5",{children:"No Data Found"})})})]})]})]}),(0,h.jsxs)("div",{className:"w-full overflow-x-scroll bg-white border-2",children:[(0,h.jsx)("h5",{className:"text-center",children:"Items required to transfer"}),(0,h.jsxs)("table",{className:"min-w-full gap-2 border-separate",children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"#"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Item Name"}),(0,h.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Quantity"})]})}),(0,h.jsxs)("tbody",{children:[_.length>0&&_.map(((e,t)=>(0,h.jsxs)("tr",{className:"bg-gray-100 border-2 border-black",children:[(0,h.jsx)("td",{className:"px-4 py-2",children:t+1}),(0,h.jsx)("td",{className:"px-4 py-2",children:e.itemName}),(0,h.jsx)("td",{className:"px-4 py-2",children:e.sold-e.transferred})]},t))),C&&0===_.length&&(0,h.jsx)("tr",{className:"bg-gray-100 border-2 border-black",children:(0,h.jsx)("td",{className:"px-4 py-2 text-center",colSpan:"4",children:"No item to transfer"})})]})]})]})]})]})]})]})]})}}}]);
//# sourceMappingURL=6939.01ed3156.chunk.js.map