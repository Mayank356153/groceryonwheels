"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8758],{14840:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(65043),l=s(21197),n=s(59255),r=s(70579);function o(){const[e,t]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,r.jsx)(l.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,r.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,r.jsx)("div",{children:(0,r.jsx)(n.A,{isSidebarOpen:e})}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,r.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},78758:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(65043),l=s(66727),n=s(60184),r=s(21197),o=s(59255),c=s(86213),d=s(26873),i=s(64857),m=s(11238),x=s(37762),h=s(14840),p=s(70579);const y=()=>{(0,l.Zp)();const[e,t]=(0,a.useState)(!0),[s,y]=(0,a.useState)(""),[u,b]=(0,a.useState)(10),[f,g]=(0,a.useState)(1),[j,N]=(0,a.useState)([]),[w,v]=(0,a.useState)([]),[C,S]=(0,a.useState)(""),[k,A]=(0,a.useState)(0),[P,$]=(0,a.useState)(!1),[L,T]=(0,a.useState)(null);(0,a.useEffect)((()=>{window.innerWidth<768&&t(!1)}),[]);const D=async()=>{const e=localStorage.getItem("token");if(e){$(!0);try{const t=await c.A.get("api/payments",{headers:{Authorization:`Bearer ${e}`}});console.log("Sales List"),console.log(t.data),console.log("\ud83d\udcd1 payments payload:",t.data),v(t.data)}catch(t){alert(t.message)}finally{$(!1)}}else console.log("No token found redirecting...")},E=w.filter((e=>{const t="all"===C||""===C||e.paymentType===C,a=e.customer.toLowerCase().includes(s.toLowerCase());return t&&a}));(0,a.useEffect)((()=>{(()=>{const e=E.reduce(((e,t)=>e+t.paymentAmount),0);A(e)})()}),[E]),(0,a.useEffect)((()=>{D(),(async()=>{const e=localStorage.getItem("token");if(e){$(!0);try{const t=await c.A.get("api/payment-types",{headers:{Authorization:`Bearer ${e}`}});console.log("Payment Type List"),console.log(t.data);const s=[{label:"All",value:"all"},...t.data.data.filter((e=>"active"===e.status)).map((e=>({label:e.paymentTypeName,value:e.paymentTypeName})))];N(s)}catch(t){alert(t.message)}finally{$(!1)}}else console.log("No token found redirecting...")})()}),[]);const I=Math.ceil(E.length/u),O=E.slice((f-1)*u,f*u),B=e=>{e>=1&&e<=I&&g(e)};return P?(0,p.jsx)(h.A,{}):(0,p.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,p.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,p.jsxs)("div",{className:"box-border flex min-h-screen ",children:[(0,p.jsx)("div",{className:"w-auto",children:(0,p.jsx)(o.A,{isSidebarOpen:e})}),(0,p.jsxs)("div",{className:"overflow-x-auto  flex flex-col p-2 md:p-2 min-h-screen w-full",children:[(0,p.jsxs)("header",{className:"flex flex-col items-center justify-start px-2 py-2 mb-2 bg-gray-100 rounded-md shadow md:justify-between md:flex-row",children:[(0,p.jsxs)("div",{className:"flex items-baseline gap-2 sm:flex-row sm:text-left",children:[(0,p.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"Sales Payment List"}),(0,p.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"View/Search Sales Payment"})]}),(0,p.jsxs)("nav",{className:"flex flex-wrap items-center justify-center gap-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,p.jsxs)(l.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,p.jsx)(n.$BV,{className:"text-gray-500 hover:text-cyan-600"})," Home"]}),(0,p.jsx)(l.k2,{to:"/sales-payment",className:"text-gray-700 no-underline hover:text-cyan-600",children:"> Sales Payment List"})]})]}),(0,p.jsx)("div",{className:"flex flex-col flex-wrap gap-2 p-4 bg-white border rounded-md shadow-md md:flex-row",children:(0,p.jsxs)("div",{className:"flex flex-col",children:[(0,p.jsx)("label",{className:"text-sm font-semibold text-gray-700",children:"Payment Type"}),(0,p.jsx)(d.Ay,{options:j,className:"w-64",onChange:e=>S(e.value)})]})}),(0,p.jsxs)("div",{className:"flex flex-col justify-between mt-4 mb-4 space-y-2 md:flex-row md:space-y-0 md:items-center",children:[(0,p.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,p.jsx)("span",{className:"text-sm",children:"Show"}),(0,p.jsxs)("select",{className:"p-2 text-sm border border-gray-300 rounded-md",value:u,onChange:e=>{b(Number(e.target.value)),g(1)},children:[(0,p.jsx)("option",{children:"10"}),(0,p.jsx)("option",{children:"20"}),(0,p.jsx)("option",{children:"50"})]}),(0,p.jsx)("span",{className:"text-sm",children:"Entries"})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between flex-1 gap-2",children:[(0,p.jsx)("button",{onClick:()=>{const e=E.map((e=>`${e.paymentCode}, ${new Date(e.paymentDate).toDateString()},${e.saleCode},${e.customer},${e.paymentAmount},${e.paymentType},${e.paymentNote},${e.creatorName||"N/A"} `)).join("\n");navigator.clipboard.writeText(e),alert("Data copied to clipboard!")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Copy"}),(0,p.jsx)("button",{onClick:()=>{const e=m.utils.json_to_sheet(E),t=m.utils.book_new();m.utils.book_append_sheet(t,e,"salepayment"),m.writeFile(t,"salepayment.xlsx")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Excel"}),(0,p.jsx)("button",{onClick:()=>{const e=new x.uE;e.text("Roles List",20,20);const t=E.map((e=>[e.paymentCode,new Date(e.paymentDate).toDateString(),e.saleCode,e.customer,e.paymentAmount,e.paymentType,e.paymentNote,e.creatorName||"N/A"]));(0,i.Ay)(e,{head:[["Payment Code","Payment Date","Sales Code","Customer Name","Payment","Payment Type","Payment Note","Created by"]],body:t}),e.save("salePayment.pdf")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"PDF"}),(0,p.jsx)("button",{onClick:()=>{window.print()},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Print"}),(0,p.jsx)("button",{onClick:()=>{const e="data:text/csv;charset=utf-8,"+E.map((e=>Object.values(e).join(","))).join("\n"),t=encodeURI(e),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download","salepayment.csv"),document.body.appendChild(s),s.click(),document.body.removeChild(s)},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"CSV"})]}),(0,p.jsx)("input",{type:"text",placeholder:"Search",className:"w-full p-2 text-sm border border-gray-300 ",onChange:e=>y(e.target.value)})]})]}),(0,p.jsx)("div",{className:"mt-6 overflow-x-auto",children:(0,p.jsxs)("table",{className:"min-w-full bg-white border border-gray-300 shadow-sm",children:[(0,p.jsx)("thead",{className:"bg-gray-200",children:(0,p.jsx)("tr",{children:["Payment Code","Sales Code","Customer Name","Payment","Payment Type","Payment Note","Created by"].map((e=>(0,p.jsx)("th",{className:"px-4 py-2 text-sm font-bold text-left border",children:e},e)))})}),(0,p.jsxs)("tbody",{children:[O.length<=0?(0,p.jsx)("tr",{children:(0,p.jsx)("td",{colSpan:"10",className:"p-4 text-center text-gray-500 border",children:"No data available in table"})}):O.map((e=>(0,p.jsxs)("tr",{className:"bg-gray-100 ",children:[(0,p.jsx)("td",{className:"text-center border",children:e.paymentCode}),(0,p.jsx)("td",{className:"text-center border",children:e.saleCode}),(0,p.jsx)("td",{className:"text-center border",children:e.customer}),(0,p.jsx)("td",{className:"text-center border",children:e.paymentAmount}),(0,p.jsx)("td",{className:"text-center border",children:e.paymentType}),(0,p.jsx)("td",{className:"text-center border",children:e.paymentNote}),(0,p.jsx)("td",{className:"text-center border",children:e.creatorName||"N/A"}),(0,p.jsx)("td",{className:"relative p-2 border",children:L===e.saleId&&(0,p.jsx)("div",{className:"absolute right-0 z-40 mt-2 bg-white border shadow-lg w-28",children:(0,p.jsx)("button",{className:"w-full px-1 py-0 text-left text-red-500 hover:bg-gray-100",onClick:()=>(async e=>{if(!window.confirm("Are you sure you want to delete this payment?"))return;const t=localStorage.getItem("token");if(!t)return alert("No token, please login again.");$(!0);try{await c.A.delete(`/api/sales/payments/${e}`,{headers:{Authorization:`Bearer ${t}`}}),await D(),alert("Payment deleted")}catch(l){var s,a;console.error(l),alert((null===(s=l.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||l.message)}finally{$(!1)}})(e.paymentId),children:"\ud83d\uddd1\ufe0f Delete"})})})]},e.saleId))),O.length>0&&(0,p.jsxs)("tr",{className:"font-bold bg-gray-100",children:[(0,p.jsx)("td",{colSpan:"4",className:"text-right border",children:"Total :"}),(0,p.jsx)("td",{className:"text-center border",children:k}),(0,p.jsx)("td",{className:"text-center border"}),(0,p.jsx)("td",{className:"text-center border"}),(0,p.jsx)("td",{className:"text-center border"}),(0,p.jsx)("td",{className:"text-center border"})]})]})]})}),(0,p.jsxs)("div",{className:"flex flex-col items-start justify-between gap-2 p-2 md:justify-between md:flex-row",children:[(0,p.jsxs)("span",{children:["                    ",(0,p.jsxs)("span",{children:["Showing ",u*(f-1)+1," to ",Math.min(u*f,E.length)," of ",E.length," entries"]}),"              "]}),(0,p.jsxs)("div",{className:"flex justify-between w-full md:w-auto md:gap-2",children:[(0,p.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 shadow-md \n    "+(1===f?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"),onClick:()=>B(f-1),disabled:1===f,children:[(0,p.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Previous"]}),(0,p.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 shadow-md \n    "+(f===I?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"),onClick:()=>B(f+1),disabled:f===I,children:["Next",(0,p.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,p.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]})]})]})]})}}}]);
//# sourceMappingURL=8758.93a7636e.chunk.js.map