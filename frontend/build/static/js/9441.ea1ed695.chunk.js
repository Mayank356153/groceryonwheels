"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9441],{69441:(e,t,s)=>{s.r(t),s.d(t,{default:()=>i});var r=s(65043),o=s(21197),l=s(59255),n=s(66727),a=s(70579);const i=()=>{const[e,t]=(0,r.useState)(!0),[s,i]=(0,r.useState)(1),[d,c]=(0,r.useState)(10),[u,x]=(0,r.useState)([]),[h,p]=(0,r.useState)(null),[f,m]=(0,r.useState)(null),[b,g]=(0,r.useState)({top:0,left:0}),j=(0,n.Zp)(),y=(0,r.useRef)(null),N=(0,r.useRef)({}),w=(0,r.useRef)({});(0,r.useEffect)((()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&p(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,r.useEffect)((()=>{(async()=>{const e=localStorage.getItem("token");if(e)try{const t=await fetch("/admin/store/add/store",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw new Error(`Failed to fetch stores: ${t.statusText}`);const s=await t.json();console.log("Fetched stores data:",s);const r=Array.isArray(s)?s:s.result||s.stores||[];r.length||console.warn("No stores found in response"),x(r),m(null)}catch(f){console.error("Error fetching stores:",f),m("Failed to load stores. Please try again.")}else m("No authentication token found. Please log in.")})()}),[]);const v=s*d,S=v-d,A=u.slice(S,v),k=Math.ceil(u.length/d);return(0,a.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,a.jsx)(o.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,a.jsxs)("div",{className:"flex flex-grow bg-gray-200",children:[(0,a.jsx)("div",{className:"w-auto",children:(0,a.jsx)(l.A,{isSidebarOpen:e})}),(0,a.jsxs)("div",{className:"w-full p-8 mx-auto bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h1",{className:"text-2xl font-bold",children:["Store List",(0,a.jsx)("span",{className:"text-black text-[16px]",children:"View/Search Items Store"})]}),(0,a.jsx)("button",{className:"px-4 py-2 font-bold text-white bg-blue-500 rounded hover:bg-blue-600 transition-colors duration-200",onClick:()=>j("/store/add"),children:"+ Create Store"})]}),f&&(0,a.jsx)("div",{className:"mb-4 p-4 bg-red-100 text-red-700 rounded",children:f}),(0,a.jsxs)("div",{className:"flex justify-start mb-4",children:[(0,a.jsx)("label",{className:"mr-2 font-semibold text-gray-700",children:"Items per page:"}),(0,a.jsxs)("select",{className:"px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:d,onChange:e=>{c(Number(e.target.value)),i(1)},children:[(0,a.jsx)("option",{value:"10",children:"10"}),(0,a.jsx)("option",{value:"25",children:"25"}),(0,a.jsx)("option",{value:"50",children:"50"}),(0,a.jsx)("option",{value:"75",children:"75"}),(0,a.jsx)("option",{value:"100",children:"100"})]})]}),(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-200",children:[(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"#"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Store Code"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Store Name"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Mobile"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Address"}),(0,a.jsx)("th",{className:"px-4 py-2 text-left",children:"Action"})]})}),(0,a.jsx)("tbody",{children:0!==u.length||f?A.map(((e,t)=>(0,a.jsxs)("tr",{className:"relative border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-2",children:S+t+1}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.StoreCode||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.StoreName||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.Mobile||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-2",children:e.Address||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-2",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{ref:t=>N.current[e._id]=t,className:"px-3 py-1.5 font-semibold text-white bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:t=>(e=>{if(h===e)return void p(null);p(e);const t=N.current[e];if(t){const e=t.getBoundingClientRect(),s=192,r=160,o=(window.innerWidth,window.innerHeight);let l=e.bottom+8,n=e.right-s;n<8&&(n=8),l+r>o-8&&(l=e.top-r-8),l<8&&(l=8),g({top:l,left:n})}})(e._id),children:"Action"}),h===e._id&&(0,a.jsxs)("div",{ref:t=>w.current[e._id]=t,className:"fixed bg-white border border-gray-200 rounded-lg shadow-xl z-[100] w-48 animate-slide-in",style:{top:`${b.top}px`,left:`${b.left}px`,animation:"slideIn 0.15s ease-in-out forwards"},children:[(0,a.jsx)("button",{className:"w-full px-4 py-2 text-left text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors duration-150",onClick:t=>{t.stopPropagation(),p(null),j(`/admin/store/edit?id=${e._id}`)},children:"Edit"}),(0,a.jsx)("button",{className:"w-full px-4 py-2 text-left text-red-600 hover:bg-red-50 hover:text-red-700 transition-colors duration-150",onClick:t=>{t.stopPropagation(),p(null),(async e=>{if(window.confirm("Are you sure you want to delete this store?"))try{const t=localStorage.getItem("token");if(!(await fetch(`/admin/store/store/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}})).ok)throw new Error("Failed to delete store");alert("Store deleted successfully!");const s=await fetch("/admin/store/add/store",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw new Error("Failed to fetch stores after deletion");const r=await s.json(),o=Array.isArray(r)?r:r.result||r.stores||[];x(o),m(null)}catch(f){console.error("Error deleting store:",f.message),alert(`Error: ${f.message}`),m("Failed to delete store. Please try again.")}})(e._id)},children:"Delete"}),(0,a.jsx)("button",{className:"w-full px-4 py-2 text-left text-blue-600 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150",onClick:t=>{t.stopPropagation(),p(null),j(`/subscription-list?storeId=${e._id}`)},children:"View Subscriptions"}),(0,a.jsx)("button",{className:"w-full px-4 py-2 text-left text-blue-600 hover:bg-blue-50 hover:text-blue-700 transition-colors duration-150",onClick:t=>{t.stopPropagation(),p(null),j(`/add-subscription?storeId=${e._id}`)},children:"Add Subscription"})]})]})})]},e._id||t))):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:"6",className:"px-4 py-2 text-center",children:"No stores found."})})})]})}),u.length>0&&(0,a.jsx)("div",{className:"flex justify-center mt-4",children:Array.from({length:k},((e,t)=>t+1)).map((e=>(0,a.jsx)("button",{className:"mx-1 px-4 py-2 rounded-lg transition-colors duration-200 "+(s===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),onClick:()=>(e=>{e>=1&&e<=k&&i(e)})(e),children:e},e)))})]})]})]})}}}]);
//# sourceMappingURL=9441.ea1ed695.chunk.js.map