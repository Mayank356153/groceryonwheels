"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[3094],{14840:(e,t,r)=>{r.d(t,{A:()=>l});var a=r(65043),s=r(21197),n=r(59255),o=r(70579);function l(){const[e,t]=(0,a.useState)(!1);return(0,o.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,o.jsx)(s.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,o.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,o.jsx)("div",{children:(0,o.jsx)(n.A,{isSidebarOpen:e})}),(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,o.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},23094:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(65043),s=r(96130),n=r(60184),o=r(21197),l=r(59255),i=r(86213),c=r(66727),d=r(14840),u=r(53888),m=r(31782),x=r(70579);const f=()=>{const[e]=(0,c.ok)(),t=e.get("id"),[r,f]=(0,a.useState)(!0),[h,g]=(0,a.useState)(!1),[v,p]=(0,a.useState)([]),[w,b]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[N,k]=(0,a.useState)({type:"",item:""});(0,a.useEffect)((()=>{window.innerWidth<768&&f(!1)}),[window.innerWidth]);(0,a.useEffect)((()=>{(async()=>{try{g(!0);const e=await i.A.get("api/items",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),p(e.data.data)}catch(e){console.error("Error fetching item code:",e)}finally{g(!1)}})(),t&&(async()=>{try{g(!0);const a=await i.A.get("api/marketing-item/all",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(a.data.data);const s=Object.keys(a.data.data);for(const n of s){const s=a.data.data[n].filter((e=>e._id===t));if(s.length>0){var e,r;const t=s[0];k({type:t.type,items:null===(e=t.item)||void 0===e?void 0:e._id}),b(null===(r=t.item)||void 0===r?void 0:r.itemName);break}}}catch(a){console.error("Error fetching :",a)}finally{g(!1)}})()}),[]);const C=y?v.filter((e=>{var t,r;const a=y.toLowerCase();return(null===(t=e.itemName)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.itemCode)||void 0===r?void 0:r.toLowerCase().includes(a))||e.barcode&&e.barcode.toLowerCase().includes(a)})):[];(0,a.useEffect)((()=>{y&&v.filter((e=>{var t,r;const a=y.toLowerCase();return(null===(t=e.itemName)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.itemCode)||void 0===r?void 0:r.toLowerCase().includes(a))||e.barcode&&e.barcode.toLowerCase().includes(a)}))}),[y]);const[A,S]=(0,a.useState)(!1),E=(0,a.useRef)(null),L=(0,a.useRef)(null);(0,a.useEffect)((()=>{if(!A)return;return(async()=>{if(!E.current)return;const e=new m.sx;L.current=e;const t=async t=>{const r={video:{facingMode:t,advanced:[{width:1920},{height:1080},{zoom:2}]}};return e.decodeFromConstraints(r,E.current,((e,t)=>{if(e){var r,a,s,n;const t=e.getText();alert(t),j(t),null===(r=(a=window.navigator).vibrate)||void 0===r||r.call(a,200);new Audio("/beep.mp3").play();const o=null===(s=E.current)||void 0===s?void 0:s.srcObject;null===o||void 0===o||o.getTracks().forEach((e=>e.stop())),null!==(n=L.current)&&void 0!==n&&n.reset&&"function"===typeof L.current.reset&&L.current.reset(),S(!1)}t&&"NotFoundException"!==t.name&&console.error("Scan error:",t)}))};try{await t({exact:"environment"})}catch(r){if("OverconstrainedError"===r.name||"NotFoundError"===r.name){console.warn("Back camera not found. Trying front camera...");try{await t("user")}catch(a){console.error("Front camera also failed:",a),alert("No camera found or accessible."),S(!1)}}else console.error("Camera access error:",r),alert("Camera access error: "+r.message),S(!1)}})(),()=>{var e,t;const r=null===(e=E.current)||void 0===e?void 0:e.srcObject;null===r||void 0===r||r.getTracks().forEach((e=>e.stop())),null!==(t=L.current)&&void 0!==t&&t.reset&&"function"===typeof L.current.reset&&L.current.reset()}}),[A]);return h?(0,x.jsx)(d.A,{}):(0,x.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,x.jsx)(o.A,{isSidebarOpen:r,setSidebarOpen:f}),(0,x.jsxs)("div",{className:"flex flex-grow ",children:[(0,x.jsx)(l.A,{isSidebarOpen:r}),(0,x.jsxs)("div",{className:"flex-grow flex flex-col p-2 md:p-2  ",children:[(0,x.jsxs)("header",{className:"flex flex-col items-center justify-between p-4 rounded-md shadow sm:flex-row",children:[(0,x.jsxs)("div",{className:"flex items-center gap-1 text-center sm:flex-row sm:text-left",children:[(0,x.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"New Marketing Item"}),(0,x.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"Add/Update marketingitem"})]}),(0,x.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,x.jsxs)(c.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,x.jsx)(n.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,x.jsx)(c.k2,{to:"/marketingitem/view",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:"> Marketing Item List"}),(0,x.jsx)(c.k2,{to:"/marketingitem/add",className:"text-gray-700 no-underline hover:text-cyan-600",children:"> Add Marketing Item"})]})]}),(0,x.jsx)("div",{className:"p-4 mt-1 bg-white border-t-4 rounded-lg shadow-md border-cyan-500",children:(0,x.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{if(g(!0),console.log(N),t){const e=await i.A.put(`api/marketing-item/${t}`,N,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e),alert("marketing item update successfully")}else{const e=await i.A.post("api/marketing-item/add",N,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e),alert("marketing item successfully"),k({type:"",item:""})}}catch(r){console.error("Error",r)}finally{g(!1)}},children:[(0,x.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,x.jsxs)("div",{className:"flex flex-col w-full",children:[(0,x.jsx)("label",{htmlFor:"",children:" Type"}),(0,x.jsx)("input",{type:"text",name:"type",className:"px-2 py-1 border-2 rounded-md",value:N.type,onChange:e=>k((t=>({...t,type:e.target.value})))})]}),(0,x.jsxs)("div",{className:"relative flex flex-col w-full py-2",children:[(0,x.jsx)("label",{htmlFor:"",children:"Items"}),(0,x.jsxs)("label",{htmlFor:"",className:"flex",children:[(0,x.jsx)("input",{type:"text",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",value:w,onChange:e=>{j(e.target.value),b(e.target.value)}}),(0,x.jsx)("button",{type:"button",className:"p-2 ml-2 text-white rounded-full hover:bg-blue-600",onClick:()=>S(!0),children:(0,x.jsx)(s.A,{className:"w-6 h-6 text-gray-500"})})]}),""!==y&&(0,x.jsx)("div",{className:"absolute z-50 w-full overflow-y-auto bg-white border rounded-lg shadow-lg top-20 sm:w-96 max-h-60 touch-auto",style:{WebkitOverflowScrolling:"touch"},children:(0,x.jsx)("ul",{children:C.map((e=>(0,x.jsxs)("li",{onClick:()=>{b(e.itemName),k((t=>({...t,item:e._id}))),j("")},className:"p-2 cursor-pointer hover:bg-gray-100",children:[(0,x.jsx)("strong",{children:e.itemCode})," - ",e.itemName," - ",e.barcode]},e.itemCode)))})}),A&&(0,x.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black bg-opacity-50",children:[(0,x.jsxs)("div",{className:"relative overflow-hidden border-4 border-white rounded-lg shadow-xl w-72 h-72",children:[(0,x.jsx)("video",{ref:E,className:"absolute object-cover w-full h-full",autoPlay:!0,muted:!0,playsInline:!0}),(0,x.jsx)("div",{className:"absolute w-full h-1 bg-red-500 animate-scan"})]}),(0,x.jsx)("button",{onClick:()=>{var e,t;const r=null===(e=E.current)||void 0===e?void 0:e.srcObject;null===r||void 0===r||r.getTracks().forEach((e=>e.stop())),null!==(t=L.current)&&void 0!==t&&t.reset&&"function"===typeof L.current.reset&&L.current.reset(),S(!1)},className:"px-4 py-2 mt-6 text-white bg-red-600 rounded hover:bg-red-700",children:"Cancel"})]})]})]}),(0,x.jsxs)("div",{className:"flex flex-col items-center justify-around w-full gap-2 mx-auto sm:flex-row",children:[(0,x.jsx)(u.A,{className:"w-full text-white bg-green-500 rounded cursor-pointer hover:bg-green-600",type:"submit",text:t?"Update":"Save"})," ",(0,x.jsx)(u.A,{className:"w-full text-white bg-orange-500 rounded cursor-pointer hover:bg-orange-600",text:"Close"})," "]})]})})]})]})]})}},53888:(e,t,r)=>{r.d(t,{A:()=>s});r(65043);var a=r(70579);function s(e){let{text:t,type:r="button",className:s,...n}=e;return(0,a.jsx)("button",{className:`${s}`,...n,children:t})}},96130:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(65043);const s=a.forwardRef((function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"}))}))}}]);
//# sourceMappingURL=3094.8e83f24f.chunk.js.map