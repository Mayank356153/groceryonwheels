"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2137],{52137:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(65043),n=a(86213),r=a(60184),i=a(21197),d=a(59255),l=a(70579);const c=n.A.create({baseURL:"/vps/api"});function o(){const[e,s]=(0,t.useState)(!0),[a,n]=(0,t.useState)([]),[o,h]=(0,t.useState)([]),[x,g]=(0,t.useState)(!1),[u,m]=(0,t.useState)(null),[p,j]=(0,t.useState)({});(0,t.useEffect)((()=>{g(!0),Promise.all([c.get("/bookings/pending"),c.get("/warehouses")]).then((e=>{let[s,a]=e;n(s.data.data);const t=a.data.data||a.data.warehouses||[];h(t),m(null)})).catch((()=>m("Failed to load bookings or vans"))).finally((()=>g(!1)))}),[]);return(0,l.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,l.jsx)(i.A,{isSidebarOpen:e,setSidebarOpen:s}),(0,l.jsxs)("div",{className:"flex flex-1",children:[(0,l.jsx)(d.A,{isSidebarOpen:e}),(0,l.jsxs)("main",{className:"flex-1 p-6 bg-gray-100 overflow-auto",children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Assign Vans to Bookings"}),u&&(0,l.jsx)("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:u}),x?(0,l.jsx)("div",{children:"Loading\u2026"}):0===a.length?(0,l.jsx)("div",{className:"text-gray-600",children:"No pending bookings."}):(0,l.jsx)("div",{className:"space-y-4",children:a.map((e=>(0,l.jsxs)("div",{className:"bg-white p-4 rounded shadow",children:[(0,l.jsxs)("div",{className:"mb-2 text-gray-800",children:[(0,l.jsx)("strong",{children:"Customer:"})," ",e.customer.name," (",e.customer.phone,")"]}),(0,l.jsxs)("div",{className:"mb-2 text-gray-700",children:[(0,l.jsx)("strong",{children:"Pickup:"})," ",e.pickupAddress.street,", ",e.pickupAddress.area,", ",e.pickupAddress.city]}),(0,l.jsxs)("div",{className:"mb-2 text-gray-700",children:[(0,l.jsx)("strong",{children:"Type:"})," ",e.type,"scheduled"===e.type&&(0,l.jsxs)("span",{className:"ml-4",children:[(0,l.jsx)("strong",{children:"When:"})," ",new Date(e.scheduledFor).toLocaleString()]})]}),(0,l.jsxs)("div",{className:"mb-4 text-gray-700",children:[(0,l.jsx)("strong",{children:"Remark:"})," ",e.remark||(0,l.jsx)("em",{children:"none"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("select",{className:"flex-1 p-2 border border-gray-300 rounded",value:p[e._id]||"",onChange:s=>j((a=>({...a,[e._id]:s.target.value}))),children:[(0,l.jsx)("option",{value:"",children:"Select a van\u2026"}),o.map((e=>(0,l.jsx)("option",{value:e._id,children:e.warehouseName},e._id)))]}),(0,l.jsxs)("button",{onClick:()=>(async e=>{const s=p[e];if(!s)return alert("Please select a van before assigning.");try{await c.patch(`/bookings/${e}/assign`,{vanId:s}),n((s=>s.filter((s=>s._id!==e))))}catch(r){var a,t;alert("Assign failed: "+((null===(a=r.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||r.message))}})(e._id),className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 flex items-center gap-1",children:[(0,l.jsx)(r.CMH,{})," Assign"]})]})]},e._id)))})]})]})]})}c.interceptors.request.use((e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e}))}}]);
//# sourceMappingURL=2137.fefa4130.chunk.js.map