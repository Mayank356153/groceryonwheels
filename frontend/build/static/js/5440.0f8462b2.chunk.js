"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5440],{14840:(e,t,n)=>{n.d(t,{A:()=>l});var s=n(65043),o=n(21197),a=n(59255),r=n(70579);function l(){const[e,t]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,r.jsx)(o.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,r.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,r.jsx)("div",{children:(0,r.jsx)(a.A,{isSidebarOpen:e})}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,r.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},57549:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var s=n(65043),o=n(66727),a=n(26873),r=n(21197),l=n(59255),i=n(14840),d=n(86213),c=n(70579);function u(){const[e]=(0,o.ok)(),t=e.get("id"),n=(0,o.Zp)(),u=localStorage.getItem("token"),m={Authorization:`Bearer ${u}`},[p,b]=(0,s.useState)(window.innerWidth>=768),[f,h]=(0,s.useState)(!0),[x,v]=(0,s.useState)(!1),[g,j]=(0,s.useState)([]),[N,y]=(0,s.useState)([]),[A,S]=(0,s.useState)(null),[w,D]=(0,s.useState)([]),[k,C]=(0,s.useState)({depositDate:(new Date).toLocaleDateString("en-CA"),referenceNo:"",debitAccount:"",creditAccount:"",amount:"",note:""});(0,s.useEffect)((()=>{const e=()=>b(window.innerWidth>=768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,s.useEffect)((()=>{if(!u)return n("/");const e=d.A.get("/admin/store/add/store",{headers:m}).then((e=>j(e.data.result||[]))).catch(console.error),s=d.A.get("/api/accounts",{headers:m}).then((e=>y(e.data.data||[]))).catch(console.error);let o=Promise.resolve();t&&(o=d.A.get(`/api/deposits/${t}`,{headers:m}).then((e=>{var t,n;const s=e.data.data;C({depositDate:new Date(s.depositDate).toISOString().slice(0,10),referenceNo:s.referenceNo||"",debitAccount:(null===(t=s.debitAccount)||void 0===t?void 0:t._id)||"",creditAccount:(null===(n=s.creditAccount)||void 0===n?void 0:n._id)||"",amount:s.amount||"",note:s.note||""})})).catch(console.error)),Promise.all([e,s,o]).finally((()=>h(!1)))}),[t,n,u]),(0,s.useEffect)((()=>{var e;if(!g.length)return;const t=localStorage.getItem("storeId"),n=g.find((e=>e._id===t));if(!n)return;const s="string"===typeof n.storeAccount?n.storeAccount:null===(e=n.storeAccount)||void 0===e?void 0:e._id;S(s),C((e=>({...e,debitAccount:s})))}),[g]),(0,s.useEffect)((()=>{if(!A||!N.length)return;const e=N.filter((e=>{var t;return("string"===typeof e.parentAccount?e.parentAccount:null===(t=e.parentAccount)||void 0===t?void 0:t._id)===A})).map((e=>({value:e._id,label:`${e.accountNumber} \u2013 ${e.accountName}`})));D(e)}),[N,A]);const O=e=>{const{name:t,value:n}=e.target;C((e=>({...e,[t]:n})))};if(f)return(0,c.jsx)(i.A,{});const E=N.find((e=>e._id===A)),$=E?`${E.accountNumber} \u2013 ${E.accountName}`:"Loading\u2026";return(0,c.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,c.jsx)(r.A,{isSidebarOpen:p,setSidebarOpen:b}),(0,c.jsxs)("div",{className:"flex flex-grow",children:[(0,c.jsx)(l.A,{isSidebarOpen:p}),(0,c.jsx)("main",{className:"flex-1 p-6 bg-gray-100 overflow-auto",children:(0,c.jsxs)("div",{className:"bg-white p-6 rounded shadow-lg",children:[(0,c.jsx)("h1",{className:"text-2xl font-bold mb-4",children:t?"Edit Deposit":"Add Deposit"}),(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),v(!0);try{const e=t?`/api/deposits/${t}`:"/api/deposits",s=t?"put":"post";await d.A[s](e,k,{headers:{"Content-Type":"application/json",...m}}),alert(t?"Deposit updated!":"Deposit created!"),n("/deposit-list")}catch(a){var s,o;console.error(a),alert((null===(s=a.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.message)||a.message)}finally{v(!1)}},className:"space-y-4",children:[(0,c.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"Deposit Date"}),(0,c.jsx)("input",{type:"date",name:"depositDate",value:k.depositDate,onChange:O,required:!0,className:"w-full p-2 border rounded"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"Reference No"}),(0,c.jsx)("input",{type:"text",name:"referenceNo",value:k.referenceNo,onChange:O,placeholder:"Optional",className:"w-full p-2 border rounded"})]})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"Out"}),(0,c.jsx)("div",{className:"p-2 border rounded bg-gray-100",children:$})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"In"}),(0,c.jsx)(a.Ay,{options:w,value:w.find((e=>e.value===k.creditAccount))||null,onChange:e=>((e,t)=>{C((n=>({...n,[e]:t?t.value:""})))})("creditAccount",e),placeholder:"\u2014 Select credit account \u2014",required:!0})]}),(0,c.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"Amount"}),(0,c.jsx)("input",{type:"number",name:"amount",min:"0",step:"0.01",value:k.amount,onChange:O,required:!0,className:"w-full p-2 border rounded",placeholder:"0.00"})]}),(0,c.jsxs)("div",{children:[(0,c.jsx)("label",{className:"block font-semibold mb-1",children:"Note"}),(0,c.jsx)("textarea",{name:"note",rows:2,value:k.note,onChange:O,className:"w-full p-2 border rounded",placeholder:"Optional"})]})]}),(0,c.jsxs)("div",{className:"flex space-x-4",children:[(0,c.jsx)("button",{type:"submit",disabled:x,className:"px-6 py-2 rounded text-white "+(x?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:x?"Saving\u2026":t?"Update":"Save"}),(0,c.jsx)("button",{type:"button",onClick:()=>n("/deposit-list"),className:"px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"Cancel"})]})]})]})})]})]})}},82284:(e,t,n)=>{function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}n.d(t,{A:()=>s})}}]);
//# sourceMappingURL=5440.0f8462b2.chunk.js.map