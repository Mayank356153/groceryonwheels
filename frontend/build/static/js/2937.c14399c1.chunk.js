"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2937],{14840:(e,a,r)=>{r.d(a,{A:()=>i});var t=r(65043),s=r(21197),l=r(59255),n=r(70579);function i(){const[e,a]=(0,t.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(s.A,{isSidebarOpen:e,setSidebarOpen:a}),(0,n.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.A,{isSidebarOpen:e})}),(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},21830:(e,a,r)=>{r.d(a,{A:()=>l});var t=r(65043),s=r(70579);function l(e){let{id:a=" ",type:r="text",label_class:l="",label:n,className:i="",placeholder:o="",div_class:c="",...d}=e;const u=(0,t.useId)();return(0,s.jsxs)("div",{className:c,children:[" ",n?(0,s.jsx)("label",{className:l,htmlFor:" "===a?u:a,children:n}):null," ",(0,s.jsx)("input",{type:r,id:" "===a?u:a,placeholder:o,className:i,...d})]})}},42406:(e,a,r)=>{r.r(a),r.d(a,{default:()=>f});var t=r(65043),s=r(21830),l=r(53888),n=r(26873),i=r(47252),o=r(21197),c=r(60184),d=r(59255),u=r(66727),m=r(86213),x=r(14840),p=r(70579);function b(e){let{add:a,setAdd:r,category:s,options:l,setOptions:n,fetchTax:i,fetchUnits:o,fetchBrands:d,fetchVariants:u}=e;const[b,f]=(0,t.useState)({name:"",description:"",taxPercentage:"",status:"active"}),[h,g]=(0,t.useState)(!1),[v,y]=(0,t.useState)(null),N=e=>{const{name:a,value:r}=e.target;f((e=>({...e,[a]:r})))};return h?(0,p.jsx)(x.A,{}):v?(0,p.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-[1px] z-50",children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-96 p-6",children:[(0,p.jsxs)("div",{className:"text-red-500 mb-4",children:["Error: ",v]}),(0,p.jsx)("button",{className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",onClick:()=>y(null),children:"Try Again"})]})}):(0,p.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-[1px] z-50",children:(0,p.jsx)("form",{onSubmit:async e=>{e.preventDefault(),g(!0),y(null);try{const e=localStorage.getItem("token");if(!e)throw new Error("No authentication token found");let a;if("Category"===s)a=await m.A.post("api/categories",{name:b.name,description:b.description,status:b.status},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),n((e=>({...e,category:[...e.category,{label:a.data.data.name,value:a.data.data._id}]})));else if("Tax"===s)a=await m.A.post("api/taxes",{taxName:b.name,taxPercentage:Number(b.taxPercentage),status:b.status},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),await i();else if("Unit"===s)a=await m.A.post("api/units",{unitName:b.name,description:b.description,status:b.status},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),await o();else if("Brand"===s)a=await m.A.post("api/brands",{brandName:b.name,description:b.description,status:b.status},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),await d();else{if("Variant"!==s)throw new Error(`Unsupported category: ${s}`);a=await m.A.post("api/variants",{variantName:b.name,description:b.description,status:b.status},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),await u()}alert(`${s} added successfully`),r(!1)}catch(l){var a,t;const e=(null===(a=l.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||l.message;y(e),console.error(`Error adding ${s}:`,e)}finally{g(!1)}},children:(0,p.jsxs)("div",{className:"bg-white rounded-lg shadow-lg w-96",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between p-4 text-lg font-semibold text-white rounded-t-lg bg-gradient-to-r from-teal-400 to-blue-500",children:[(0,p.jsxs)("span",{children:["Add ",s]}),(0,p.jsx)("button",{type:"button",className:"text-white cursor-pointer",onClick:()=>r(!1),children:(0,p.jsx)(c.QCr,{})})]}),(0,p.jsxs)("div",{className:"p-6",children:[(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("label",{htmlFor:"name",className:"block mb-2 font-medium text-gray-700",children:["Variant"===s?"Variant Name":`${s} Name`,"*"]}),(0,p.jsx)("input",{type:"text",name:"name",value:b.name,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),"Tax"===s&&(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"taxPercentage",className:"block mb-2 font-medium text-gray-700",children:"Tax Percentage*"}),(0,p.jsx)("input",{type:"number",name:"taxPercentage",value:b.taxPercentage,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,min:"0",step:"0.01"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"description",className:"block mb-2 font-medium text-gray-700",children:"Description"}),(0,p.jsx)("textarea",{name:"description",value:b.description,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("label",{htmlFor:"status",className:"block mb-2 font-medium text-gray-700",children:"Status"}),(0,p.jsxs)("select",{name:"status",value:b.status,onChange:N,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,p.jsx)("option",{value:"active",children:"Active"}),(0,p.jsx)("option",{value:"inactive",children:"Inactive"})]})]}),(0,p.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,p.jsx)("button",{type:"button",className:"px-4 py-2 text-white bg-orange-500 rounded hover:bg-orange-600",onClick:()=>r(!1),children:"Close"}),(0,p.jsx)("button",{type:"submit",className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",disabled:h,children:"Save"})]})]})]})})})}function f(){const[e,a]=(0,t.useState)([]),[r]=(0,u.ok)(),f=r.get("id"),h=(0,u.Zp)(),[g,v]=(0,t.useState)(!0),[y,N]=(0,t.useState)(null),[j,w]=(0,t.useState)(!0),[P,C]=(0,t.useState)(!1),[S,A]=(0,t.useState)(""),[_,$]=(0,t.useState)(""),[k,T]=(0,t.useState)([]),[I,M]=(0,t.useState)({alertQuantity:0,barcodes:[],brand:null,category:null,subSubCategory:null,description:"",discount:0,discountType:"Percentage",discountPolicy:"None",requiredQuantity:0,freeQuantity:0,expiryDate:"",itemCode:"",itemGroup:null,itemName:"",openingStock:0,subCategory:null,tax:null,taxType:null,unit:null,warehouse:null,variants:[],sku:"",hsn:"",priceWithoutTax:0,purchasePrice:0,salesPrice:0,mrp:0,profitMargin:0,sellerPoints:0,isOnline:!0}),[D,B]=(0,t.useState)({brand:[],category:[],subCategory:[],subsubCategory:[],itemGroup:[{label:"Single",value:"Single"},{label:"Variants",value:"Variant"}],unit:[],discounttype:[{label:"Percentage(%)",value:"Percentage"},{label:"Fixed",value:"Fixed"}],discountPolicy:[{label:"None",value:"None"},{label:"Buy X Get Y",value:"BuyXGetY"}],tax:[],taxType:[{label:"Inclusive",value:"inclusive"},{label:"Exclusive",value:"exclusive"}],warehouse:[],variants:[]}),Q=e=>{const a=/(\D+)(\d+)/.exec(e||"");if(!a)return"ITEM000001";return a[1]+String(parseInt(a[2],10)+1).padStart(a[2].length,"0")},O=e=>{const{name:a,value:r,type:t}=e.target,s="number"===t?Number(r):r;"salesPrice"===a&&s>I.purchasePrice?alert(`\u2757 Sales Price (${s}) cannot exceed Purchase Price (${I.purchasePrice})`):["priceWithoutTax","purchasePrice","salesPrice"].includes(a)&&s>I.mrp?alert(`\u2757 ${a} (${s}) cannot exceed the MRP (${I.mrp})`):M((e=>({...e,[a]:s})))},E=e=>a=>M((r=>({...r,[e]:a?a.value:null}))),G=e=>{const{name:a,value:r}=e.target,t=Number(r),s=I.mrp,l=I.purchasePrice;if("priceWithoutTax"===a&&t>s)alert(`\u2757 Price (${t}) cannot exceed the MRP (${s})`);else if("purchasePrice"===a&&t>s)alert(`\u2757 Purchase Price (${t}) cannot exceed the MRP (${s})`);else if("salesPrice"===a&&t>s)alert(`\u2757 Sales Price (${t}) cannot exceed the MRP (${s})`);else if("priceWithoutTax"===a){const e=Math.round(t+t*I.profitMargin/100);if(e>t)return void alert(`\u2757 Calculated Sales Price (${e}) cannot exceed Purchase Price (${t})`);if(e>s)return void alert(`\u2757 Calculated Sales Price (${e}) exceeds the MRP (${s}). Lower your cost or margin.`);M((a=>({...a,priceWithoutTax:t,purchasePrice:t,salesPrice:e})))}else if("profitMargin"===a){const e=I.priceWithoutTax,a=Math.round(e+e*t/100);if(a>l)return void alert(`\u2757 Calculated Sales Price (${a}) cannot exceed Purchase Price (${l})`);if(a>s)return void alert(`\u2757 Calculated Sales Price (${a}) exceeds the MRP (${s}). Lower your margin.`);M((e=>({...e,profitMargin:t,salesPrice:a})))}else if("salesPrice"===a){if(t>l)return void alert(`\u2757 Sales Price (${t}) cannot exceed Purchase Price (${l})`);M((e=>({...e,salesPrice:t,profitMargin:l?Math.round((t-l)/l*100):0})))}},F=e=>{T((a=>e(a))),M((a=>({...a,variants:e(a.variants)})))},q=(e,a)=>{const{name:r,value:t,type:s}=e.target,l=Array.isArray(t)?t:"number"===s?Number(t):t;F((e=>e.map((e=>String(e.variantId)===String(a)?{...e,[r]:l}:e))))},V=(e,a)=>{const{name:r,value:t}=e.target,s=Number(t);F((e=>e.map((e=>{if(String(e.variantId)!==String(a))return e;const t={...e};if("price"===r&&s>e.mrp)return alert(`\u2757 Price (${s}) cannot exceed MRP (${e.mrp})`),e;if("purchasePrice"===r&&s>e.mrp)return alert(`\u2757 Purchase Price (${s}) cannot exceed MRP (${e.mrp})`),e;if("salesPrice"===r&&s>e.mrp)return alert(`\u2757 Sales Price (${s}) cannot exceed MRP (${e.mrp})`),e;if("price"===r){t.price=s,t.purchasePrice=s;const a=Math.round(s+s*e.profitMargin/100);if(a>s)return alert(`\u2757 Calculated Sales Price (${a}) cannot exceed Purchase Price (${s})`),e;if(a>e.mrp)return alert(`\u2757 Calculated Sales Price (${a}) cannot exceed MRP (${e.mrp})`),e;t.salesPrice=a}else if("profitMargin"===r){t.profitMargin=s;const a=Math.round(e.price+e.price*s/100);if(a>e.purchasePrice)return alert(`\u2757 Calculated Sales Price (${a}) cannot exceed Purchase Price (${e.purchasePrice})`),e;if(a>e.mrp)return alert(`\u2757 Calculated Sales Price (${a}) cannot exceed MRP (${e.mrp})`),e;t.salesPrice=a}else if("salesPrice"===r){if(s>e.purchasePrice)return alert(`\u2757 Sales Price (${s}) cannot exceed Purchase Price (${e.purchasePrice})`),e;t.salesPrice=s,t.profitMargin=e.price?Math.round((s-e.price)/e.price*100):0}else"purchasePrice"===r&&(t.purchasePrice=s,t.salesPrice>s&&(alert(`\u2757 Sales Price (${t.salesPrice}) cannot exceed new Purchase Price (${s})`),t.salesPrice=s,t.profitMargin=e.price?Math.round((s-e.price)/e.price*100):0));return t}))))};(0,t.useEffect)((()=>{_&&(()=>{if(!_)return;const e=D.variants.find((e=>e.variantName.toLowerCase()===_.toLowerCase()));if(!e)return;const a={variantId:e._id,variantName:e.variantName,sku:"",hsn:"",barcodes:[],price:0,purchasePrice:0,salesPrice:0,mrp:0,profitMargin:0,openingStock:0,discountPolicy:"None",requiredQuantity:0,freeQuantity:0};T((e=>[...e,a])),M((e=>({...e,variants:[...e.variants,a]}))),$("")})()}),[_]);const R=()=>({headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),z=async(e,a,r)=>{const{data:t}=await m.A.get(e,R());B((e=>({...e,[a]:r(t.data)})))},U=async()=>{try{if(await Promise.all([z("api/brands","brand",(e=>e.map((e=>({label:e.brandName,value:e._id}))))),z("api/categories","category",(e=>e.map((e=>({label:e.name,value:e._id}))))),z("api/subcategories","subCategory",(e=>e.map((e=>({label:e.name,value:e._id}))))),z("api/sub-subcategories","subsubCategory",(e=>e.map((e=>({label:e.name,value:e._id}))))),z("api/units","unit",(e=>e.map((e=>({label:e.unitName,value:e._id}))))),z("api/taxes","tax",(e=>e.map((e=>({label:e.taxName,value:e._id}))))),z("api/warehouses","warehouse",(e=>e.filter((e=>"Active"===e.status)).map((e=>({label:e.warehouseName,value:e._id}))))),m.A.get("api/variants",R()).then((e=>{let{data:a}=e;return B((e=>({...e,variants:a.data})))}))]),f){const{data:e}=await m.A.get(`api/items/${f}`,R()),a=e.data;M({...a,barcodes:a.barcodes||[],variants:a.variants||[],taxType:a.taxType||null,isOnline:a.isOnline}),T(a.variants||[])}else await(async()=>{try{const{data:e}=await m.A.get("api/items",R()),a=[...e.data].reverse().find((e=>/^ITEM\d+$/.test(e.itemCode))),r=a?a.itemCode:"ITEM000000";M((e=>({...e,itemCode:Q(r)})))}catch(e){console.error("Unable to fetch last item-code:",e.message),M((e=>({...e,itemCode:"ITEM000001"})))}})();window.innerWidth<768&&w(!1),v(!1)}catch(e){N(e.message)}},W=e=>({variantId:e.variantId,sku:e.sku,hsn:e.hsn,barcodes:e.barcodes||[],priceWithoutTax:Number(e.price)||0,purchasePrice:Number(e.purchasePrice)||0,salesPrice:Number(e.salesPrice)||0,mrp:Number(e.mrp)||0,profitMargin:Number(e.profitMargin)||0,openingStock:Number(e.openingStock)||0,discountPolicy:e.discountPolicy,requiredQuantity:Number(e.requiredQuantity)||0,freeQuantity:Number(e.freeQuantity)||0});return(0,t.useEffect)((()=>{U()}),[]),g?(0,p.jsx)(x.A,{}):y?(0,p.jsxs)("div",{className:"p-4 text-red-500",children:["Error: ",y]}):(0,p.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,p.jsx)(o.A,{isSidebarOpen:j,setSidebarOpen:w}),(0,p.jsxs)("div",{className:"flex flex-grow",children:[(0,p.jsx)(d.A,{isSidebarOpen:j}),(0,p.jsxs)("div",{className:"w-full h-full px-6 py-4 bg-gray-300 overflow-y-auto",children:[(0,p.jsxs)("div",{className:"flex flex-col justify-between mt-4 md:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-wrap items-end",children:[(0,p.jsx)("span",{className:"text-3xl",children:"Items"}),(0,p.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Add / Update"})]}),(0,p.jsxs)("div",{className:"flex flex-wrap gap-2 px-2 py-2 text-sm font-semibold bg-gray-500 bg-opacity-50 rounded-md md:bg-transparent",children:[(0,p.jsxs)(u.k2,{to:"/dashboard",className:"flex items-center text-gray-700",children:[(0,p.jsx)(c.$BV,{className:"mr-1"}),"Home"]}),(0,p.jsx)(u.k2,{to:"/item-list",className:"text-gray-700",children:"> Items List"}),(0,p.jsx)(u.k2,{to:"/items/add",className:"text-gray-700",children:"> Items"})]})]}),P&&(0,p.jsx)(b,{add:P,setAdd:C,options:D,setOptions:B,category:S,fetchTax:()=>z("api/taxes","tax",(e=>e.map((e=>({label:e.taxName,value:e._id}))))),fetchUnits:()=>z("api/units","unit",(e=>e.map((e=>({label:e.unitName,value:e._id}))))),fetchBrands:()=>z("api/brands","brand",(e=>e.map((e=>({label:e.brandName,value:e._id}))))),fetchVariants:()=>m.A.get("api/variants",R()).then((e=>{let{data:a}=e;return B((e=>({...e,variants:a.data})))}))}),(0,p.jsx)("form",{onSubmit:async a=>{if(a.preventDefault(),"BuyXGetY"===I.discountPolicy&&(I.requiredQuantity<1||I.freeQuantity<1))return alert("Required and Free Quantity must be \u2265 1");try{v(!0),await(async()=>{const a={...I};"Variant"===a.itemGroup&&(a.variants=a.variants.map(W));const r=new FormData;Object.entries(a).forEach((e=>{let[a,t]=e;null!==t&&void 0!==t&&("variants"===a?r.append("variants",JSON.stringify(t)):Array.isArray(t)?t.forEach(((e,t)=>{r.append(`${a}[${t}]`,e)})):"object"===typeof t?r.append(a,JSON.stringify(t)):r.append(a,t))})),e.forEach((e=>{r.append("itemImages",e)}));const t=f?`api/items/${f}`:"api/items",s=f?"put":"post";await m.A[s](t,r,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"multipart/form-data"}})})(),alert(f?"Item Updated":"Item Added"),h("/item-list")}catch(s){var r,t;alert((null===(r=s.response)||void 0===r||null===(t=r.data)||void 0===t?void 0:t.message)||s.message)}finally{v(!1)}},children:(0,p.jsxs)("div",{className:"flex flex-col gap-5 p-4 bg-white border-t-2 rounded-lg border-t-blue-600",children:[(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"Item Code*",value:I.itemCode,readOnly:!0,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm bg-gray-200 border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"Item Name*",name:"itemName",value:I.itemName,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"mb-1 text-sm font-semibold",children:"Brand"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(n.Ay,{options:D.brand,onChange:E("brand"),value:D.brand.find((e=>{var a;return e.value===((null===(a=I.brand)||void 0===a?void 0:a._id)||I.brand)}))||null,className:"w-full"}),(0,p.jsx)("span",{onClick:()=>{C(!0),A("Brand")},className:"px-2 text-lg font-bold text-blue-500 border-2 border-gray-300 rounded-sm cursor-pointer hover:bg-gray-100",children:"+"})]})]}),(0,p.jsxs)("div",{className:"flex flex-col w-full lg:w-1/4",children:[(0,p.jsx)("label",{className:"mb-1 text-sm font-semibold",children:"Category"}),(0,p.jsx)(n.Ay,{options:D.category,onChange:E("category"),value:D.category.find((e=>{var a;return e.value===((null===(a=I.category)||void 0===a?void 0:a._id)||I.category)}))||null})]}),(0,p.jsxs)("div",{className:"flex flex-col w-full lg:w-1/4",children:[(0,p.jsx)("label",{className:"mb-1 text-sm font-semibold",children:"SubCategory"}),(0,p.jsx)(n.Ay,{options:D.subCategory,onChange:E("subCategory"),value:D.subCategory.find((e=>{var a;return e.value===((null===(a=I.subCategory)||void 0===a?void 0:a._id)||I.subCategory)}))||null})]})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"mb-1 text-sm font-semibold",children:"Sub SubCategory"}),(0,p.jsx)(n.Ay,{options:D.subsubCategory,onChange:E("subSubCategory"),value:D.subsubCategory.find((e=>{var a;return e.value===((null===(a=I.subSubCategory)||void 0===a?void 0:a._id)||I.subSubCategory)}))||null})]}),(0,p.jsxs)("div",{className:"flex flex-col w-full lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Item Group*"}),(0,p.jsx)(n.Ay,{options:D.itemGroup,onChange:E("itemGroup"),value:D.itemGroup.find((e=>e.value===I.itemGroup))||null})]}),(0,p.jsxs)("div",{className:"flex flex-col w-full lg:w-1/4",children:[(0,p.jsx)("label",{className:"mb-1 text-sm font-semibold",children:"Unit"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(n.Ay,{options:D.unit,onChange:E("unit"),value:D.unit.find((e=>{var a;return e.value===((null===(a=I.unit)||void 0===a?void 0:a._id)||I.unit)}))||null,className:"w-full"}),(0,p.jsx)("span",{onClick:()=>{C(!0),A("Unit")},className:"px-2 text-lg font-bold text-blue-500 border-2 border-gray-300 rounded-sm cursor-pointer hover:bg-gray-100",children:"+"})]})]})]}),"Variant"!==I.itemGroup&&(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"SKU",name:"sku",value:I.sku,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"HSN",name:"hsn",value:I.hsn,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"Alert Quantity",name:"alertQuantity",type:"number",min:"0",value:I.alertQuantity,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"Seller Points",name:"sellerPoints",type:"number",min:"0",value:I.sellerPoints,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),"Variant"!==I.itemGroup&&(0,p.jsx)(i.A,{formData:I,setFormData:M,fieldName:"barcodes"}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Description"}),(0,p.jsx)("textarea",{name:"description",value:I.description,onChange:O,className:"px-2 py-2 border-2 border-gray-300 rounded-md focus:border-blue-600"})]})]}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Visibility"}),(0,p.jsxs)("select",{value:I.isOnline?"online":"offline",onChange:e=>M((a=>({...a,isOnline:"online"===e.target.value}))),className:"px-4 py-2 mt-1 border-2 border-gray-300 rounded-md",children:[(0,p.jsx)("option",{value:"online",children:"Show in customer app"}),(0,p.jsx)("option",{value:"offline",children:"Hide from customer app"})]})]}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold mb-1",children:"Images"}),(0,p.jsx)("input",{type:"file",name:"itemImages",multiple:!0,accept:"image/*",onChange:r=>{const t=Array.from(r.target.files);if(e.length+t.length>5)alert("You can only upload up to 5 images.");else{for(const e of t)if(e.size>1048576)return void alert(`File ${e.name} exceeds the 1 MB size limit.`);a((e=>[...e,...t]))}},className:"px-4 py-2 border-2 border-gray-300 rounded-md bg-white"}),(0,p.jsx)("span",{className:"text-xs text-gray-600 mt-1",children:"You can pick up to 5 images (max 1 MB each)"}),e.length>0&&(0,p.jsxs)("div",{className:"mt-2",children:[(0,p.jsx)("p",{className:"text-sm font-semibold",children:"Selected Files:"}),(0,p.jsx)("ul",{className:"list-disc pl-5",children:e.map(((e,r)=>(0,p.jsxs)("li",{className:"text-sm flex items-center",children:[e.name," (",(e.size/1024).toFixed(2)," KB)",(0,p.jsx)("button",{type:"button",onClick:()=>a((e=>e.filter(((e,a)=>a!==r)))),className:"ml-2 text-red-500 hover:text-red-700",children:(0,p.jsx)(c.qbC,{})})]},r)))})]})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 py-5 border-t-2 border-b-2 border-gray-200 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Discount Type"}),(0,p.jsx)(n.Ay,{options:D.discounttype,onChange:E("discountType"),value:D.discounttype.find((e=>e.value===I.discountType))||null})]}),(0,p.jsx)(s.A,{label:"Discount",name:"discount",type:"number",min:"0",value:I.discount,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Discount Policy"}),(0,p.jsx)(n.Ay,{options:D.discountPolicy,onChange:E("discountPolicy"),value:D.discountPolicy.find((e=>e.value===I.discountPolicy))||null})]})]}),"BuyXGetY"===I.discountPolicy&&(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"Required Quantity*",name:"requiredQuantity",type:"number",min:"1",value:I.requiredQuantity,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"Free Quantity*",name:"freeQuantity",type:"number",min:"1",value:I.freeQuantity,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),"Variant"!==I.itemGroup&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"flex flex-col gap-2 pt-5 border-t-2 border-gray-200 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"Price*",name:"priceWithoutTax",type:"number",min:"0",value:I.priceWithoutTax,onChange:e=>{G(e),O(e)},label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Tax*"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(n.Ay,{options:D.tax,onChange:E("tax"),value:D.tax.find((e=>{var a;return e.value===((null===(a=I.tax)||void 0===a?void 0:a._id)||I.tax)}))||null,className:"w-full"}),(0,p.jsx)("span",{onClick:()=>{C(!0),A("Tax")},className:"px-2 text-lg font-bold text-blue-500 border-2 border-gray-300 rounded-sm cursor-pointer hover:bg-gray-100",children:"+"})]})]}),(0,p.jsx)(s.A,{label:"Purchase Price*",name:"purchasePrice",type:"number",min:"0",value:I.purchasePrice,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Tax Type*"}),(0,p.jsx)(n.Ay,{options:D.taxType,onChange:E("taxType"),value:D.taxType.find((e=>e.value===I.taxType))||null})]}),(0,p.jsx)(s.A,{label:"Profit Margin(%)",name:"profitMargin",type:"number",min:"0",value:I.profitMargin,onChange:e=>{G(e),O(e)},label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"Sales Price*",name:"salesPrice",type:"number",min:"0",value:I.salesPrice,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsx)(s.A,{label:"MRP",name:"mrp",type:"number",min:"0",value:I.mrp,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"}),(0,p.jsx)(s.A,{label:"Expiry Date",name:"expiryDate",type:"date",value:I.expiryDate?new Date(I.expiryDate).toISOString().split("T")[0]:"",onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 py-5 border-t-2 border-b-2 border-gray-200 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Warehouse"}),(0,p.jsx)(n.Ay,{options:D.warehouse,onChange:E("warehouse"),value:D.warehouse.find((e=>{var a;return e.value===((null===(a=I.warehouse)||void 0===a?void 0:a._id)||I.warehouse)}))||null})]}),"Variant"!==I.itemGroup&&(0,p.jsx)(s.A,{label:"Opening Stock",name:"openingStock",type:"number",min:"0",value:I.openingStock,onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),"Variant"===I.itemGroup&&(0,p.jsxs)("div",{className:"flex flex-col gap-2 lg:flex-row",children:[(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Tax*"}),(0,p.jsxs)("div",{className:"flex",children:[(0,p.jsx)(n.Ay,{options:D.tax,onChange:E("tax"),value:D.tax.find((e=>{var a;return e.value===((null===(a=I.tax)||void 0===a?void 0:a._id)||I.tax)}))||null,className:"w-full"}),(0,p.jsx)("span",{onClick:()=>{C(!0),A("Tax")},className:"px-2 text-lg font-bold text-blue-500 border-2 border-gray-300 rounded-sm cursor-pointer hover:bg-gray-100",children:"+"})]})]}),(0,p.jsxs)("div",{className:"flex flex-col lg:w-1/4",children:[(0,p.jsx)("label",{className:"text-sm font-semibold",children:"Tax Type*"}),(0,p.jsx)(n.Ay,{options:D.taxType,onChange:E("taxType"),value:D.taxType.find((e=>e.value===I.taxType))||null})]}),(0,p.jsx)(s.A,{label:"Expiry Date",name:"expiryDate",type:"date",value:I.expiryDate?new Date(I.expiryDate).toISOString().split("T")[0]:"",onChange:O,label_class:"text-sm font-semibold",div_class:"flex flex-col lg:w-1/4",className:"px-4 py-2 mt-1 text-sm border-2 border-gray-300 rounded-md"})]}),"Variant"===I.itemGroup&&(0,p.jsxs)("div",{className:"relative w-full p-4",children:[(0,p.jsxs)("div",{className:"flex items-center w-full px-2 mb-4 border border-t-2 rounded-md border-t-cyan-500",children:[(0,p.jsx)(c.KSO,{className:"mr-2 text-gray-500"}),(0,p.jsx)("input",{type:"text",placeholder:"Search Variant",value:_,onChange:e=>$(e.target.value),className:"w-full p-2 focus:outline-none"}),(0,p.jsx)("span",{onClick:()=>{C(!0),A("Variant")},className:"px-2 text-lg font-bold text-blue-500 border-2 border-gray-300 rounded-sm cursor-pointer hover:bg-gray-100",children:"+"}),_&&(0,p.jsx)("div",{className:"absolute z-50 w-full overflow-y-auto bg-white border rounded-lg shadow-lg sm:w-96 max-h-60 top-12",children:(0,p.jsx)("ul",{children:D.variants.filter((e=>e.variantName.toLowerCase().includes(_.toLowerCase()))).map((e=>(0,p.jsx)("li",{className:"p-2 cursor-pointer hover:bg-gray-100",onClick:()=>$(e.variantName),children:e.variantName},e._id)))})})]}),(0,p.jsx)("div",{className:"overflow-x-auto",children:(0,p.jsxs)("table",{className:"min-w-full border border-collapse",children:[(0,p.jsx)("thead",{children:(0,p.jsxs)("tr",{className:"text-sm bg-gray-300",children:[(0,p.jsx)("th",{className:"p-2 border",children:"Variant"}),(0,p.jsx)("th",{className:"p-2 border",children:"SKU"}),(0,p.jsx)("th",{className:"p-2 border",children:"HSN"}),(0,p.jsx)("th",{className:"p-2 border",children:"Barcodes"}),(0,p.jsx)("th",{className:"p-2 border",children:"Price"}),(0,p.jsx)("th",{className:"p-2 border",children:"Purchase"}),(0,p.jsx)("th",{className:"p-2 border",children:"Profit %"}),(0,p.jsx)("th",{className:"p-2 border",children:"Sales"}),(0,p.jsx)("th",{className:"p-2 border",children:"MRP"}),(0,p.jsx)("th",{className:"p-2 border",children:"Opening"}),(0,p.jsx)("th",{className:"p-2 border",children:"Policy"}),(0,p.jsx)("th",{className:"p-2 border",children:"Req"}),(0,p.jsx)("th",{className:"p-2 border",children:"Free"}),(0,p.jsx)("th",{className:"p-2 border",children:"Action"})]})}),(0,p.jsx)("tbody",{children:k.map(((e,a)=>{var r;return(0,p.jsxs)("tr",{className:"text-sm text-center",children:[(0,p.jsx)("td",{className:"p-2 border",children:e.variantName||(null===(r=e.variantId)||void 0===r?void 0:r.variantName)}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"sku",value:e.sku,onChange:a=>q(a,e.variantId),className:"w-full px-1 py-1 text-center border",placeholder:"Optional"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"hsn",value:e.hsn,onChange:a=>q(a,e.variantId),className:"w-full px-1 py-1 text-center border",placeholder:"Optional"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)(i.A,{formData:{barcodes:e.barcodes||[]},fieldName:"barcodes",setFormData:a=>{const r="function"===typeof a?a({barcodes:e.barcodes}).barcodes:a.barcodes;F((a=>a.map((a=>String(a.variantId)===String(e.variantId)?{...a,barcodes:r}:a))))}})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{required:!0,name:"price",type:"number",min:"0",value:e.price,onChange:a=>{q(a,e.variantId),V(a,e.variantId)},className:"w-full px-1 py-1 text-center border-2 border-orange-300"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{required:!0,name:"purchasePrice",type:"number",min:"0",value:e.purchasePrice,onChange:a=>{q(a,e.variantId),V(a,e.variantId)},className:"w-full px-1 py-1 text-center border-2 border-orange-300"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{required:!0,name:"profitMargin",type:"number",min:"0",value:e.profitMargin,onChange:a=>{q(a,e.variantId),V(a,e.variantId)},className:"w-full px-1 py-1 text-center border-2 border-orange-300"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{required:!0,name:"salesPrice",type:"number",min:"0",value:e.salesPrice,onChange:a=>{q(a,e.variantId),V(a,e.variantId)},className:"w-full px-1 py-1 text-center border-2 border-orange-300"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"mrp",type:"number",min:"0",value:e.mrp,onChange:a=>q(a,e.variantId),className:"w-full px-1 py-1 text-center border"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"openingStock",type:"number",min:"0",value:e.openingStock,onChange:a=>q(a,e.variantId),className:"w-full px-1 py-1 text-center border"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsxs)("select",{name:"discountPolicy",value:e.discountPolicy,onChange:a=>q(a,e.variantId),className:"w-full px-1 py-1 text-center border",children:[(0,p.jsx)("option",{value:"None",children:"None"}),(0,p.jsx)("option",{value:"BuyXGetY",children:"Buy X Get Y"})]})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"requiredQuantity",type:"number",min:"0",value:e.requiredQuantity,onChange:a=>q(a,e.variantId),disabled:"BuyXGetY"!==e.discountPolicy,className:"w-full px-1 py-1 text-center border"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("input",{name:"freeQuantity",type:"number",min:"0",value:e.freeQuantity,onChange:a=>q(a,e.variantId),disabled:"BuyXGetY"!==e.discountPolicy,className:"w-full px-1 py-1 text-center border"})}),(0,p.jsx)("td",{className:"p-2 border",children:(0,p.jsx)("button",{type:"button",onClick:()=>(e=>{F((a=>a.filter((a=>String(a.variantId)!==String(e)))))})(e.variantId),className:"px-2 py-1 text-white bg-red-600 rounded hover:bg-red-700",children:(0,p.jsx)(c.qbC,{})})})]},a)}))})]})})]}),(0,p.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[(0,p.jsx)(l.A,{type:"submit",className:"w-full text-white bg-green-600 rounded hover:bg-green-700",text:f?"Update":"Save"}),(0,p.jsx)(l.A,{text:"Close",className:"w-full text-white bg-orange-500 rounded hover:bg-orange-600",onClick:()=>h("/item-list")})]})]})})]})]})]})}},47252:(e,a,r)=>{r.d(a,{A:()=>m});var t=r(65043),s=r(21830),l=r(31782),n=r(83910),i=r(97929),o=r(70579);const c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").trim();return a&&!e.includes(a)?[...e,a]:e},d=function(){let e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(((a,r)=>r!==e))},u=e=>{let{formData:a={},setFormData:r,fieldName:u="barcodes"}=e;const[m,x]=(0,t.useState)(!1),[p,b]=(0,t.useState)(""),f=(0,t.useRef)(null),h=(0,t.useRef)(null),g=a[u]||[],v=e=>r((a=>({...a,[u]:c(a[u],e)})));return(0,t.useEffect)((()=>{if(!m)return;const e=()=>{var e,a,r,t;null===(e=f.current)||void 0===e||null===(a=e.srcObject)||void 0===a||a.getTracks().forEach((e=>e.stop())),null===(r=h.current)||void 0===r||null===(t=r.reset)||void 0===t||t.call(r),x(!1)};return(async()=>{const a=new l.sx;h.current=a;const r=r=>a.decodeFromConstraints({video:{facingMode:r}},f.current,((a,r)=>{if(a){var t,s;v(a.getText()),null===(t=window.navigator)||void 0===t||null===(s=t.vibrate)||void 0===s||s.call(t,160);try{new Audio("/beep.mp3").play()}catch{}e()}r&&"NotFoundException"!==r.name&&console.error("Scan error:",r)}));try{await r({exact:"environment"})}catch{try{await r("user")}catch(t){console.error("Camera error:",t),e()}}})(),()=>e()}),[m]),(0,o.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,o.jsxs)("div",{className:"flex items-start w-full",children:[(0,o.jsx)(s.A,{label:"Barcodes",placeholder:"Type or scan \u2013 comma or Enter to save",value:p,onChange:e=>{let a=e.target.value;a.endsWith(",")&&(v(a.slice(0,-1)),a=""),b(a)},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),v(p),b(""))},onBlur:()=>{v(p),b("")},div_class:"flex flex-col w-full",className:"w-full px-4 py-2 mt-1 text-sm text-gray-800 bg-white\r border-2 border-gray-300 rounded-l-md focus:border-blue-600",label_class:"text-sm font-semibold"}),(0,o.jsx)(n.g,{icon:i.m8z,title:"Scan barcode",onClick:()=>x(!0),className:"px-3 mt-4 py-[10px] text-gray-800 bg-gray-100 border-2\r border-l-0 border-gray-300 rounded-r-md cursor-pointer"})]}),g.length>0&&(0,o.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:g.map(((e,a)=>(0,o.jsxs)("span",{className:"flex items-center px-2 py-1 text-xs bg-gray-200 rounded-full",children:[e,(0,o.jsx)("button",{type:"button",className:"ml-1 text-red-600 hover:text-red-800 focus:outline-none",onClick:()=>(e=>r((a=>({...a,[u]:d(a[u],e)}))))(a),children:"\xd7"})]},a)))}),m&&(0,o.jsxs)("div",{className:"absolute inset-0 z-50 flex flex-col items-center\r justify-center bg-black bg-opacity-50",children:[(0,o.jsxs)("div",{className:"relative overflow-hidden border-4 border-white\r rounded-lg shadow-xl w-72 h-72",children:[(0,o.jsx)("video",{ref:f,className:"absolute object-cover w-full h-full",autoPlay:!0,muted:!0,playsInline:!0}),(0,o.jsx)("div",{className:"absolute w-full h-1 bg-red-500 animate-scan"})]}),(0,o.jsx)("button",{onClick:()=>x(!1),className:"px-4 py-2 mt-6 text-white bg-red-600 rounded hover:bg-red-700",children:"Cancel"})]})]})};u.defaultProps={formData:{barcodes:[]},setFormData:()=>{},fieldName:"barcodes"};const m=u},53888:(e,a,r)=>{r.d(a,{A:()=>s});r(65043);var t=r(70579);function s(e){let{text:a,type:r="button",className:s,...l}=e;return(0,t.jsx)("button",{className:`${s}`,...l,children:a})}},82284:(e,a,r)=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}r.d(a,{A:()=>t})}}]);
//# sourceMappingURL=2937.c14399c1.chunk.js.map