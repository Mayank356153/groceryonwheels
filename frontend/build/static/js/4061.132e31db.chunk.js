"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4061],{14840:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(65043),a=n(21197),s=n(59255),o=n(70579);function d(){const[e,t]=(0,r.useState)(!1);return(0,o.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,o.jsx)(a.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,o.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,o.jsx)("div",{children:(0,o.jsx)(s.A,{isSidebarOpen:e})}),(0,o.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,o.jsxs)("div",{className:"flex flex-col items-center",children:[(0,o.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,o.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},53698:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var r=n(65043),a=n(26873),s=n(66727),o=n(21197),d=n(59255),c=n(14840),l=n(86213),i=n(70579);function u(){const[e,t]=(0,r.useState)(window.innerWidth>=768),n=(0,s.Zp)(),[u]=(0,s.ok)(),m=u.get("id"),[f,h]=(0,r.useState)(!1),[p,x]=(0,r.useState)([]),[b,g]=(0,r.useState)([]),[v,j]=(0,r.useState)(null),[N,y]=(0,r.useState)({transferDate:(new Date).toLocaleDateString("en-CA"),transferCode:"",debitAccount:"",creditAccount:"",amount:"",referenceNo:"",note:""}),A=localStorage.getItem("token"),w={Authorization:`Bearer ${A}`};(0,r.useEffect)((()=>{const e=()=>t(window.innerWidth>=768);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{l.A.get("api/accounts",{headers:w}).then((e=>x(e.data.data||[]))).catch(console.error)}),[]),(0,r.useEffect)((()=>{const e=localStorage.getItem("storeId");e&&l.A.get("admin/store/add/store",{headers:w}).then((t=>{var n;const r=(t.data.result||[]).find((t=>t._id===e));if(!r)return;const a="string"===typeof r.storeAccount?r.storeAccount:null===(n=r.storeAccount)||void 0===n?void 0:n._id;j(a),y((e=>({...e,creditAccount:a})))})).catch(console.error)}),[]),(0,r.useEffect)((()=>{if(!v||0===p.length)return;const e=p.filter((e=>{var t;return("string"===typeof e.parentAccount?e.parentAccount:null===(t=e.parentAccount)||void 0===t?void 0:t._id)===v}));g(e.map((e=>({label:`${e.accountNumber} \u2013 ${e.accountName}`,value:e._id}))))}),[v,p]),(0,r.useEffect)((()=>{m&&(h(!0),l.A.get("api/money-transfers",{headers:w}).then((e=>{const t=e.data.data.find((e=>e._id===m));t&&y({transferDate:new Date(t.transferDate).toISOString().split("T")[0],transferCode:t.transferCode,debitAccount:t.debitAccount._id,creditAccount:t.creditAccount._id,amount:t.amount,referenceNo:t.referenceNo||"",note:t.note||""})})).catch(console.error).finally((()=>h(!1))))}),[m]);const S=p.find((e=>e._id===N.creditAccount)),C=S?`${S.accountNumber} \u2013 ${S.accountName}`:"Loading\u2026",k=e=>{const{name:t,value:n}=e.target;y((e=>({...e,[t]:n})))};return f?(0,i.jsx)(c.A,{}):(0,i.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,i.jsx)(o.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,i.jsxs)("div",{className:"flex flex-grow",children:[(0,i.jsx)(d.A,{isSidebarOpen:e}),(0,i.jsx)("div",{className:"flex-1 p-4 bg-gray-100 overflow-auto",children:(0,i.jsxs)("div",{className:"bg-white p-6 rounded shadow",children:[(0,i.jsxs)("h1",{className:"text-2xl font-semibold mb-4",children:[m?"Edit":"New"," Money Transfer"]}),(0,i.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),h(!0);try{if(!A)throw new Error("Not logged in");const e=m?`api/money-transfers/${m}`:"api/money-transfers",t=m?"put":"post";await l.A[t](e,N,{headers:{...w,"Content-Type":"application/json"}}),alert(m?"Updated!":"Created!"),n("/money-transfer-list")}catch(a){var t,r;alert((null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message)}finally{h(!1)}},className:"space-y-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Transfer Date"}),(0,i.jsx)("input",{type:"date",name:"transferDate",value:N.transferDate,onChange:k,className:"w-full border p-2 rounded",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Transfer Code"}),(0,i.jsx)("input",{type:"text",name:"transferCode",value:N.transferCode,onChange:k,className:"w-full border p-2 rounded",placeholder:"e.g. MT1001",required:!0})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Debit Account"}),(0,i.jsx)(a.Ay,{options:b,value:b.find((e=>e.value===N.debitAccount))||null,onChange:e=>((e,t)=>{y((n=>({...n,[e]:t?t.value:""})))})("debitAccount",e),placeholder:"\u2014 choose debit account \u2014",isClearable:!1,required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Credit Account"}),(0,i.jsx)("div",{className:"p-2 border rounded bg-gray-100",children:C})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Amount"}),(0,i.jsx)("input",{type:"number",name:"amount",min:"0",value:N.amount,onChange:k,className:"w-full border p-2 rounded",placeholder:"0.00",required:!0})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Reference No"}),(0,i.jsx)("input",{type:"text",name:"referenceNo",value:N.referenceNo,onChange:k,className:"w-full border p-2 rounded",placeholder:"Optional"})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block font-medium",children:"Note"}),(0,i.jsx)("textarea",{name:"note",rows:2,value:N.note,onChange:k,className:"w-full border p-2 rounded",placeholder:"Optional"})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:m?"Update":"Save"}),(0,i.jsx)("button",{type:"button",onClick:()=>n("/dashboard"),className:"px-6 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"Close"})]})]})]})})]})]})}},82284:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})}}]);
//# sourceMappingURL=4061.132e31db.chunk.js.map