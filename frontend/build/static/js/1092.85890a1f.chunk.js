"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[1092],{91092:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=a(65043),r=a(86213),l=a(21197),i=a(66727),n=a(60184),o=(a(79038),a(59255)),c=a(70579);const d=e=>{let{onClose:t}=e;const[a,l]=(0,s.useState)([]),[i,n]=(0,s.useState)({}),[o,d]=(0,s.useState)(0),[m,g]=(0,s.useState)(!1),[x,h]=(0,s.useState)(null),[u,b]=(0,s.useState)(1);(0,s.useEffect)((()=>{(async()=>{try{g(!0);const e=await r.A.get("api/sub-subcategories",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=Array.isArray(e.data)?e.data:Array.isArray(e.data.data)?e.data.data:[];l(t);const a=await r.A.get("api/items/getImageBySubSubCategory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});a.data.success&&(n(a.data.data),console.log(a.data.data))}catch(e){console.error("Error fetching data:",e),h("Failed to fetch data. Please try again.")}finally{g(!1)}})()}),[]);const y=a[o],p=(null===y||void 0===y?void 0:y._id)||(null===y||void 0===y?void 0:y.id),f=p?i[p]:null,j=async e=>{try{const t=await r.A.put("api/sub-subcategories/assign/master-image",{id:p,image:e[0]},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});console.log(t),alert("Master image selected")}catch(x){console.log("ERro in assigning master image",x)}};return m&&!a.length?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:(0,c.jsx)("p",{children:"Loading subsubcategories and master images..."})})}):x?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("p",{className:"text-red-500",children:x}),(0,c.jsx)("button",{onClick:t,className:"px-4 py-2 mt-4 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Close"})]})}):(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"relative w-11/12 max-w-5xl p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("button",{onClick:t,className:"absolute p-1 text-gray-500 top-2 right-2 hover:text-gray-800","aria-label":"Close",children:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,c.jsx)("h2",{className:"mb-4 text-xl font-semibold text-center",children:"subsubCategory Master Images"}),y&&(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("h3",{className:"mb-2 text-lg font-medium",children:y.name||`Category ${o+1}`}),(0,c.jsxs)("p",{className:"mb-4 text-sm text-gray-600",children:["ID: ",p]})]}),(0,c.jsx)("div",{className:"flex flex-col items-center justify-center p-4 mb-6 border border-gray-200 rounded-lg",children:f?(0,c.jsxs)("div",{className:"flex flex-col items-center",children:[(0,c.jsx)("img",{onClick:()=>j(f),src:`${f}`,alt:`Master for ${(null===y||void 0===y?void 0:y.name)||p}`,className:"max-w-full mb-4 max-h-96"}),(0,c.jsx)("p",{className:"text-sm text-gray-500",children:"Last generated master image"})]}):(0,c.jsx)("p",{className:"py-10 text-gray-500",children:"No master image available for this category"})}),(0,c.jsxs)("div",{className:"flex justify-between mt-6",children:[(0,c.jsx)("button",{onClick:()=>{d((e=>(e-1+a.length)%a.length))},disabled:m||a.length<=1,className:"px-4 py-2 text-white bg-gray-500 rounded hover:bg-gray-600 disabled:opacity-50",children:"Previous"}),(0,c.jsx)("div",{className:"flex gap-4",children:(0,c.jsx)("button",{onClick:()=>(async e=>{try{g(!0);const t=(await r.A.get(`api/items/subsubcategory/assign-masterImage/?page=${u}`,{categoryId:e},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data||[];n((e=>({...e,[p]:[...t]})))}catch(t){console.error("Failed to fetch merged images:",t)}finally{g(!1)}})(p),disabled:m||!y,className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 disabled:opacity-50",children:m?"Generating...":"Regenerate Master Image"})}),(0,c.jsx)("button",{onClick:()=>{d((e=>(e+1)%a.length))},disabled:m||a.length<=1,className:"px-4 py-2 text-white bg-gray-500 rounded hover:bg-gray-600 disabled:opacity-50",children:"Next"})]}),(0,c.jsxs)("div",{className:"mt-4 text-center text-gray-500",children:["Category ",o+1," of ",a.length]})]})})},m=e=>{let{onClose:t,subcategoryId:a}=e;const[l,i]=(0,s.useState)(null),[n,o]=(0,s.useState)([]),[d,m]=(0,s.useState)(!1),[g,x]=(0,s.useState)(null),[h,u]=(0,s.useState)(1);(0,s.useEffect)((()=>{a&&(async()=>{try{var e,t;m(!0);const s=await r.A.get(`api/sub-subcategories/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});i((null===(e=s.data)||void 0===e?void 0:e.data)||s.data);const l=(null===(t=(await r.A.get("api/items/getImageBysubsubCategory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data)||void 0===t?void 0:t.data)||{};o(l[a]||[])}catch(s){console.error("Error fetching data:",s),x("Failed to load category data.")}finally{m(!1)}})()}),[a]);return d?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:(0,c.jsx)("p",{children:"Loading..."})})}):g||!l?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("p",{className:"text-red-500",children:g||"Category not found."}),(0,c.jsx)("button",{onClick:t,className:"px-4 py-2 mt-4 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Close"})]})}):(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"relative w-11/12 max-w-4xl p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("button",{onClick:t,className:"absolute p-1 text-gray-500 top-2 right-2 hover:text-gray-800","aria-label":"Close",children:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,c.jsxs)("h2",{className:"mb-4 text-xl font-semibold text-center",children:["Master Images - ",l.name]}),(0,c.jsxs)("p",{className:"mb-4 text-center text-gray-500",children:["SubSubCategory ID: ",a]}),n.length>0?(0,c.jsx)("div",{className:"grid grid-cols-1 gap-4 mb-4 sm:grid-cols-2 md:grid-cols-3",children:n.map(((e,t)=>(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center p-2 border rounded shadow-sm",children:[(0,c.jsx)("img",{src:`${e}`,alt:"master",className:"object-contain mb-2 max-h-64"}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{const t=await r.A.put("api/sub-subcategories/assign/master-image",{id:a,image:e},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(t),alert("Master image updated successfully!")}catch(t){console.error("Failed to set master image:",t),alert(" set as master image.")}})(e),className:"px-3 py-1 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Set as Master"})]},t)))}):(0,c.jsx)("p",{className:"text-center text-gray-500",children:"No master images available."}),(0,c.jsx)("div",{className:"flex justify-center mt-6",children:(0,c.jsx)("button",{onClick:async()=>{try{var e;m(!0);const t=(null===(e=(await r.A.get(`api/items/subsubcategory/assign-masterImage/?page=${h}`,{params:{subcategoryId:a},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data)||void 0===e?void 0:e.data)||[];o(t)}catch(t){console.error("Failed to regenerate master images:",t)}finally{m(!1)}},className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",children:d?"Generating...":"Regenerate Master Images"})})]})})},g=()=>{const[e,t]=(0,s.useState)(!0),[a,g]=(0,s.useState)([]),[x,h]=(0,s.useState)({}),[u,b]=(0,s.useState)(!1),[y,p]=(0,s.useState)(!1),[f,j]=(0,s.useState)(null),[v,w]=(0,s.useState)({});(0,s.useEffect)((()=>{window.innerWidth<768&&t(!1)}),[window.innerWidth]);return(0,s.useEffect)((()=>{(async()=>{try{const e=await r.A.get("/api/items/getWithsubsubCategory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});g(Object.keys(e.data.data))}catch(e){console.error("Error fetching stores:",e)}})(),(async()=>{try{const e=await r.A.get("api/subcategories",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=Array.isArray(e.data)?e.data:Array.isArray(e.data.data)?e.data.data:[];console.log(t),h(t)}catch(e){console.error("Fetch categories error:",e)}})()}),[]),(0,c.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,c.jsx)(l.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,c.jsxs)("div",{className:"flex flex-grow ",children:[(0,c.jsx)("div",{children:(0,c.jsx)(o.A,{isSidebarOpen:e})}),(0,c.jsxs)("div",{className:" flex flex-col p-2 md:p-2  w-full",children:[(0,c.jsxs)("header",{className:"flex flex-col items-center justify-between p-4 rounded-md shadow sm:flex-row",children:[(0,c.jsx)("div",{className:"flex items-center gap-1 text-center sm:flex-row sm:text-left",children:(0,c.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"SubSubCategory Master Image"})}),(0,c.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,c.jsxs)(i.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,c.jsx)(n.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,c.jsx)(i.k2,{to:"/banners/view",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:"> Item Master Image"})]})]}),(0,c.jsxs)("div",{className:"p-4 mt-1 bg-white border-t-4 rounded-lg shadow-md border-cyan-500",children:[(0,c.jsx)("div",{className:"flex gap-5",children:(0,c.jsxs)("div",{className:"relative flex flex-col w-full py-2",children:[(0,c.jsx)("button",{onClick:()=>{b(!0),t(!1)},className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded hover:bg-blue-700",children:"Generate Master Image"}),u&&(0,c.jsx)(d,{onClose:()=>{t(!0),b(!1)}}),y&&(0,c.jsx)(m,{subcategoryId:f,onClose:()=>{t(!0),p(!1)}})]})}),(0,c.jsx)("div",{className:"w-full mt-4 overflow-x-auto min-h-16",children:(0,c.jsxs)("table",{className:"min-w-full border-2 divide-y divide-gray-200 min-h-48",children:[(0,c.jsx)("thead",{className:"sticky top-0 bg-gray-200",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:"py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"SubSubCategory Name"}),(0,c.jsx)("th",{className:"py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Actions"})]})}),(0,c.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(((e,a)=>{const s=x.find((t=>t._id===e));return console.log(s),(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-4 text-sm text-gray-500 whitespace-nowrap",children:(null===s||void 0===s?void 0:s.name)||"NA"}),(0,c.jsx)("td",{className:"py-4 text-sm text-gray-500 whitespace-nowrap",children:(0,c.jsx)("button",{onClick:()=>{t(!1),j(e),p(!0)},className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded hover:bg-blue-700",children:"Generate Master Image"})})]},a)}))})]})})]})]})]})]})}}}]);
//# sourceMappingURL=1092.85890a1f.chunk.js.map