"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4048],{17069:(e,a,l)=>{l.d(a,{A:()=>s});var t=l(65043);const s=t.forwardRef((function(e,a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a},e),t.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"}))}))},44048:(e,a,l)=>{l.r(a),l.d(a,{default:()=>f});var t=l(65043),s=l(59255),r=l(21197),o=l(66727),n=l(60184),i=l(17069),d=l(26873),c=l(86213),u=l(11238),m=l(37762),x=l(64857),h=l(79038),v=l(70579);function f(){const[e,a]=(0,t.useState)(!1),[l,f]=(0,t.useState)(!0),[p,g]=(0,t.useState)(!0),[b,w]=(0,t.useState)({warehouses:[],categories:[],brands:[],items:[]});(0,t.useEffect)((()=>{window.innerWidth<768&&f(!1)}),[]);const[N,y]=(0,t.useState)(""),[j,k]=(0,t.useState)("all"),[C,S]=(0,t.useState)("all"),[A,W]=(0,t.useState)("all"),[F,D]=(0,t.useState)("all"),[T,_]=(0,t.useState)("all"),[L,B]=(0,t.useState)("all"),[E,z]=(0,t.useState)("all"),[I,R]=(0,t.useState)(""),[O,M]=(0,t.useState)([]);(0,t.useEffect)((()=>{(async()=>{try{const e=(await c.A.get("api/warehouses",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data.map((e=>({label:e.warehouseName,value:e._id})));w((a=>({...a,warehouses:[{label:"All",value:"all"},...e]})))}catch(e){console.log(e.message)}finally{g(!1)}})(),(async()=>{try{const e=(await c.A.get("api/categories",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.data.map((e=>({label:e.name,value:e._id})));w((a=>({...a,categories:[{label:"All",value:"all"},...e]})))}catch(e){console.log(e.message)}finally{g(!1)}})(),(async()=>{try{const e=await c.A.get("api/brands",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data);const a=e.data.data.map((e=>({label:e.brandName,value:e._id})));w((e=>({...e,brands:[{label:"All",value:"all"},...a]})))}catch(e){console.log(e.message)}finally{g(!1)}})(),(async()=>{try{const e=await c.A.get("api/items",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e.data),w((a=>({...a,items:e.data.data})))}catch(e){console.log(e.message)}finally{g(!1)}})(),(async()=>{try{g(!0);const e=localStorage.getItem("token"),a=await c.A.get("api/stock-transfers",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});console.log(a.data),M(a.data.data)}catch(e){console.log(e.message)}finally{g(!1)}})()}),[]);const[V,$]=(0,t.useState)(!1),H=(0,t.useRef)(null),P=(0,t.useRef)(null);(0,t.useEffect)((()=>{if(!V)return;return(async()=>{if(!H.current)return;const e=new h.BrowserMultiFormatReader;P.current=e;const a=async a=>{const l={video:{facingMode:a,advanced:[{width:1920},{height:1080},{zoom:2}]}};return e.decodeFromConstraints(l,H.current,((e,a)=>{if(e){var l,t,s,r;const a=e.getText();alert(a),_(a),null===(l=(t=window.navigator).vibrate)||void 0===l||l.call(t,200);new Audio("/beep.mp3").play();const o=null===(s=H.current)||void 0===s?void 0:s.srcObject;null===o||void 0===o||o.getTracks().forEach((e=>e.stop())),null!==(r=P.current)&&void 0!==r&&r.reset&&"function"===typeof P.current.reset&&P.current.reset(),$(!1)}a&&"NotFoundException"!==a.name&&console.error("Scan error:",a)}))};try{await a({exact:"environment"})}catch(l){if("OverconstrainedError"===l.name||"NotFoundError"===l.name){console.warn("Back camera not found. Trying front camera...");try{await a("user")}catch(t){console.error("Front camera also failed:",t),alert("No camera found or accessible."),$(!1)}}else console.error("Camera access error:",l),alert("Camera access error: "+l.message),$(!1)}})(),()=>{var e,a;const l=null===(e=H.current)||void 0===e?void 0:e.srcObject;null===l||void 0===l||l.getTracks().forEach((e=>e.stop())),null!==(a=P.current)&&void 0!==a&&a.reset&&"function"===typeof P.current.reset&&P.current.reset()}}),[V]);const q=O.filter((e=>{const{fromWarehouse:a,toWarehouse:l,items:t,transferDate:s}=e,r="all"===j||a._id===j,o="all"===C||(null===l||void 0===l?void 0:l._id)===C,n="all"===A||t.some((e=>{var a,l;return(null===(a=e.item)||void 0===a||null===(l=a.category)||void 0===l?void 0:l._id)===A})),i="all"===F||t.some((e=>{var a,l;return(null===(a=e.item)||void 0===a||null===(l=a.brand)||void 0===l?void 0:l._id)===F})),d="all"===T||""===T||t.some((e=>{var a,l,t;return(null===(a=e.item)||void 0===a?void 0:a._id)===T||(null===(l=e.item)||void 0===l?void 0:l.barcode)===T||(null===(t=e.item)||void 0===t?void 0:t.itemName.toLowerCase().includes(T.toLowerCase()))})),c=new Date(s),u="all"===L?null:new Date(L),m="all"===E?null:new Date(E);return r&&o&&n&&i&&d&&((!u||c>=u)&&(!m||c<=m))})),Q=I?b.items.filter((e=>{var a,l;const t=I.toLowerCase();return(null===(a=e.itemName)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(l=e.itemCode)||void 0===l?void 0:l.toLowerCase().includes(t))||e.barcode&&e.barcode.toLowerCase().includes(t)})):[];(0,t.useEffect)((()=>{I&&b.items.filter((e=>{var a,l;const t=I.toLowerCase();return(null===(a=e.itemName)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(l=e.itemCode)||void 0===l?void 0:l.toLowerCase().includes(t))||e.barcode&&e.barcode.toLowerCase().includes(t)}))}),[I]);return(0,v.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,v.jsx)(r.A,{isSidebarOpen:l,setSidebarOpen:f}),(0,v.jsxs)("div",{className:"flex flex-grow",children:[(0,v.jsx)(s.A,{isSidebarOpen:l}),(0,v.jsxs)("div",{className:"relative flex flex-col flex-grow px-4 py-6 bg-gray-100",children:[(0,v.jsxs)("header",{className:"flex flex-col items-center justify-between sm:flex-row",children:[(0,v.jsx)("div",{className:"flex items-center gap-1 text-center sm:flex-row sm:text-left",children:(0,v.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"Stock Transfer Report"})}),(0,v.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,v.jsxs)(o.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,v.jsx)(n.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,v.jsx)(o.k2,{to:"/reports/stock-transfer",className:"text-gray-700 no-underline hover:text-cyan-600",children:"> stock Transfer Report"})]})]}),(0,v.jsxs)("div",{className:"flex flex-col w-full mx-auto mt-4 bg-white border-t-4 rounded-lg shadow-md border-cyan-600",children:[(0,v.jsx)("div",{className:"w-full h-auto px-2 border-b-2 border-gray-200",children:(0,v.jsx)("h4",{className:"text-gray-700",children:"Please Enter Valid Information"})}),(0,v.jsxs)("div",{className:"py-4 ",children:[(0,v.jsxs)("div",{className:"flex w-full gap-5 px-4 mb-4",children:[(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"From Warehouse"}),(0,v.jsx)(d.Ay,{className:"w-full",options:b.warehouses,onChange:e=>k(e.value),value:b.warehouses.find((e=>e.value===j))})]}),(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"To Warehouse"}),(0,v.jsx)(d.Ay,{className:"w-full",options:b.warehouses,onChange:e=>S(e.value),value:b.warehouses.find((e=>e.value===C))})]})]}),(0,v.jsxs)("div",{className:"flex w-full gap-5 px-4 mb-4",children:[(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"Category"}),(0,v.jsx)(d.Ay,{className:"w-full",options:b.categories,onChange:e=>W(e.value),value:b.categories.find((e=>e.value===A))||null})]}),(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"Brand"}),(0,v.jsx)(d.Ay,{className:"w-full",options:b.brands,onChange:e=>D(e.value),value:b.brands.find((e=>e.value===F))||null})]})]}),(0,v.jsxs)("div",{className:"flex w-full gap-5 px-4 mb-4",children:[(0,v.jsxs)("div",{className:"relative flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"Item Name"}),(0,v.jsxs)("label",{htmlFor:"",className:"flex",children:[(0,v.jsx)("input",{type:"text",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",value:N,onChange:e=>{R(e.target.value),y(e.target.value),_(e.target.value)}}),(0,v.jsx)("button",{type:"button",className:"p-2 ml-2 text-white rounded-full hover:bg-blue-600",onClick:()=>$(!0),children:(0,v.jsx)(i.A,{className:"w-6 h-6 text-gray-500"})})]}),""!==I&&(0,v.jsx)("div",{className:"absolute z-50 w-full overflow-y-auto bg-white border rounded-lg shadow-lg top-20 sm:w-96 max-h-60 touch-auto",style:{WebkitOverflowScrolling:"touch"},children:(0,v.jsx)("ul",{children:Q.map((e=>(0,v.jsxs)("li",{onClick:()=>{_(e._id),R(""),y(e.itemName)},className:"p-2 cursor-pointer hover:bg-gray-100",children:[(0,v.jsx)("strong",{children:e.itemCode})," - ",e.itemName," - ",e.barcode]},e.itemCode)))})}),V&&(0,v.jsxs)("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-black bg-opacity-50",children:[(0,v.jsxs)("div",{className:"relative overflow-hidden border-4 border-white rounded-lg shadow-xl w-72 h-72",children:[(0,v.jsx)("video",{ref:H,className:"absolute object-cover w-full h-full",autoPlay:!0,muted:!0,playsInline:!0}),(0,v.jsx)("div",{className:"absolute w-full h-1 bg-red-500 animate-scan"})]}),(0,v.jsx)("button",{onClick:()=>{var e,a;const l=null===(e=H.current)||void 0===e?void 0:e.srcObject;null===l||void 0===l||l.getTracks().forEach((e=>e.stop())),null!==(a=P.current)&&void 0!==a&&a.reset&&"function"===typeof P.current.reset&&P.current.reset(),$(!1)},className:"px-4 py-2 mt-6 text-white bg-red-600 rounded hover:bg-red-700",children:"Cancel"})]})]}),(0,v.jsx)("div",{className:"flex flex-col w-full"})]}),(0,v.jsxs)("div",{className:"flex w-full gap-5 px-4",children:[(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"From Date"}),(0,v.jsx)("input",{type:"date",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",onChange:e=>B(e.target.value)})]}),(0,v.jsxs)("div",{className:"flex flex-col w-full",children:[(0,v.jsx)("label",{htmlFor:"",children:"To Date"}),(0,v.jsx)("input",{type:"date",name:"type",className:"w-full px-2 py-1 border-2 rounded-md",onChange:e=>z(e.target.value)})]})]})]})]}),(0,v.jsxs)("div",{className:"flex flex-col w-full mt-5 bg-white border-t-4 border-gray-400",children:[(0,v.jsxs)("div",{className:"flex w-full px-2 py-2",children:[(0,v.jsx)("div",{className:"w-full",children:(0,v.jsx)("h4",{className:"text-gray-700",children:"Records Table"})}),(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsxs)("button",{onClick:()=>a(!e),className:"flex items-center px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",children:[(0,v.jsx)(n.OXb,{className:"mr-2"}),"Export",(0,v.jsx)("span",{className:"ml-2 text-sm",children:"\u25bc"})]}),e&&(0,v.jsx)("div",{className:"absolute right-0 z-10 w-40 mt-2 bg-white rounded-md shadow-lg",onMouseLeave:()=>a(!1),children:(0,v.jsxs)("div",{className:"py-1",children:[(0,v.jsxs)("button",{onClick:()=>{(()=>{const e=q.flatMap((e=>e.items.map(((a,l)=>{var t,s,r,o,n,i,d;return{"#":l+1,"Transfer Date":new Date(e.transferDate).toDateString(),"From Warehouse":(null===(t=e.fromWarehouse)||void 0===t?void 0:t.warehouseName)||"NA","To Warehouse":(null===(s=e.toWarehouse)||void 0===s?void 0:s.warehouseName)||"NA","Item Name":(null===(r=a.item)||void 0===r?void 0:r.itemName)||"NA",Category:(null===(o=a.item)||void 0===o||null===(n=o.category)||void 0===n?void 0:n.name)||"No category",Brand:(null===(i=a.item)||void 0===i||null===(d=i.brand)||void 0===d?void 0:d.brandName)||"No brand",Quantity:a.quantity}})))),a=u.utils.json_to_sheet(e),l=u.utils.book_new();u.utils.book_append_sheet(l,a,"Stock Transfers"),(0,u.writeFile)(l,"Stock_Transfer_Report.xlsx")})(),a(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,v.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Excel"]}),(0,v.jsxs)("button",{onClick:()=>{(()=>{const e=new m.Ay;e.text("Stock Transfer Report",14,15);const a=q.flatMap((e=>e.items.map((a=>{var l,t,s,r,o,n,i;return[new Date(e.transferDate).toLocaleDateString(),(null===(l=e.fromWarehouse)||void 0===l?void 0:l.warehouseName)||"NA",(null===(t=e.toWarehouse)||void 0===t?void 0:t.warehouseName)||"NA",(null===(s=a.item)||void 0===s?void 0:s.itemName)||"NA",(null===(r=a.item)||void 0===r||null===(o=r.category)||void 0===o?void 0:o.name)||"No category",(null===(n=a.item)||void 0===n||null===(i=n.brand)||void 0===i?void 0:i.brandName)||"No brand",a.quantity.toString()]}))));(0,x.Ay)(e,{head:[["Date","From","To","Item","Category","Brand","Qty"]],body:a,startY:20,theme:"grid",headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},styles:{fontSize:9,cellPadding:2,overflow:"linebreak"},columnStyles:{0:{cellWidth:25},1:{cellWidth:25},2:{cellWidth:25},3:{cellWidth:30},4:{cellWidth:25},5:{cellWidth:25},6:{cellWidth:15}}}),e.save("stock_transfer_report.pdf")})(),a(!1)},className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:[(0,v.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),"PDF"]})]})})]})]}),(0,v.jsx)("div",{className:"flex w-full px-2 py-2",children:(0,v.jsx)("div",{className:"w-full",children:(0,v.jsxs)("table",{className:"min-w-full gap-2 border-separate",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"#"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Transfer Date"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"From Warehouse"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"To Warehouse"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Item Name"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Category Name"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Brand Name"}),(0,v.jsx)("th",{className:"px-4 py-2 text-sm text-white bg-blue-500",children:"Quantity"})]})}),(0,v.jsxs)("tbody",{children:[q.length>0&&q.map(((e,a)=>{var l,t,s,r,o,n;return(0,v.jsxs)("tr",{className:"bg-gray-100 border-2 border-black",children:[(0,v.jsx)("td",{className:"px-4 py-2",children:a+1}),(0,v.jsx)("td",{className:"px-4 py-2",children:new Date(e.transferDate).toDateString()}),(0,v.jsx)("td",{className:"px-4 py-2",children:(null===(l=e.fromWarehouse)||void 0===l?void 0:l.warehouseName)||"NA"}),(0,v.jsx)("td",{className:"px-4 py-2",children:(null===(t=e.toWarehouse)||void 0===t?void 0:t.warehouseName)||"NA"}),(0,v.jsx)("td",{className:"px-4 py-2",children:null===(s=e.items)||void 0===s?void 0:s.map(((e,a)=>{var l;return(0,v.jsxs)("span",{children:[a+1,".",(null===(l=e.item)||void 0===l?void 0:l.itemName)||"NA"," ",(0,v.jsx)("br",{})]})}))}),(0,v.jsx)("td",{className:"px-4 py-2",children:null===(r=e.items)||void 0===r?void 0:r.map(((e,a)=>{var l,t;return(0,v.jsxs)("span",{children:[a+1,".",(null===(l=e.item)||void 0===l||null===(t=l.category)||void 0===t?void 0:t.name)||"No category"," ",(0,v.jsx)("br",{})]})}))}),(0,v.jsx)("td",{className:"px-4 py-2",children:null===(o=e.items)||void 0===o?void 0:o.map(((e,a)=>{var l,t;return(0,v.jsxs)("span",{children:[a+1,".",(null===(l=e.item)||void 0===l||null===(t=l.brand)||void 0===t?void 0:t.brandName)||"No brand"," ",(0,v.jsx)("br",{})]})}))}),(0,v.jsx)("td",{className:"px-4 py-2",children:null===(n=e.items)||void 0===n?void 0:n.map(((e,a)=>(0,v.jsxs)("span",{children:[e.quantity," ",(0,v.jsx)("br",{})]})))})]},a)})),0===q.length&&(0,v.jsx)("tr",{className:"border-2 border-black",children:(0,v.jsx)("td",{className:"px-4 py-2 text-center",colSpan:"10",children:(0,v.jsx)("h5",{children:"No Data Found"})})})]})]})})})]})]})]})]})}}}]);
//# sourceMappingURL=4048.17ecc8e5.chunk.js.map