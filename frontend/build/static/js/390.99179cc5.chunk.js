"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[390],{14840:(e,s,a)=>{a.d(s,{A:()=>n});var l=a(65043),r=a(21197),t=a(59255),i=a(70579);function n(){const[e,s]=(0,l.useState)(!1);return(0,i.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,i.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:s}),(0,i.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,i.jsx)("div",{children:(0,i.jsx)(t.A,{isSidebarOpen:e})}),(0,i.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"flex flex-col items-center",children:[(0,i.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,i.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},90390:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var l=a(65043),r=a(66727),t=a(86213),i=a(21197),n=a(59255),d=a(14840),o=a(60184),c=a(49804),m=a(70579);const u=()=>{var e;const[s]=(0,r.ok)(),a=s.get("id"),u=(0,r.Zp)(),x=localStorage.getItem("token")||"";let h=!1;if(x)try{h="admin"===JSON.parse(window.atob(x.split(".")[1])).role}catch(P){console.error("Failed to parse token:",P)}const[p,b]=(0,l.useState)(!0);(0,l.useEffect)((()=>{window.innerWidth<768&&b(!1)}),[]);const[j,f]=(0,l.useState)([]),[v,N]=(0,l.useState)([]),[g,w]=(0,l.useState)([]),[S,y]=(0,l.useState)({userName:"",FirstName:"",LastName:"",Mobile:"",Email:"",Role:"",Store:[]}),[k,C]=(0,l.useState)([]),[A,_]=(0,l.useState)(""),[E,q]=(0,l.useState)(""),[F,L]=(0,l.useState)(""),[O,R]=(0,l.useState)("active"),[U,W]=(0,l.useState)(!1),M={Authorization:`Bearer ${x}`};(0,l.useEffect)((()=>{if(!x)return u("/");t.A.get("admincreatingrole/api/roles",{headers:M}).then((e=>f(e.data.roles||[]))).catch(console.error),t.A.get("api/warehouses",{headers:M}).then((e=>N(e.data.data||[]))).catch(console.error),t.A.get("admin/store/add/store",{headers:M}).then((e=>w(e.data.result||[]))).catch(console.error)}),[u,x]),(0,l.useEffect)((()=>{a&&(W(!0),t.A.get("admiaddinguser/userlist",{headers:M}).then((e=>{const s=e.data.find((e=>e._id===a));s&&(y({userName:s.userName||"",FirstName:s.FirstName||"",LastName:s.LastName||"",Mobile:s.Mobile||"",Email:s.Email||"",Role:s.Role||"",Store:s.Store.map((e=>e._id))||[]}),C(s.WarehouseGroup||[]),_(s.Defaultwarehouse||""),R(s.status||"active"))})).catch(console.error).finally((()=>W(!1))))}),[a,x]);const D=e=>{const{name:s,value:a}=e.target;y((e=>({...e,[s]:a})))};return U?(0,m.jsx)(d.A,{}):(0,m.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,m.jsx)(i.A,{isSidebarOpen:p,setSidebarOpen:b}),(0,m.jsxs)("div",{className:"flex flex-grow",children:[(0,m.jsx)(n.A,{isSidebarOpen:p}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(E||F)&&E!==F)return alert("Passwords do not match");W(!0);const s={...S,WarehouseGroup:k,Defaultwarehouse:A,status:O};E.trim()&&(s.Password=E.trim());try{a?(await t.A.put(`admiaddinguser/${a}`,s,{headers:M}),alert("User updated")):(await t.A.post("admiaddinguser/adduserbyadmin",s,{headers:M}),alert("User created")),u("/admin/user/list")}catch(i){var l,r;console.error(i),alert((null===(l=i.response)||void 0===l||null===(r=l.data)||void 0===r?void 0:r.message)||"Error saving user")}finally{W(!1)}},className:"flex-grow p-6 overflow-auto bg-gray-100",children:[(0,m.jsxs)("header",{className:"flex justify-between items-center mb-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h1",{className:"text-2xl font-bold",children:a?"Edit User":"Create User"}),(0,m.jsx)("p",{className:"text-gray-600",children:a?"Modify user details":"Fill in user details"})]}),(0,m.jsxs)("nav",{className:"flex items-center text-gray-500",children:[(0,m.jsxs)(r.k2,{to:"/dashboard",className:"flex items-center",children:[(0,m.jsx)(o.$BV,{className:"mr-1"})," Home"]}),(0,m.jsx)(c.XWt,{className:"mx-2"}),(0,m.jsx)(r.k2,{to:"/admin/user/list",children:"User List"})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,m.jsxs)("div",{className:"space-y-4",children:[[{label:"Username",name:"userName",req:!0},{label:"First Name",name:"FirstName",req:!0},{label:"Last Name",name:"LastName",req:!0},{label:"Mobile",name:"Mobile"},{label:"Email",name:"Email",type:"email",req:!0}].map((e=>{let{label:s,name:a,type:l="text",req:r}=e;return(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:[s,r&&(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:l,name:a,value:S[a],onChange:D,required:r,className:"w-full p-2 border rounded"})]},a)})),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Role ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("select",{name:"Role",value:S.Role,onChange:D,required:!0,className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"",children:"Select Role"}),j.map((e=>(0,m.jsx)("option",{value:e._id,children:e.roleName},e._id)))]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Password",!a&&(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"password",name:"newPassword",autoComplete:"new-password",value:E,onChange:e=>q(e.target.value),required:!a,className:"w-full p-2 border rounded"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Confirm",!a&&(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"password",name:"confirmNewPassword",autoComplete:"new-password",value:F,onChange:e=>L(e.target.value),required:!a,className:"w-full p-2 border rounded"})]})]})]}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Warehouse Group"}),(0,m.jsxs)("select",{onChange:e=>{var s;(s=e.target.value)&&!k.includes(s)&&C((e=>[...e,s]))},className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"",children:"Select Warehouse"}),v.map((e=>(0,m.jsx)("option",{value:e._id,children:e.warehouseName},e._id)))]}),(0,m.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:k.map((e=>{var s;const a=(null===(s=v.find((s=>s._id===e)))||void 0===s?void 0:s.warehouseName)||e;return(0,m.jsxs)("span",{className:"px-2 py-1 bg-gray-200 rounded flex items-center",children:[a,(0,m.jsx)("button",{type:"button",onClick:()=>(e=>{C((s=>s.filter((s=>s!==e)))),A===e&&_("")})(e),className:"ml-1 text-red-500",children:"\xd7"})]},e)}))})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Default Warehouse"}),(0,m.jsxs)("select",{value:A,onChange:e=>_(e.target.value),className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"",children:"Select Default"}),k.map((e=>{var s;const a=(null===(s=v.find((s=>s._id===e)))||void 0===s?void 0:s.warehouseName)||e;return(0,m.jsx)("option",{value:e,children:a},e)}))]})]}),h?(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Store"}),(0,m.jsxs)("select",{onChange:e=>{var s;(s=e.target.value)&&!S.Store.includes(s)&&y((e=>({...e,Store:[...e.Store,s]})))},className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"",children:"Select Store"}),g.map((e=>(0,m.jsx)("option",{value:e._id,children:e.StoreName},e._id)))]}),(0,m.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:S.Store.map((e=>{var s;const a=(null===(s=g.find((s=>s._id===e)))||void 0===s?void 0:s.StoreName)||e;return(0,m.jsxs)("span",{className:"px-2 py-1 bg-gray-200 rounded flex items-center",children:[a,(0,m.jsx)("button",{type:"button",onClick:()=>(e=>{y((s=>({...s,Store:s.Store.filter((s=>s!==e))})))})(e),className:"ml-1 text-red-500",children:"\xd7"})]},e)}))})]}):(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Store"}),(0,m.jsx)("div",{className:"px-3 py-2 bg-gray-200 rounded",children:(null===(e=g.find((e=>e._id===S.Store[0])))||void 0===e?void 0:e.StoreName)||"\u2014"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Status"}),(0,m.jsxs)("select",{value:O,onChange:e=>R(e.target.value),className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"active",children:"Active"}),(0,m.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]})]}),(0,m.jsxs)("div",{className:"mt-6 flex justify-center gap-4",children:[(0,m.jsx)("button",{type:"submit",className:"px-8 py-2 bg-green-600 text-white rounded",children:a?"Update":"Save"}),(0,m.jsx)("button",{type:"button",onClick:()=>u("/admin/user/list"),className:"px-8 py-2 bg-orange-500 text-white rounded",children:"Cancel"})]})]})]})]})}}}]);
//# sourceMappingURL=390.99179cc5.chunk.js.map