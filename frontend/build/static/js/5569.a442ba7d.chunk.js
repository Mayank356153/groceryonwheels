"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5569],{55569:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var s=a(65043),r=a(86213),l=a(21197),i=a(66727),o=a(60184),n=(a(79038),a(59255)),c=a(70579);const d=e=>{let{onClose:t}=e;const[a,l]=(0,s.useState)([]),[i,o]=(0,s.useState)({}),[n,d]=(0,s.useState)([]),[m,x]=(0,s.useState)(0),[g,h]=(0,s.useState)(!1),[u,b]=(0,s.useState)(null),[y,p]=(0,s.useState)(1);(0,s.useEffect)((()=>{(async()=>{try{h(!0);const e=await r.A.get("/api/subcategories",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=Array.isArray(e.data)?e.data:Array.isArray(e.data.data)?e.data.data:[];l(t);const a=await r.A.get("/api/items/getImageBySubCategory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});a.data.success&&(o(a.data.data),console.log(a.data.data))}catch(e){console.error("Error fetching data:",e),b("Failed to fetch data. Please try again.")}finally{h(!1)}})()}),[]);const f=a[m],j=(null===f||void 0===f?void 0:f._id)||(null===f||void 0===f?void 0:f.id);(0,s.useEffect)((()=>{j&&i[j]?d(i[j]):d([])}),[j,i]);const v=async e=>{try{console.log(j),console.log(j);const t=await r.A.put("/api/subcategories/assign/master-image",{id:j,image:e},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}});console.log(t),t.data.success&&alert("Master image updated successfully")}catch(u){console.log("ERro in assigning master image",u)}};return g&&!a.length?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:(0,c.jsx)("p",{children:"Loading categories and master images..."})})}):u?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("p",{className:"text-red-500",children:u}),(0,c.jsx)("button",{onClick:t,className:"px-4 py-2 mt-4 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Close"})]})}):(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"relative w-11/12 max-w-5xl p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("button",{onClick:t,className:"absolute p-1 text-gray-500 top-2 right-2 hover:text-gray-800","aria-label":"Close",children:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,c.jsx)("h2",{className:"mb-4 text-xl font-semibold text-center",children:"Category Master Images"}),f&&(0,c.jsxs)("div",{className:"text-center",children:[(0,c.jsx)("h3",{className:"mb-2 text-lg font-medium",children:(null===f||void 0===f?void 0:f.name)||`Category ${m+1}`}),(0,c.jsxs)("p",{className:"mb-4 text-sm text-gray-600",children:["ID: ",j]})]}),(0,c.jsx)("div",{className:"p-4 mb-6 border border-gray-200 rounded-lg bg-gray-50",children:n&&n.length>0?(0,c.jsxs)("div",{className:"flex flex-col items-center",children:[(0,c.jsx)("div",{className:"w-full px-4 py-2 mb-2 overflow-x-auto",children:(0,c.jsx)("div",{className:"flex gap-6 min-w-max",children:n.map(((e,t)=>(0,c.jsxs)("div",{className:"flex hover:cursor-pointer flex-col items-center transition-transform duration-200 hover:scale-105",onClick:()=>v(e),children:[(0,c.jsxs)("div",{className:"relative group",children:[(0,c.jsx)("img",{src:e,alt:`Master ${t+1} for ${(null===f||void 0===f?void 0:f.name)||j}`,className:"object-contain w-48 h-48 rounded-lg shadow cursor-pointer md:w-64 md:h-64"}),(0,c.jsx)("div",{className:"absolute inset-0 flex items-center justify-center transition-opacity duration-200 bg-black bg-opacity-0 rounded-lg opacity-0 group-hover:opacity-100 group-hover:bg-opacity-30",children:(0,c.jsx)("span",{className:"px-3 py-1 text-sm font-medium text-white bg-black bg-opacity-50 rounded-full",children:"Select Image"})})]}),(0,c.jsxs)("p",{className:"mt-2 text-sm font-medium text-gray-600",children:["Image ",t+1]})]},t)))})}),(0,c.jsx)("p",{className:"text-xs text-gray-500",children:"Scroll horizontally to view all images"})]}):(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center py-10",children:[(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,c.jsx)("p",{className:"mt-2 text-gray-500",children:"No master image available for this category"})]})}),(0,c.jsxs)("div",{className:"flex flex-col justify-between gap-2 mt-6 md:flex-row",children:[(0,c.jsx)("button",{onClick:()=>{x((e=>(e-1+a.length)%a.length))},disabled:g||a.length<=1,className:"px-4 py-2 text-white bg-gray-500 rounded hover:bg-gray-600 disabled:opacity-50",children:"Previous"}),(0,c.jsx)("div",{className:"flex flex-col gap-4 md:flex-row",children:(0,c.jsx)("button",{onClick:()=>(async e=>{try{h(!0);const t=await r.A.get(`/api/items/subcategory/getImageForsubCategory?subcategoryId=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(t),d(t.data)}catch(t){console.error("Failed to fetch merged images:",t)}finally{h(!1)}})(j),disabled:g||!f,className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 disabled:opacity-50",children:g?"Generating...":"Regenerate Master Image"})}),(0,c.jsx)("button",{onClick:()=>{x((e=>(e+1)%a.length))},disabled:g||a.length<=1,className:"px-4 py-2 text-white bg-gray-500 rounded hover:bg-gray-600 disabled:opacity-50",children:"Next"})]}),(0,c.jsxs)("div",{className:"mt-4 text-center text-gray-500",children:["Category ",m+1," of ",a.length]})]})})},m=e=>{let{onClose:t,subcategory:a}=e;const[l,i]=(0,s.useState)([]),[o,n]=(0,s.useState)(!1),[d,m]=(0,s.useState)(null),[x,g]=(0,s.useState)(1);(0,s.useEffect)((()=>{alert("l"),h(),console.log(a)}),[]);const h=async()=>{try{console.log(a),n(!0);const e=await r.A.get(`/api/items/subcategory/getImageForsubCategory?subcategoryId=${a._id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});console.log(e),i(e.data)}catch(e){console.error("Failed to regenerate master images:",e)}finally{n(!1)}};return o?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsx)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:(0,c.jsx)("p",{children:"Loading..."})})}):d||!a?(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("p",{className:"text-red-500",children:d||"Category not found."}),(0,c.jsx)("button",{onClick:t,className:"px-4 py-2 mt-4 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Close"})]})}):(0,c.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,c.jsxs)("div",{className:"relative w-11/12 max-w-4xl p-6 bg-white rounded-lg shadow-lg",children:[(0,c.jsx)("button",{onClick:t,className:"absolute p-1 text-gray-500 top-2 right-2 hover:text-gray-800","aria-label":"Close",children:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,c.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),(0,c.jsxs)("h2",{className:"mb-4 text-xl font-semibold text-center",children:["Master Images - ",a.name]}),(0,c.jsxs)("p",{className:"mb-4 text-center text-gray-500",children:["Category ID: ",a._id]}),l.length>0?(0,c.jsx)("div",{className:"grid grid-cols-1 gap-4 mb-4 sm:grid-cols-2 md:grid-cols-3",children:l.map(((e,t)=>(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center p-2 border rounded shadow-sm",children:[(0,c.jsx)("img",{src:`${e}`,alt:"master",className:"object-contain mb-2 max-h-64"}),(0,c.jsx)("button",{onClick:()=>(async e=>{try{(await r.A.put("api/subcategories/assign/master-image",{id:a._id,image:e},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).data.success&&alert("Master image updated successfully!")}catch(t){console.error("Failed to set master image:",t),alert(" set as master image.")}})(e),className:"px-3 py-1 text-white bg-blue-500 rounded hover:bg-blue-600",children:"Set as Master"})]},t)))}):(0,c.jsx)("p",{className:"text-center text-gray-500",children:"No master images available."}),(0,c.jsx)("div",{className:"flex justify-center mt-6",children:(0,c.jsx)("button",{onClick:h,className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600",children:o?"Generating...":"Regenerate Master Images"})})]})})},x=()=>{const[e,t]=(0,s.useState)(!0),[a,x]=(0,s.useState)([]),[g,h]=(0,s.useState)([]),[u,b]=(0,s.useState)(!1),[y,p]=(0,s.useState)(!1),[f,j]=(0,s.useState)(null),[v,w]=(0,s.useState)({});(0,s.useEffect)((()=>{window.innerWidth<768&&t(!1)}),[window.innerWidth]);return(0,s.useEffect)((()=>{(async()=>{try{const e=await r.A.get("api/items/getWithsubCategory",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});x(Object.keys(e.data.data))}catch(e){console.error("Error fetching stores:",e)}})(),(async()=>{try{const e=await r.A.get("api/subcategories",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),t=Array.isArray(e.data)?e.data:Array.isArray(e.data.data)?e.data.data:[];console.log(t),h(t)}catch(e){console.error("Fetch categories error:",e)}})()}),[]),(0,c.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,c.jsx)(l.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,c.jsxs)("div",{className:"flex flex-grow ",children:[(0,c.jsx)("div",{children:(0,c.jsx)(n.A,{isSidebarOpen:e})}),(0,c.jsxs)("div",{className:" flex flex-col p-2 md:p-2  w-full",children:[(0,c.jsxs)("header",{className:"flex flex-col items-center justify-between p-4 rounded-md shadow sm:flex-row",children:[(0,c.jsxs)("div",{className:"flex items-center gap-1 text-center sm:flex-row sm:text-left",children:[(0,c.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"SubCategory Master Image"}),(0,c.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"Add/Update Master"})]}),(0,c.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,c.jsxs)(i.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,c.jsx)(o.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,c.jsx)(i.k2,{to:"/banners/view",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:"> Item Master Image"}),(0,c.jsx)(i.k2,{to:"/banners/add",className:"text-gray-700 no-underline hover:text-cyan-600",children:"> Add Banner"})]})]}),(0,c.jsxs)("div",{className:"p-4 mt-1 bg-white border-t-4 rounded-lg shadow-md border-cyan-500",children:[(0,c.jsx)("div",{className:"flex gap-5",children:(0,c.jsxs)("div",{className:"relative flex flex-col w-full py-2",children:[(0,c.jsx)("button",{onClick:()=>{b(!0),t(!1)},className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded hover:bg-blue-700",children:"Generate Master Image"}),u&&(0,c.jsx)(d,{onClose:()=>{t(!0),b(!1)}}),y&&(0,c.jsx)(m,{subcategory:f,onClose:()=>{t(!0),p(!1)}})]})}),(0,c.jsx)("div",{className:"w-full mt-4 overflow-x-auto min-h-16",children:(0,c.jsxs)("table",{className:"min-w-full border-2 divide-y divide-gray-200 min-h-48",children:[(0,c.jsx)("thead",{className:"sticky top-0 bg-gray-200",children:(0,c.jsxs)("tr",{children:[(0,c.jsx)("th",{className:"py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"SubCategory Name"}),(0,c.jsx)("th",{className:"py-3 text-xs font-medium tracking-wider text-left text-gray-500 uppercase",children:"Actions"})]})}),(0,c.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(((e,a)=>{const s=g.find((t=>t._id===e));return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"py-4 text-sm text-gray-500 whitespace-nowrap",children:s.name}),(0,c.jsx)("td",{className:"py-4 text-sm text-gray-500 whitespace-nowrap",children:(0,c.jsx)("button",{onClick:()=>{t(!1),j(s),p(!0)},className:"px-4 py-2 text-sm font-semibold text-white bg-blue-600 rounded hover:bg-blue-700",children:"Generate Master Image"})})]},a)}))})]})})]})]})]})]})}}}]);
//# sourceMappingURL=5569.a442ba7d.chunk.js.map