"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[9227],{14840:(e,a,s)=>{s.d(a,{A:()=>o});var t=s(65043),r=s(21197),l=s(59255),n=s(70579);function o(){const[e,a]=(0,t.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(r.A,{isSidebarOpen:e,setSidebarOpen:a}),(0,n.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.A,{isSidebarOpen:e})}),(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},99227:(e,a,s)=>{s.r(a),s.d(a,{default:()=>d});var t=s(65043),r=s(66727),l=s(86213),n=s(21197),o=s(59255),i=s(14840),c=s(70579);const d=function(){var e;const a=(0,r.Zp)(),{id:s}=(0,r.g)(),[d]=(0,r.ok)(),u=d.get("storeId"),[m,p]=(0,t.useState)(!0),[b,x]=(0,t.useState)(!1),h=Array.from({length:12},((e,a)=>a+1)),[g,f]=(0,t.useState)([]),[y,v]=(0,t.useState)({store:"",packageName:"",category:"",productCount:"1",description:"",total:0,paymentType:"",status:"active",startDate:"",endDate:""});(0,t.useEffect)((()=>{u&&v((e=>({...e,store:u})))}),[u]),(0,t.useEffect)((()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await l.A.get("api/payment-types",{headers:{Authorization:`Bearer ${e}`}});f(a.data.data||[])}catch(e){console.error("Error fetching payment types:",e.message)}})()}),[]),(0,t.useEffect)((()=>{const e=parseFloat(y.category)||0,a=parseInt(y.productCount,10)||0;v((s=>({...s,total:e*a})))}),[y.category,y.productCount]),(0,t.useEffect)((()=>{s&&j(s)}),[s]);const j=async e=>{x(!0);try{var a;const s=localStorage.getItem("token"),t=(await l.A.get(`api/subscriptions/${e}`,{headers:{Authorization:`Bearer ${s}`}})).data.data;v({store:t.store&&"object"===typeof t.store?t.store._id:t.store||"",packageName:t.packageName||"",category:t.category||"",productCount:t.productCount?t.productCount.toString():"1",description:t.description||"",total:t.total||0,paymentType:(null===(a=t.paymentType)||void 0===a?void 0:a._id)||t.paymentType||"",status:t.status||"active",startDate:t.startDate?t.startDate.split("T")[0]:"",endDate:t.endDate?t.endDate.split("T")[0]:""})}catch(s){console.error("Error fetching subscription:",s.message),alert("Error fetching subscription data.")}finally{x(!1)}},N=e=>{const{name:a,value:s}=e.target;v((e=>({...e,[a]:s})))};return b?(0,c.jsx)(i.A,{}):(0,c.jsxs)("div",{className:"flex flex-col bg-gray-100",children:[(0,c.jsx)(n.A,{isSidebarOpen:m,setSidebarOpen:p}),(0,c.jsxs)("div",{className:"flex flex-grow",children:[(0,c.jsx)("div",{children:(0,c.jsx)(o.A,{isSidebarOpen:m})}),(0,c.jsxs)("div",{className:"flex-grow p-6  transition-all duration-300 w-full",children:[(0,c.jsxs)("header",{className:"flex flex-col items-center justify-between mb-6 md:flex-row",children:[(0,c.jsx)("h2",{className:"text-2xl font-bold",children:s?"Edit Subscription":"Add Subscription"}),(0,c.jsxs)("nav",{className:"flex items-center text-sm text-gray-500",children:[(0,c.jsxs)("a",{href:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,c.jsx)("i",{className:"mr-2 fas fa-tachometer-alt"})," Home"]}),(0,c.jsx)("span",{className:"mx-2",children:"/"}),(0,c.jsx)("a",{href:`/subscription-list?storeId=${u}`,className:"text-gray-700 no-underline hover:text-cyan-600",children:"Subscription List"})]})]}),(0,c.jsx)("div",{className:"p-6 bg-white rounded shadow-md ",children:(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),x(!0);try{const e={Authorization:`Bearer ${localStorage.getItem("token")}`},t={...y};if(s){const a=await l.A.put(`api/subscriptions/${s}`,t,{headers:e});alert("Subscription updated successfully!"),console.log(a.data)}else await l.A.post("api/subscriptions",t,{headers:e}),alert("Subscription created successfully!");a(`/subscription-list?storeId=${u}`)}catch(t){console.error("Error submitting subscription:",t.message),alert("Error submitting subscription.")}finally{x(!1)}},children:[(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Package Name"}),(0,c.jsxs)("select",{name:"packageName",value:y.packageName,onChange:N,className:"w-full p-2 border border-gray-300 rounded",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Package"}),[{label:"Free",value:"free"},{label:"Regular",value:"regular"},{label:"Ultimate",value:"ultimate"}].map((e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Monthly Price"}),(0,c.jsxs)("select",{name:"category",value:y.category,onChange:N,className:"w-full p-2 border border-gray-300 rounded",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Price"}),[{label:"250 Monthly",value:250},{label:"2000 Annually",value:2e3}].map((e=>(0,c.jsx)("option",{value:e.value,children:e.label},e.value)))]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Package Count (months)"}),(0,c.jsx)("select",{name:"productCount",value:y.productCount,onChange:N,className:"w-full p-2 border border-gray-300 rounded",required:!0,children:h.map((e=>(0,c.jsx)("option",{value:e,children:e},e)))})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Total"}),(0,c.jsx)("input",{type:"number",name:"total",value:y.total,readOnly:!0,className:"w-full p-2 bg-gray-100 border border-gray-300 rounded"})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Payment Type"}),(0,c.jsxs)("select",{name:"paymentType",value:y.paymentType||(null===(e=y.paymentType)||void 0===e?void 0:e._id),onChange:N,className:"w-full p-2 border border-gray-300 rounded",required:!0,children:[(0,c.jsx)("option",{value:"",children:"Select Payment Type"}),g.map((e=>(0,c.jsx)("option",{value:e._id,children:e.paymentTypeName},e._id)))]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Subscription Status"}),(0,c.jsxs)("select",{name:"status",value:y.status,onChange:N,className:"w-full p-2 border border-gray-300 rounded",children:[(0,c.jsx)("option",{value:"active",children:"Active"}),(0,c.jsx)("option",{value:"inactive",children:"Inactive"}),(0,c.jsx)("option",{value:"expired",children:"Expired"})]})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Start Date"}),(0,c.jsx)("input",{type:"date",name:"startDate",value:y.startDate,onChange:N,className:"w-full p-2 border border-gray-300 rounded",required:!0})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"End Date"}),(0,c.jsx)("input",{type:"date",name:"endDate",value:y.endDate,onChange:N,className:"w-full p-2 border border-gray-300 rounded"})]}),(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("label",{className:"block mb-2 font-semibold",children:"Description"}),(0,c.jsx)("textarea",{name:"description",value:y.description,onChange:N,rows:"4",className:"w-full p-2 border border-gray-300 rounded"})]}),(0,c.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,c.jsx)("button",{type:"submit",className:"px-4 py-2 text-white transition-colors bg-green-500 rounded hover:bg-green-600",children:s?"Update Subscription":"Create Subscription"}),(0,c.jsx)("button",{type:"button",onClick:()=>a("/subscription-list?storeId="+u),className:"px-4 py-2 text-white bg-orange-500 rounded hover:bg-orange-600",children:"Close"})]})]})})]})]})]})}}}]);
//# sourceMappingURL=9227.efb8b3cc.chunk.js.map