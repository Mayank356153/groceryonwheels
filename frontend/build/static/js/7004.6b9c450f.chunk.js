(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[7004],{72450:function(e,t,n){var o,s,a;s=[],void 0===(a="function"===typeof(o=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function o(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){l(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(o){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,c=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(e,t,n){var c=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?a(l):s(l.href)?o(e,t,n):a(l,l.target="_blank")):(l.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(l.href)}),4e4),setTimeout((function(){a(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,r){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,r),n);else if(s(e))o(e,n,r);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout((function(){a(c)}))}}:function(e,t,n,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return o(e,t,n);var a="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||a&&l||c)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},d.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,f=u.createObjectURL(e);s?s.location=f:location.href=f,s=null,setTimeout((function(){u.revokeObjectURL(f)}),4e4)}});r.saveAs=l.saveAs=l,e.exports=l})?o.apply(t,s):o)||(e.exports=a)},74623:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var o=n(65043),s=n(66727),a=n(21197),r=n(59255),c=n(86213),l=n(11238),i=n(72450),d=n(60184),u=n(49804),f=n(70579);const m="api";function p(){const{accountId:e}=(0,s.g)(),{search:t}=(0,s.zy)(),{from:n,to:p,on:h}=function(e){const t=new URLSearchParams(e);return{from:t.get("from")||"",to:t.get("to")||"",on:t.get("on")||(new Date).toISOString().slice(0,10)}}(t),[x,g]=(0,o.useState)(""),[b,v]=(0,o.useState)([]),[w,j]=(0,o.useState)(!0);(0,o.useEffect)((()=>{let t=!0;return j(!0),c.A.get(`${m}/accounts/${e}`).then((n=>{if(!t)return;const o=n.data.data;return g(o.accountName),c.A.get(`${m}/by-cash-account/${e}`)})).then((e=>{if(!t)return;const o=e.data.warehouseId,s=n&&p?function(e,t){const n=[],o=new Date(e),s=new Date(t);for(;o<=s;)n.push(o.toISOString().slice(0,10)),o.setDate(o.getDate()+1);return n}(n,p):[h];return Promise.all(s.map((e=>c.A.get(`${m}/cash-summary`,{params:{warehouseId:o,date:e}}).then((t=>({date:e,...t.data}))))))})).then((e=>{t&&v(e)})).catch((e=>{console.error("Error loading ledger:",e),t&&v([])})).finally((()=>{t&&j(!1)})),()=>{t=!1}}),[e,n,p,h]);const y=(0,o.useMemo)((()=>b.length?Object.keys(b[0]):[]),[b]),N=(0,o.useMemo)((()=>{const e={};return y.forEach((t=>{const n=b.reduce(((e,n)=>{const o=n[t];if("number"===typeof o&&!isNaN(o))return e+o;const s=Number(o);return isNaN(s)?e:e+s}),0);e[t]=n})),e}),[b,y]);return w?(0,f.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,f.jsx)(a.A,{}),(0,f.jsxs)("div",{className:"flex flex-grow",children:[(0,f.jsx)(r.A,{}),(0,f.jsx)("main",{className:"flex-grow p-4",children:"Loading\u2026"})]})]}):(0,f.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,f.jsx)(a.A,{}),(0,f.jsxs)("div",{className:"flex flex-grow",children:[(0,f.jsx)(r.A,{}),(0,f.jsxs)("main",{className:"flex-grow p-4 overflow-x-auto bg-gray-50",children:[(0,f.jsxs)("nav",{className:"flex items-center text-gray-500 text-sm mb-4",children:[(0,f.jsxs)(s.N_,{to:"/account-list",className:"flex items-center",children:[(0,f.jsx)(d.$BV,{className:"mr-1"})," Accounts"]}),(0,f.jsx)(u.XWt,{className:"mx-2"}),(0,f.jsx)("span",{children:"Ledger"})]}),(0,f.jsxs)("h2",{className:"text-xl font-bold mb-4",children:["Ledger for ",(0,f.jsx)("span",{className:"text-indigo-600",children:x})]}),(0,f.jsxs)("div",{className:"mb-4 space-x-2",children:[(0,f.jsx)("button",{onClick:()=>{if(!b.length)return;const t=Object.keys(b[0]),n="\ufeff"+[t.join(","),...b.map((e=>t.map((t=>{var n;return`"${(null!==(n=e[t])&&void 0!==n?n:"").toString().replace(/"/g,'""')}"`})).join(",")))].join("\n")+"\n"+t.map(((e,t)=>{if(0===t)return'"Total"';const n=N[e];return 0!==n?`"${n}"`:'""'})).join(",");(0,i.saveAs)(new Blob([n],{type:"text/csv;charset=utf-8;"}),`ledger-${x||e}.csv`)},className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Export CSV"}),(0,f.jsx)("button",{onClick:()=>{if(!b.length)return;const t=[...b,y.reduce(((e,t,n)=>{if(0===n)e[t]="Total";else{const n=N[t];e[t]=0!==n?n:""}return e}),{})],n=l.utils.json_to_sheet(t),o=l.utils.book_new();l.utils.book_append_sheet(o,n,"Ledger");const s=l.write(o,{bookType:"xlsx",type:"array"});(0,i.saveAs)(new Blob([s],{type:"application/octet-stream"}),`ledger-${x||e}.xlsx`)},className:"px-4 py-2 bg-green-600 text-white rounded",children:"Export Excel"})]}),b.length>0?(0,f.jsx)("div",{className:"overflow-x-auto bg-white rounded shadow",children:(0,f.jsxs)("table",{className:"min-w-full text-sm",children:[(0,f.jsx)("thead",{className:"bg-gray-200",children:(0,f.jsx)("tr",{children:y.map((e=>(0,f.jsx)("th",{className:"border p-2",children:e},e)))})}),(0,f.jsx)("tbody",{children:b.map(((e,t)=>(0,f.jsx)("tr",{className:"hover:bg-gray-50",children:y.map(((t,n)=>{var o,s;return(0,f.jsx)("td",{className:"border p-2",children:null!==(o=null===(s=e[t])||void 0===s?void 0:s.toString())&&void 0!==o?o:""},n)}))},t)))}),(0,f.jsx)("tfoot",{className:"bg-gray-100 font-semibold",children:(0,f.jsx)("tr",{children:y.map(((e,t)=>(0,f.jsx)("td",{className:"border p-2",children:0===t?"Total":0!==N[e]?N[e]:""},e)))})})]})}):(0,f.jsx)("p",{className:"text-center py-8",children:"No ledger summary found."})]})]})]})}}}]);
//# sourceMappingURL=7004.6b9c450f.chunk.js.map