"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[2667],{12667:(e,a,s)=>{s.r(a),s.d(a,{default:()=>u});var r=s(65043),t=s(66727),l=s(86213),n=s(21197),i=s(59255),d=s(14840),o=s(60184),c=s(49804),m=s(70579);const x=e=>{let{setView:a,show:s,formData:r,setFormData:t}=e;const l=r[s]?r[s]:[];return(0,m.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:(0,m.jsxs)("div",{style:{backgroundColor:"#fff",padding:"30px",borderRadius:"12px",maxHeight:"80%",width:"80%",maxWidth:"800px",overflowY:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.3)",position:"relative"},children:[(0,m.jsx)("button",{onClick:()=>a(!1),style:{position:"absolute",top:"15px",right:"20px",background:"none",border:"none",fontSize:"26px",fontWeight:"bold",color:"#444",cursor:"pointer"},title:"Close",children:"\u2716"}),(0,m.jsxs)("h2",{style:{textAlign:"center",marginBottom:"20px",color:"#333",textTransform:"capitalize"},children:[s.replace(/([A-Z])/g," $1")," Preview"]}),l.length>0?(0,m.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"20px",justifyItems:"center"},children:l.map(((e,a)=>(0,m.jsxs)("div",{style:{position:"relative",borderRadius:"10px",overflow:"hidden",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",width:"100%"},children:[(0,m.jsx)("img",{src:URL.createObjectURL(e),alt:`${s} preview ${a+1}`,style:{width:"100%",height:"auto",maxHeight:"500px",objectFit:"contain",display:"block"}}),(0,m.jsx)("button",{onClick:()=>(e=>{const a=l.filter(((a,s)=>s!==e));t((e=>({...e,[s]:a.length>0?a:null})))})(a),style:{position:"absolute",top:"8px",right:"8px",background:"rgba(255, 0, 0, 0.7)",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",fontSize:"16px",fontWeight:"bold"},title:"Remove image",children:"\xd7"})]},a)))}):(0,m.jsxs)("p",{style:{textAlign:"center",color:"#666"},children:["No ",s.replace(/([A-Z])/g," $1").toLowerCase(),"  available"]})]})})},u=()=>{const e=(0,t.Zp)(),[a]=(0,t.ok)(),s=a.get("id"),u=localStorage.getItem("role"),p=localStorage.getItem("storeId");(0,r.useEffect)((()=>{window.innerWidth<768&&$(!1)}),[]);const[h,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(""),[j,N]=(0,r.useState)([]),[v,y]=(0,r.useState)([]),[w,C]=(0,r.useState)([]),[k,A]=(0,r.useState)([]),[S,I]=(0,r.useState)(""),[L,R]=(0,r.useState)("storeAdmin"===u&&p?[p]:[]),[B,D]=(0,r.useState)(""),[E,O]=(0,r.useState)("");(0,r.useEffect)((()=>{P(B!==E?e=>({...e,password:""}):e=>({...e,password:B}))}),[B,E]);const[q,$]=(0,r.useState)(!0),[z,F]=(0,r.useState)(!1),[H,P]=(0,r.useState)({profileImage:[],store:"",username:"",firstname:"",lastname:"",mobile:"",email:"",role:"",password:"",status:"Active",bankAccountNumber:"",ifscCode:"",bankName:"",addharCardImage:[],addharCardNumber:"",panCardImage:[],panCardNumber:"",drivingLicenseImage:[],drivingLicenseNumber:"",riderAccountNumber:"",riderAccountOpeningBalance:0}),U=e=>{const{name:a,value:s}=e.target;P((e=>({...e,[a]:s})))},V=e=>{const{name:a,files:s}=e.target;P((e=>({...e,[a]:[...e[a]||[],s[0]]})))};return(0,r.useEffect)((()=>{(async()=>{try{const e=await l.A.get("api/rider/all",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),a=e.data.data[e.data.data.length-1];console.log(a),P((e=>({...e,riderAccountNumber:"RIDER-2025-004"})))}catch(e){console.log("Error in fetching Rider",e.message)}})()}),[]),(0,r.useEffect)((()=>{F(!0);const e={Authorization:`Bearer ${localStorage.getItem("token")}`},a=l.A.get("/admincreatingrole/api/roles",{headers:e}),s=l.A.get("/api/warehouses",{headers:e}),r=l.A.get("/admin/store/add/store",{headers:e});Promise.all([a,s,r]).then((e=>{let[a,s,r]=e;const t=a.data.roles||[];N(t);const l=t.find((e=>"Delivery rider"===e.roleName));l&&P((e=>({...e,role:l._id}))),y(s.data.data||[]),C(r.data.result||[])})).catch((e=>{console.error("Lookup error:",e)})).finally((()=>{F(!1)}))}),[e]),(0,r.useEffect)((()=>{s&&(F(!0),l.A.get("api/rider/all",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then((e=>{console.log(e);const a=e.data.data.find((e=>e._id===s));a&&(P(a),console.log(a),A((a.WarehouseGroup||"").split(",").filter((e=>e))),I(a.Defaultwarehouse||""),R(a.Store||[]))})).catch(console.error).finally((()=>F(!1))))}),[s]),(0,r.useEffect)((()=>console.log(H)),[H]),z?(0,m.jsx)(d.A,{}):(0,m.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,m.jsx)(n.A,{isSidebarOpen:q,setSidebarOpen:$}),(0,m.jsxs)("div",{className:"flex flex-grow",children:[(0,m.jsx)("div",{children:(0,m.jsx)(i.A,{isSidebarOpen:q})}),h&&(0,m.jsx)(x,{formData:H,setView:b,setFormData:P,show:g}),(0,m.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),F(!0),s)return alert("Updated"),void F(!1);try{const e=new FormData;Object.entries(H).forEach((a=>{let[s,r]=a;Array.isArray(r)?r.forEach((a=>{e.append(s,a)})):e.append(s,r)}));const a=s?`admiaddinguser/${s}`:"api/rider/create",r=s?"put":"post",t=await(0,l.A)({method:r,url:a,data:e,headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});alert(s?"User updated":"User created"),console.log(t.data)}catch(t){var a,r;console.error(t),alert((null===(a=t.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||t.message)}finally{F(!1)}},className:"flex-grow p-6 overflow-auto bg-gray-100",children:[(0,m.jsxs)("header",{className:"flex flex-col items-center justify-between mb-4 md:flex-row",children:[(0,m.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,m.jsx)("h1",{className:"text-2xl font-bold",children:s?"Edit Rider":"Create Rider"}),(0,m.jsx)("p",{className:"text-gray-600",children:s?"Modify details":"Fill in details"})]}),(0,m.jsxs)("nav",{className:"flex items-center text-gray-500",children:[(0,m.jsxs)(t.k2,{to:"/dashboard",className:"flex items-center text-gray-500 no-underline hover:text-gray-800",children:[(0,m.jsx)(o.$BV,{className:"mr-1"})," Home"]}),(0,m.jsx)(c.XWt,{className:"mx-2"}),(0,m.jsx)(t.k2,{to:"/admin/user/list",className:"text-gray-500 no-underline hover:text-gray-800",children:"Rider List"})]})]}),(0,m.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,m.jsxs)("div",{className:"space-y-4",children:[[{label:"Username",name:"username",req:!0},{label:"First Name",name:"firstname",req:!0},{label:"Last Name",name:"lastname",req:!0},{label:"Mobile",name:"mobile"},{label:"Email",name:"email",type:"email",req:!0},{label:"Bank Account Number",name:"bankAccountNumber",type:"text",req:!0},{label:"IFSC Code",name:"ifscCode",type:"text",req:!0},{label:"Bank Name",name:"bankName",type:"text",req:!0},{label:"Rider Account Number",name:"riderAccountNumber",type:"text",req:!0}].map((e=>{let{label:a,name:s,type:r="text",req:t}=e;return(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:[a,t&&(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:r,name:s,value:H[s],onChange:U,className:"w-full p-2 border rounded"})]},s)})),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Role ",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("select",{name:"role",value:H.role,onChange:e=>P((a=>({...a,role:e.target.value}))),className:"w-full p-2 border rounded",required:!0,children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Select role"}),j.map((e=>(0,m.jsx)("option",{value:e._id,children:e.roleName},e._id)))]})]})]}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Password",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"password",value:B,onChange:e=>D(e.target.value),className:"w-full p-2 border rounded"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Confirm",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"password",value:E,onChange:e=>O(e.target.value),className:"w-full p-2 border rounded"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Default Warehouse"}),(0,m.jsxs)("select",{value:H.store,onChange:e=>P((a=>({...a,store:e.target.value}))),className:"w-full p-2 border rounded",children:[(0,m.jsx)("option",{value:"",children:"Select"}),w.map((e=>(0,m.jsx)("option",{value:e._id,children:e.StoreName},e._id)))]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block mb-2 font-semibold",children:"Profile Picture"}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("input",{type:"file",name:"profileImage",onChange:V,className:"flex-1 p-2 border rounded"}),(0,m.jsx)("button",{type:"button",onClick:()=>{b(!0),f("profileImage")},className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 whitespace-nowrap",children:h.profileImage?"Hide":"View"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Addhar Card Number",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"text",value:H.addharCardNumber,onChange:U,name:"addharCardNumber",className:"w-full p-2 border rounded"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Aadhar Card Image",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("input",{type:"file",name:"addharCardImage",onChange:V,className:"flex-1 p-2 border rounded"}),(0,m.jsx)("button",{onClick:()=>{b(!0),f("addharCardImage")},className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 whitespace-nowrap",type:"button",children:h.addharCardImage?"Hide":"View"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["PanCard Number",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"text",value:H.panCardNumber,onChange:U,name:"panCardNumber",className:"w-full p-2 border rounded"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["PanCard Image",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("input",{type:"file",name:"panCardImage",onChange:V,className:"flex-1 p-2 border rounded"}),(0,m.jsx)("button",{onClick:()=>{b(!0),f("panCardImage")},className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 whitespace-nowrap",type:"button",children:h.panCardImage?"Hide":"View"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Driving License Number",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsx)("input",{type:"text",value:H.drivingLicenseNumber,onChange:U,name:"drivingLicenseNumber",className:"w-full p-2 border rounded"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("label",{className:"block font-semibold",children:["Driving License Image",(0,m.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,m.jsxs)("div",{className:"flex items-center gap-2",children:[(0,m.jsx)("input",{type:"file",name:"drivingLicenseImage",onChange:V,className:"flex-1 p-2 border rounded"}),(0,m.jsx)("button",{onClick:()=>{b(!0),f("drivingLicenseImage")},className:"px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 whitespace-nowrap",type:"button",children:h.drivingLicenseImage?"Hide":"View"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block font-semibold",children:"Rider Account OpeningBalance"}),(0,m.jsx)("input",{type:"Number",value:H.riderAccountOpeningBalance,onChange:U,min:"0",name:"riderAccountOpeningBalance",className:"w-full p-2 border rounded"})]})]})]}),(0,m.jsxs)("div",{className:"flex justify-center gap-4 mt-6",children:[(0,m.jsx)("button",{className:"px-8 py-2 text-white bg-green-600 rounded",children:s?"Update":"Save"}),(0,m.jsx)("button",{type:"button",onClick:()=>e("/admin/user/list"),className:"px-8 py-2 text-white bg-orange-500 rounded",children:"Cancel"})]})]})]})]})}},14840:(e,a,s)=>{s.d(a,{A:()=>i});var r=s(65043),t=s(21197),l=s(59255),n=s(70579);function i(){const[e,a]=(0,r.useState)(!1);return(0,n.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,n.jsx)(t.A,{isSidebarOpen:e,setSidebarOpen:a}),(0,n.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,n.jsx)("div",{children:(0,n.jsx)(l.A,{isSidebarOpen:e})}),(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}}}]);
//# sourceMappingURL=2667.71e412cd.chunk.js.map