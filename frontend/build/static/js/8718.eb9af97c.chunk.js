"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[8718],{14840:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(65043),n=s(21197),o=s(59255),l=s(70579);function r(){const[e,t]=(0,a.useState)(!1);return(0,l.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,l.jsx)(n.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,l.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,l.jsx)("div",{children:(0,l.jsx)(o.A,{isSidebarOpen:e})}),(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,l.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}},27473:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(65043);const n=a.forwardRef((function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"}))}))},33150:(e,t,s)=>{s.d(t,{A:()=>n});var a=s(65043);const n=a.forwardRef((function(e,t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"}))}))},98718:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var a=s(65043),n=s(27473),o=s(33150),l=s(83910),r=s(97929),i=s(60184),d=s(49804),c=s(66727),m=s(21197),x=s(59255),u=s(64857),h=s(11238),p=s(37762),y=s(26873),g=s(86213),f=s(14840),b=s(70579);const v=()=>{const e=(0,c.Zp)(),[t,s]=(0,a.useState)([]),[v,j]=(0,a.useState)("all"),[w,N]=(0,a.useState)(""),[S,k]=(0,a.useState)(""),[A,C]=(0,a.useState)(!0),[D,$]=(0,a.useState)(""),[F,T]=(0,a.useState)(10),[L,_]=(0,a.useState)(1),[z,I]=(0,a.useState)([]),[P,E]=(0,a.useState)(0),[R,B]=(0,a.useState)(0),[O,M]=(0,a.useState)(!1),[W,Y]=(0,a.useState)(null),[V,H]=(0,a.useState)([]),[U,G]=(0,a.useState)(!1),[X,q]=(0,a.useState)(null),[Q,Z]=(0,a.useState)(null),[J,K]=(0,a.useState)(0),[ee,te]=(0,a.useState)(0),se=(0,a.useRef)(null),ae=(0,a.useRef)({}),ne=(new Date).toISOString().slice(0,10);(0,a.useEffect)((()=>{if(W&&se.current&&ae.current[W]){const e=se.current,t=ae.current[W].getBoundingClientRect(),s=e.getBoundingClientRect(),a=window.innerHeight,n=(window.innerWidth,10),o=t.width+5;let l=t.top+window.scrollY-n,r=t.left+window.scrollX-s.width-o;l<window.scrollY&&(l=t.bottom+window.scrollY+5),l+s.height>window.scrollY+a&&(l=t.top+window.scrollY-s.height-n),r<0&&(r=t.right+window.scrollX+5),e.style.position="fixed",e.style.top=`${l}px`,e.style.left=`${r}px`,e.style.right="auto",e.style.bottom="auto"}}),[W]);const oe=(e,t,s)=>{var a,n,o;const l=new p.uE;l.setFontSize(20),l.text("Invoice",14,20),l.setFontSize(12),l.text(`Invoice #: ${e.saleCode||"N/A"}`,14,5),l.text(`Date: ${new Date(e.saleDate).toLocaleDateString()}`,14,10),l.text(`Source: ${s}`,14,15),l.setFontSize(14),l.text("Customer Information",14,25),l.setFontSize(12),l.text(`Name: ${(null===(a=e.customer)||void 0===a?void 0:a.customerName)||"N/A"}`,14,35),l.text(`Mobile: ${(null===(n=e.customer)||void 0===n?void 0:n.mobile)||"N/A"}`,14,40);const r=(null===(o=e.customer)||void 0===o?void 0:o.address)||{},i=[r.street,r.city,r.state,r.zip,r.country].filter((e=>e)).join(", ");l.text(`Address: ${i||"N/A"}`,14,45),l.setFontSize(14),l.text("Items",14,55);const d=(e.items||[]).map((e=>{var t;return[(null===(t=e.item)||void 0===t?void 0:t.itemName)||"N/A",e.quantity||0,`Rs. ${(e.unitPrice||e.price||0).toFixed(2)}`,`Rs. ${(e.discount||0).toFixed(2)}`,`Rs. ${(e.subtotal||(e.unitPrice||e.price||0)*(e.quantity||0)-(e.discount||0)).toFixed(2)}`]}));(0,u.Ay)(l,{startY:60,head:[["Item Name","Quantity","Unit Price","Discount","Subtotal"]],body:d,theme:"striped",styles:{fontSize:10},headStyles:{fillColor:[0,123,255]}});let c=l.lastAutoTable.finalY||60;if(l.setFontSize(12),l.text(`Subtotal: Rs. ${(e.subtotal||e.totalAmount||0).toFixed(2)}`,14,c+5),(e.discountOnBill||e.totalDiscount)&&l.text(`Discount: Rs. ${(e.discountOnBill||e.totalDiscount||0).toFixed(2)}`,14,c+10),l.text(`Grand Total: Rs. ${(e.grandTotal||e.totalAmount||0).toFixed(2)}`,14,c+15),t.length>0){c+=20,l.setFontSize(14),l.text("Payments",14,c);const s=t.map((e=>{var t;return[new Date(e.paymentDate).toLocaleDateString(),(null===(t=e.paymentType)||void 0===t?void 0:t.paymentTypeName)||"N/A",`Rs. ${(e.amount||e.paymentAmount||0).toFixed(2)}`,e.paymentNote||"-"]}));(0,u.Ay)(l,{startY:c+5,head:[["Date","Payment Type","Amount","Note"]],body:s,theme:"striped",styles:{fontSize:10},headStyles:{fillColor:[0,123,255]}}),c=l.lastAutoTable.finalY;const a=t.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0);l.setFontSize(12),l.text(`Total Paid: Rs. ${a.toFixed(2)}`,14,c+5);const n=(e.grandTotal||e.totalAmount||0)-a;l.text(`Due Amount: Rs. ${n.toFixed(2)}`,14,c+10)}c=t.length>0?c+15:c+20,l.setFontSize(10),l.setTextColor(150),l.text("Thank you for your business!",14,c+5),l.text("Generated by Grocery on Wheels",14,c+10);const m=l.output("blob"),x=URL.createObjectURL(m);window.open(x,"_blank")};(0,a.useEffect)((()=>{window.innerWidth<768&&C(!1)}),[]);const le=async()=>{const e=localStorage.getItem("token");if(e){M(!0);try{const{data:t}=await g.A.get("api/pos/invoices",{headers:{Authorization:`Bearer ${e}`}});I(t)}catch(t){alert(`Could not load invoices: ${t.message}`)}finally{M(!1)}}else console.log("No token found redirecting...")};(0,a.useEffect)((()=>{(async()=>{const e=localStorage.getItem("token");if(e){M(!0);try{const t=await g.A.get("api/warehouses",{headers:{Authorization:`Bearer ${e}`}});if(t.data.data){const e=[{label:"All",value:"all"},...t.data.data.map((e=>({label:e.warehouseName,value:e._id})))];s(e)}}catch(t){alert(t.message)}finally{M(!1)}}else console.log("No token found redirecting...")})(),le(),(async()=>{const e=localStorage.getItem("token");if(e)try{const t=await g.A.get("api/payment-types",{headers:{Authorization:`Bearer ${e}`}});if(t.data.data){const e=t.data.data.map((e=>({label:e.paymentTypeName,value:e._id})));H(e),console.log("Fetched payment types:",e)}}catch(t){console.error("Error fetching payment types:",t.message),alert(`Failed to load payment types: ${t.message}`)}else console.log("No token found for payment types")})()}),[]),(0,a.useEffect)((()=>{let e=0,t=0;z.forEach((s=>{var a,n;const o=null===(a=s.payments)||void 0===a?void 0:a[0],l=null===o||void 0===o||null===(n=o.paymentType)||void 0===n?void 0:n.paymentTypeName;"Cash"===l&&(e+=o.amount||o.paymentAmount||0),"Bank"===l&&(t+=o.amount||o.paymentAmount||0)})),K(e),te(t)}),[z]);const re=z.filter((e=>{var t,s,a,n,o,l,r;const i=D.toLowerCase(),d=((null===(t=e.creatorName)||void 0===t?void 0:t.toLowerCase())||"").includes(i)||("string"===typeof e.customer?e.customer.toLowerCase():null===(s=e.customer)||void 0===s||null===(a=s.customerName)||void 0===a?void 0:a.toLowerCase()).includes(i)||(null===(n=e.customer)||void 0===n||null===(o=n.mobile)||void 0===o?void 0:o.toLowerCase().includes(i))||(null===(l=e.saleCode)||void 0===l?void 0:l.toLowerCase().includes(i)),c=new Date(e.saleDate).getTime(),m=w?new Date(w).getTime():0,x=S?new Date(S).getTime():1/0,u=c>=m&&c<=x,h="all"===v||""===v||(null===(r=e.warehouse)||void 0===r?void 0:r._id)===v;return d&&u&&h})),ie=re.length,de=re.reduce(((e,t)=>e+t.amount),0),ce=re.reduce(((e,t)=>{var s;return e+((null===(s=t.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0)}),0),me=de-ce,xe=Math.ceil(re.length/F),ue=re.slice((L-1)*F,L*F),he=e=>{e>=1&&e<=xe&&_(e)};return(0,a.useEffect)((()=>{(()=>{const e=ue.reduce(((e,t)=>e+t.amount),0),t=ue.reduce(((e,t)=>{var s;return e+((null===(s=t.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0)}),0);E(e),B(t)})()}),[ue]),O?(0,b.jsx)(f.A,{}):(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)(m.A,{isSidebarOpen:A,setSidebarOpen:C}),(0,b.jsxs)("div",{className:"box-border flex min-h-screen",children:[(0,b.jsx)("div",{className:"w-auto",children:(0,b.jsx)(x.A,{isSidebarOpen:A})}),(0,b.jsxs)("div",{className:"flex flex-col p-2 md:p-2 w-full mx-auto overflow-x-auto",children:[(0,b.jsxs)("header",{className:"flex flex-col items-center justify-between px-2 py-2 mb-2 bg-gray-100 rounded-md shadow md:flex-row",children:[(0,b.jsxs)("div",{className:"flex items-baseline gap-1 text-center sm:flex-row sm:text-left",children:[(0,b.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"Invoices List"}),(0,b.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"View/Search Invoices"})]}),(0,b.jsxs)("nav",{className:"flex flex-wrap items-center justify-center text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,b.jsxs)(c.k2,{to:"/dashboard",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,b.jsx)(i.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"}),"Home"]}),(0,b.jsx)(d.XWt,{className:"mx-1 sm:mx-2"}),(0,b.jsx)(c.k2,{to:"/sales-list",className:"text-gray-700 no-underline hover:text-cyan-600",children:"Invoices List"})]})]}),(0,b.jsx)("div",{className:"flex flex-col gap-4",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(n.A,{className:"w-16 text-white rounded bg-cyan-500"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsx)("h2",{className:"text-xl",children:ie}),(0,b.jsx)("p",{className:"font-bold",children:"Total Invoices"})]})]}),(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(i.Tsk,{className:"w-16 h-16 text-white rounded bg-cyan-500"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsxs)("h2",{className:"text-xl",children:["\u20b9",de.toFixed(2)]}),(0,b.jsx)("p",{className:"font-bold",children:"Total Invoices Amount"})]})]}),(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(l.g,{icon:r.d0D,className:"w-16 h-16 text-white rounded bg-cyan-500"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsxs)("h2",{className:"text-xl",children:["\u20b9",ce.toFixed(2)]}),(0,b.jsx)("p",{className:"font-bold",children:"Total Received Amount"})]})]}),(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(o.A,{className:"h-16 text-white rounded bg-cyan-500 w-18"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsxs)("h2",{className:"text-xl",children:["\u20b9",me.toFixed(2)]}),(0,b.jsx)("p",{className:"font-bold",children:"Total Sales Due"})]})]}),(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(l.g,{icon:r.d0D,className:"w-16 h-16 text-white rounded bg-cyan-500"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsxs)("h2",{className:"text-xl",children:["\u20b9",J.toFixed(2)]}),(0,b.jsx)("p",{className:"font-bold",children:"Cash Sales"})]})]}),(0,b.jsxs)("div",{className:"flex items-center text-black bg-white rounded-lg shadow-md",children:[(0,b.jsx)(l.g,{icon:r.URI,className:"w-16 h-16 text-white rounded bg-cyan-500"}),(0,b.jsxs)("div",{className:"flex flex-col justify-center ml-4",children:[(0,b.jsxs)("h2",{className:"text-xl",children:["\u20b9",ee.toFixed(2)]}),(0,b.jsx)("p",{className:"font-bold",children:"Bank Sales"})]})]})]})}),(0,b.jsxs)("div",{className:"p-4 bg-white shadow-md rounded-md mt-3 border-t-4 border-cyan-500",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-10",children:[(0,b.jsx)("div",{}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)("button",{className:"w-full px-4 py-2 text-white rounded-md bg-cyan-500 hover:bg-cyan-600",onClick:()=>e("/add-sale"),children:"+ Create Invoice"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block font-semibold text-gray-700",children:["Warehouse ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(y.Ay,{options:t,onChange:e=>j(e.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block font-semibold text-gray-700",children:"Customers"}),(0,b.jsx)("input",{type:"text",onChange:e=>$(e.target.value),placeholder:"Search Name/Mobile",className:"w-full p-2 border rounded-md"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block font-semibold text-gray-700",children:"Users"}),(0,b.jsxs)("select",{className:"w-full p-2 border rounded-md",children:[(0,b.jsx)("option",{children:"All"}),(0,b.jsx)("option",{children:"Admin"}),(0,b.jsx)("option",{children:"Manager"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 mt-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block font-semibold text-gray-700",children:"From Date"}),(0,b.jsxs)("div",{className:"flex items-center p-2 border rounded-md",children:[(0,b.jsx)("span",{className:"mr-2",children:"\ud83d\udcc5"}),(0,b.jsx)("input",{type:"date",className:"w-full outline-none",onChange:e=>N(e.target.value)})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block font-semibold text-gray-700",children:"To Date"}),(0,b.jsxs)("div",{className:"flex items-center p-2 border rounded-md",children:[(0,b.jsx)("span",{className:"mr-2",children:"\ud83d\udcc5"}),(0,b.jsx)("input",{type:"date",className:"w-full outline-none",onChange:e=>k(e.target.value)})]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col justify-between mt-4 mb-4 space-y-2 md:flex-row md:space-y-0 md:items-center",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)("span",{className:"text-sm",children:"Show"}),(0,b.jsxs)("select",{className:"p-2 text-sm border border-gray-300 rounded-md",value:F,onChange:e=>{T(Number(e.target.value)),_(1)},children:[(0,b.jsx)("option",{children:"10"}),(0,b.jsx)("option",{children:"20"}),(0,b.jsx)("option",{children:"50"}),(0,b.jsx)("option",{children:"100"}),(0,b.jsx)("option",{children:"200"}),(0,b.jsx)("option",{children:"500"}),(0,b.jsx)("option",{children:"1000"})]}),(0,b.jsx)("span",{className:"text-sm",children:"Entries"})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between flex-1 gap-2",children:[(0,b.jsx)("button",{onClick:()=>{const e=re.map((e=>{var t,s;const a=(null===(t=e.payments)||void 0===t?void 0:t.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0;return`${new Date(e.saleDate).toDateString()}, ${e.saleCode}, ${"string"===typeof e.customer?e.customer:(null===(s=e.customer)||void 0===s?void 0:s.customerName)||"N/A"}, ${e.amount.toFixed(2)}, ${a.toFixed(2)}, ${e.source}`})).join("\n");navigator.clipboard.writeText(e),alert("Data copied to clipboard!")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Copy"}),(0,b.jsx)("button",{onClick:()=>{const e=re.map((e=>{var t,s;return{Date:new Date(e.saleDate).toDateString(),Code:e.saleCode,Customer:"string"===typeof e.customer?e.customer:(null===(t=e.customer)||void 0===t?void 0:t.customerName)||"N/A",Amount:e.amount.toFixed(2),"Amount Paid":((null===(s=e.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0).toFixed(2),Source:e.source}})),t=h.utils.json_to_sheet(e),s=h.utils.book_new();h.utils.book_append_sheet(s,t,"Invoices"),h.writeFile(s,"invoices.xlsx")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Excel"}),(0,b.jsx)("button",{onClick:()=>{const e=new p.uE;e.text("Invoices List",20,20);const t=re.map((e=>{var t,s;return[new Date(e.saleDate).toDateString(),e.saleCode,"string"===typeof e.customer?e.customer:(null===(t=e.customer)||void 0===t?void 0:t.customerName)||"N/A",e.amount.toFixed(2),((null===(s=e.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0).toFixed(2),e.source]}));(0,u.Ay)(e,{head:[["Date","Code","Customer","Amount","Amount Paid","Source"]],body:t}),e.save("invoice_list.pdf")},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"PDF"}),(0,b.jsx)("button",{onClick:()=>{window.print()},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"Print"}),(0,b.jsx)("button",{onClick:()=>{const e=re.map((e=>{var t,s;return[new Date(e.saleDate).toDateString(),e.saleCode,"string"===typeof e.customer?e.customer:(null===(t=e.customer)||void 0===t?void 0:t.customerName)||"N/A",e.amount.toFixed(2),((null===(s=e.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0).toFixed(2),e.source]})),t="data:text/csv;charset=utf-8,"+["Date","Code","Customer","Amount","Amount Paid","Source"].join(",")+"\n"+e.map((e=>e.join(","))).join("\n"),s=encodeURI(t),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download","invoices.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"px-3 py-2 text-sm text-white bg-cyan-500",children:"CSV"})]}),(0,b.jsx)("input",{type:"text",placeholder:"Search",className:"w-full p-2 text-sm border border-gray-300",onChange:e=>$(e.target.value)})]})]}),(0,b.jsx)("div",{className:"mt-6 overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full bg-white border border-gray-300 shadow-sm",children:[(0,b.jsx)("thead",{className:"bg-gray-200",children:(0,b.jsx)("tr",{children:["Date","Code","Customer","Amount","Amount Paid","Source","Creator","Status","Action"].map((e=>(0,b.jsx)("th",{className:"px-4 py-2 text-sm font-medium text-left border",children:e},e)))})}),(0,b.jsxs)("tbody",{children:[ue.length<=0?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"8",className:"p-4 text-center text-gray-500 border",children:"No data available in table"})}):ue.map((t=>{var s,a;const n=(null===(s=t.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0;return(0,b.jsxs)("tr",{className:"bg-gray-100",children:[(0,b.jsx)("td",{className:"border px-2 py-1",children:new Date(t.saleDate).toLocaleDateString()}),(0,b.jsx)("td",{className:"border px-2 py-1",children:t.saleCode}),(0,b.jsx)("td",{className:"border px-2 py-1",children:"string"===typeof t.customer?t.customer:(null===(a=t.customer)||void 0===a?void 0:a.customerName)||"N/A"}),(0,b.jsxs)("td",{className:"border px-2 py-1",children:["\u20b9",t.amount.toFixed(2)]}),(0,b.jsxs)("td",{className:"border px-2 py-1",children:["\u20b9",n.toFixed(2)]}),(0,b.jsx)("td",{className:"border px-2 py-1",children:t.source}),(0,b.jsx)("td",{className:"border px-2 py-1",children:t.creatorName||"\u2014"}),(0,b.jsx)("td",{className:"border px-2 py-1",children:(0,b.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-semibold rounded \n                              "+("Paid"===t.paymentStatus?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.paymentStatus})}),(0,b.jsxs)("td",{className:"relative p-2 border",children:[(0,b.jsxs)("button",{ref:e=>ae.current[t._id]=e,className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold text-white bg-cyan-600 rounded-full shadow-sm \n                              hover:bg-cyan-700 active:scale-95 transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-cyan-400",onClick:()=>{W===t._id?Y(null):Y(t._id)},children:[(0,b.jsx)("span",{children:"Action"}),(0,b.jsx)("svg",{className:"w-4 h-4 transition-transform duration-200 "+(W===t._id?"rotate-180":""),fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),W===t._id&&(0,b.jsxs)("div",{ref:se,className:"z-50 bg-white border border-gray-200 shadow-xl rounded-lg w-48 transition-all duration-200 ease-in-out transform scale-100 opacity-100 animate-dropdown-open",style:{minWidth:"150px",maxHeight:"300px",overflowY:"auto"},children:[(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-blue-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(t=>{e(`/view-sale?id=${t._id}&source=${t.source}`)})(t),children:"\ud83d\udcc4 View Sales"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-green-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(t=>{const s=new Date(t.saleDate);if((new Date-s)/864e5>2)return alert("You can only edit invoices up to 7 days old.");"Sale"===t.source?e(`/add-sale?id=${t._id}`):e(`/pos?id=${t._id}`)})(t),children:"\u270f\ufe0f Edit"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-teal-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(e=>{new Date(e.saleDate).toISOString().slice(0,10)===ne?(q(e),Z(null),G(!0)):alert("Editing payment type is only allowed for invoices from today.")})(t),children:"\ud83d\udcb5 Edit Payment Type"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-purple-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(t=>{e(`/view-payment?saleId=${t._id}`)})(t),children:"\ud83d\udcb3 View Payments"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-indigo-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(async t=>{M(!0);try{const s=localStorage.getItem("token");if(!s)return alert("No token found, please log in"),void e("/login");const a="Sale"===t.source?`api/sales/${t._id}`:`api/pos/${t._id}`,{data:n}=await g.A.get(a,{headers:{Authorization:`Bearer ${s}`}}),o=(await g.A.get(`api/payments/${t._id}`,{headers:{Authorization:`Bearer ${s}`}})).data.payments||[];oe(n,o,t.source)}catch(s){console.error("Error generating PDF:",s),alert(`Failed to generate PDF: ${s.message}`)}finally{M(!1)}})(t),children:"\ud83d\udce5 PDF"}),(0,b.jsx)("button",{className:"w-full px-3 py-2 text-left text-red-600 hover:bg-gray-50 transition-colors flex items-center gap-2",onClick:()=>(async(e,t)=>{if(window.confirm("Do you want to delete this sale?")){M(!0);try{const s="POS"===t?`api/pos/${e}`:`api/sales/${e}`;await g.A.delete(s,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert("Deleted Successfully")}catch(s){console.error(s.message),alert(`Error deleting: ${s.message}`)}finally{le(),M(!1)}}})(t._id,t.source),children:"\ud83d\uddd1\ufe0f Delete"})]})]})]},t._id)})),ue.length>0&&(0,b.jsxs)("tr",{className:"font-bold bg-gray-100",children:[(0,b.jsx)("td",{colSpan:"3",className:"text-right border",children:"Total :"}),(0,b.jsx)("td",{className:"text-center border",children:P.toFixed(2)}),(0,b.jsx)("td",{className:"text-center border",children:ue.reduce(((e,t)=>{var s;return e+((null===(s=t.payments)||void 0===s?void 0:s.reduce(((e,t)=>e+(t.amount||t.paymentAmount||0)),0))||0)}),0).toFixed(2)}),(0,b.jsx)("td",{className:"text-center border"}),(0,b.jsx)("td",{className:"text-center border"}),(0,b.jsx)("td",{className:"text-center border"})]})]})]})}),(0,b.jsxs)("div",{className:"flex flex-col items-start justify-between gap-2 p-2 md:justify-between md:flex-row",children:[(0,b.jsx)("span",{children:(0,b.jsxs)("span",{children:["Showing ",F*(L-1)+1," to ",Math.min(F*L,re.length)," of ",re.length," entries"]})}),(0,b.jsxs)("div",{className:"flex justify-between w-full md:w-auto md:gap-2",children:[(0,b.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 shadow-md \n                  "+(1===L?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"),onClick:()=>he(L-1),disabled:1===L,children:[(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})}),"Previous"]}),(0,b.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 text-sm font-semibold rounded-lg transition-all duration-200 shadow-md \n                  "+(L===xe?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 text-white cursor-pointer"),onClick:()=>he(L+1),disabled:L===xe,children:["Next",(0,b.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})]})]})]}),U&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Edit Payment Type"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Invoice: ",X.saleCode," (",X.source,")"]}),(0,b.jsx)("label",{className:"block font-semibold text-gray-700 mb-2",children:"Select Payment Type"}),(0,b.jsx)(y.Ay,{options:V,value:Q,onChange:Z,placeholder:"Choose payment type",className:"mb-4"}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{className:"px-4 py-2 text-sm text-gray-600 bg-gray-200 rounded hover:bg-gray-300",onClick:()=>{G(!1),q(null),Z(null)},children:"Cancel"}),(0,b.jsx)("button",{className:"px-4 py-2 text-sm text-white bg-cyan-500 rounded hover:bg-cyan-600",onClick:async()=>{if(Q){M(!0);try{const e=localStorage.getItem("token"),t="Sale"===X.source?`api/sales/${X._id}/paymentType`:`api/pos/${X._id}/paymentType`;await g.A.put(t,{paymentType:Q.value},{headers:{Authorization:`Bearer ${e}`}}),alert("Payment type updated successfully!"),G(!1),q(null),Z(null),await le()}catch(e){console.error("Error updating payment type:",e.message),alert(`Failed to update payment type: ${e.message}`)}finally{M(!1)}}else alert("Please select a payment type.")},disabled:O,children:O?"Saving...":"Save"})]})]})})]})]}),(0,b.jsx)("style",{jsx:!0,children:"\n        @keyframes dropdown-open {\n          from {\n            opacity: 0;\n            transform: scale(0.95);\n          }\n          to {\n            opacity: 1;\n            transform: scale(1);\n          }\n        }\n        .animate-dropdown-open {\n          animation: dropdown-open 0.2s ease-in-out forwards;\n        }\n      "})]})}}}]);
//# sourceMappingURL=8718.eb9af97c.chunk.js.map