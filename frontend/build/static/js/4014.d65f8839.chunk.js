"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[4014],{14014:(e,t,a)=>{a.r(t),a.d(t,{default:()=>g});var s=a(65043),l=a(21197),n=a(59255),r=a(49804),o=a(60184),i=a(86213),c=a(26873),d=a(37762),x=a(64857),m=a(11238),u=a(66727),h=a(14840),b=a(70579);const g=()=>{const e=(0,u.Zp)(),[t,a]=(0,s.useState)("All"),[g,p]=(0,s.useState)(10),[f,j]=(0,s.useState)(""),[y,N]=(0,s.useState)(!0),[w,v]=(0,s.useState)([]),[D,S]=(0,s.useState)([]),[C,k]=(0,s.useState)(""),[A,q]=(0,s.useState)(""),[_,$]=(0,s.useState)("all"),[E,Q]=(0,s.useState)(0),[T,L]=(0,s.useState)(1),[O,z]=(0,s.useState)(!1),[I,B]=(0,s.useState)(null);(0,s.useEffect)((()=>{window.innerWidth<768&&N(!1)}),[]);const F=async()=>{const e=localStorage.getItem("token");if(e)try{z(!0);const t=await i.A.get("api/quotation",{headers:{Authorization:`Bearer ${e}`}});S(t.data)}catch(t){alert(t.message)}finally{z(!1)}else console.log("No token found redirecting...")};(0,s.useEffect)((()=>{(async()=>{const e=localStorage.getItem("token");if(e){z(!0);try{const t=await i.A.get("api/warehouses",{headers:{Authorization:`Bearer ${e}`}});if(t.data.data){const e=[{label:"All",value:"all"},...t.data.data.map((e=>({label:e.warehouseName,value:e._id})))];v(e)}}catch(t){alert(t.message)}finally{z(!1)}}else console.log("No token found redirecting...")})(),F()}),[]);const P=D.filter((e=>{var t,a,s;const l="all"===_||""===_||(null===(t=e.warehouse)||void 0===t?void 0:t._id)===_,n=(null===(a=e.customer)||void 0===a||null===(s=a.customerName)||void 0===s?void 0:s.toLowerCase().includes(f.toLowerCase()))||!1,r=!C||e.quotationDate&&new Date(e.quotationDate).toDateString()>=new Date(C).toDateString(),o=!A||e.quotationDate&&new Date(e.quotationDate).toDateString()<=new Date(A).toDateString();return l&&n&&r&&o}));(0,s.useEffect)((()=>{Q(P.reduce(((e,t)=>e+t.grandTotal),0))}),[P]);const R=Math.ceil(P.length/g),V=P.slice((T-1)*g,T*g),W=e=>{e>=1&&e<=R&&L(e)};return O?(0,b.jsx)(h.A,{}):(0,b.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,b.jsx)(l.A,{isSidebarOpen:y,setSidebarOpen:N}),(0,b.jsxs)("div",{className:"flex flex-grow",children:[(0,b.jsx)(n.A,{isSidebarOpen:y}),(0,b.jsxs)("div",{className:"flex-grow mt-24 flex flex-col p-2 md:p-2 min-h-screen "+(y?"ml-64":"ml-0"),children:[(0,b.jsxs)("header",{className:"flex flex-col items-center justify-between p-4 rounded-md shadow sm:flex-row bg-gray",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-1 text-center sm:flex-row sm:text-left",children:[(0,b.jsx)("h1",{className:"text-lg font-semibold truncate sm:text-xl",children:"Quotation List"}),(0,b.jsx)("span",{className:"text-xs text-gray-600 sm:text-sm",children:"View/Search Sold Items"})]}),(0,b.jsxs)("nav",{className:"flex flex-wrap items-center justify-center mt-2 text-xs text-gray-500 sm:justify-start sm:text-sm sm:mt-0",children:[(0,b.jsxs)("a",{href:"#",className:"flex items-center text-gray-700 no-underline hover:text-cyan-600",children:[(0,b.jsx)(o.$BV,{className:"mr-2 text-gray-500 hover:text-cyan-600"})," Home"]}),(0,b.jsx)(r.XWt,{className:"hidden mx-1 sm:mx-2 sm:inline"}),(0,b.jsx)("a",{href:"#",className:"text-gray-700 no-underline hover:text-cyan-600",children:"Quotation List"})]})]}),(0,b.jsx)("div",{className:"flex justify-end mb-4",children:(0,b.jsx)("button",{onClick:()=>e("/newquotation"),className:"px-4 py-2 mt-2 text-white transition rounded-md bg-cyan-500 hover:bg-cyan-600",children:"Create Quotation"})}),(0,b.jsx)("div",{className:"flex flex-col mb-4 md:flex-row md:items-center md:justify-between",children:(0,b.jsx)("div",{className:"flex-1 mb-4 md:mb-0",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block mb-1 font-bold text-sm/6",children:["Warehouse",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(c.Ay,{options:w,onChange:e=>$(e.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block mb-1 font-bold text-sm/6",children:"From Date"}),(0,b.jsx)("input",{type:"date",className:"w-full px-4 py-2 border rounded",onChange:e=>k(e.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block mb-1 font-bold text-sm/6",children:"To Date"}),(0,b.jsx)("input",{type:"date",className:"w-full px-4 py-2 border rounded",onChange:e=>q(e.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block mb-1 font-bold text-sm/6",children:"Users"}),(0,b.jsx)("select",{value:t,onChange:e=>a(e.target.value),className:"w-full px-4 py-2 border rounded",children:(0,b.jsx)("option",{value:"All",children:"All"})})]})]})})}),(0,b.jsxs)("div",{className:"flex flex-col items-center justify-between p-2 mt-2 bg-white rounded shadow-md md:flex-row",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"text-sm",children:"Show"}),(0,b.jsxs)("select",{value:g,onChange:e=>{p(Number(e.target.value)),L(1)},className:"p-2 border rounded",children:[(0,b.jsx)("option",{value:10,children:"10"}),(0,b.jsx)("option",{value:25,children:"25"}),(0,b.jsx)("option",{value:50,children:"50"}),(0,b.jsx)("option",{value:100,children:"100"})]}),(0,b.jsx)("span",{className:"text-sm",children:"Entries"})]}),(0,b.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-0.5 mt-1 md:mt-0",children:[(0,b.jsx)("button",{className:"w-full px-3 py-1 text-white bg-cyan-300 hover:bg-cyan-500 md:w-auto text-sm/6",onClick:()=>{const e=D.map((e=>{var t;return`${new Date(e.quotationDate).toDateString()}, ${new Date(e.expiryDate).toDateString()}, ${e.quotationCode},${e.referenceNo},${(null===(t=e.customer)||void 0===t?void 0:t.customerName)||"NA"},${e.grandTotal}`})).join("\n");navigator.clipboard.writeText(e),alert("Data copied to clipboard!")},children:"Copy"}),(0,b.jsx)("button",{className:"w-full px-3 py-1 text-white bg-cyan-300 hover:bg-cyan-500 md:w-auto text-sm/6",onClick:()=>{const e=m.utils.json_to_sheet(D),t=m.utils.book_new();m.utils.book_append_sheet(t,e,"Quotation List"),m.writeFile(t,"Quotation_list.xlsx")},children:"Excel"}),(0,b.jsx)("button",{className:"w-full px-3 py-1 text-white bg-cyan-300 hover:bg-cyan-500 md:w-auto text-sm/6",onClick:()=>{const e=new d.uE;e.text("Quotation List",20,20);const t=D.map((e=>{var t;return[new Date(e.quotationDate).toDateString(),new Date(e.expiryDate).toDateString(),e.quotationCode,e.referenceNo,(null===(t=e.customer)||void 0===t?void 0:t.customerName)||"NA",e.grandTotal]}));(0,x.Ay)(e,{head:[["Quotation Date","Expire Date","Quotation Code","Reference No.","Customer Name","Total"]],body:t}),e.save("quotation.pdf")},children:"PDF"}),(0,b.jsx)("button",{className:"w-full px-3 py-1 text-white bg-cyan-300 hover:bg-cyan-500 md:w-auto text-sm/6",onClick:()=>{window.print()},children:"Print"}),(0,b.jsx)("button",{className:"w-full px-3 py-1 text-white bg-cyan-300 hover:bg-cyan-500 md:w-auto text-sm/6",onClick:()=>{const e="data:text/csv;charset=utf-8,"+D.map((e=>Object.values(e).join(","))).join("\n"),t=encodeURI(e),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download","quotation_list.csv"),document.body.appendChild(a),a.click(),document.body.removeChild(a)},children:"CSV"}),(0,b.jsx)("input",{type:"text",placeholder:"Search",value:f,onChange:e=>j(e.target.value),className:"px-2 py-2 border rounded"})]})]}),(0,b.jsx)("div",{className:"mt-2 overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full bg-white border border-gray-300 shadow-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsx)("tr",{className:"bg-gray-400",children:["Quotation Date","Expire Date","Quotation Code","Reference No.","Customer Name","Total","Created by","Action"].map((e=>(0,b.jsx)("th",{className:"px-4 py-2 text-left border text-sm/6 sm:text-sm",children:e},e)))})}),(0,b.jsx)("tbody",{children:V.length<=0?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:"8",className:"p-4 text-center text-gray-500 border",children:"No data available in table"})}):V.map((t=>{var a;return(0,b.jsxs)("tr",{className:"bg-gray-100",children:[(0,b.jsx)("td",{className:"text-center border",children:new Date(t.quotationDate).toDateString()}),(0,b.jsx)("td",{className:"text-center border",children:t.expiryDate?new Date(t.expiryDate).toDateString():"N/A"}),(0,b.jsx)("td",{className:"text-center border",children:t.quotationCode}),(0,b.jsx)("td",{className:"text-center border",children:t.referenceNo}),(0,b.jsx)("td",{className:"text-center border",children:(null===(a=t.customer)||void 0===a?void 0:a.customerName)||"NA"}),(0,b.jsx)("td",{className:"text-center border",children:t.grandTotal}),(0,b.jsx)("td",{className:"text-center border",children:"NA"}),(0,b.jsxs)("td",{className:"text-center border relative",children:[(0,b.jsx)("button",{className:"px-2 py-1 text-white bg-gray-500 rounded hover:bg-gray-600",onClick:()=>{return e=t._id,void B(I===e?null:e);var e},children:"Action"}),I===t._id&&(0,b.jsxs)("div",{className:"absolute z-10 right-0 mt-2 w-32 bg-white border rounded shadow-lg",children:[(0,b.jsx)("button",{className:"block w-full text-left px-4 py-2 text-blue-600 hover:bg-gray-100",onClick:()=>{e(`/quotation/edit/${t._id}`),B(null)},children:"Edit"}),(0,b.jsx)("button",{className:"block w-full text-left px-4 py-2 text-red-600 hover:bg-gray-100",onClick:()=>{(async e=>{if(window.confirm("Do you want to delete this?")){z(!0);try{await i.A.delete(`api/quotation/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert("Deleted Successfully")}catch(t){console.error(t.message)}finally{await F(),z(!1)}}})(t._id),B(null)},children:"Delete"})]})]})]},t._id)}))}),V.length>0&&(0,b.jsx)("tfoot",{children:(0,b.jsx)("tr",{className:"gap-1",children:["","","","","Total",E,"",""].map(((e,t)=>(0,b.jsx)("td",{className:"border px-4 py-2 font-bold bg-gray-400 "+(4===t?"text-right":"text-left"),children:e},t)))})})]})}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,b.jsxs)("span",{children:["Showing ",g*(T-1)+1," to ",Math.min(g*T,D.length)," of ",D.length," entries"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("button",{onClick:()=>W(T-1),className:"px-4 py-2 mr-2 text-gray-600 bg-gray-300 disabled:opacity-50",disabled:1===T,children:"Previous"}),(0,b.jsx)("button",{onClick:()=>W(T+1),className:"px-4 py-2 text-gray-600 bg-gray-300 disabled:opacity-50",disabled:T===R,children:"Next"})]})]})]})]})]})}},14840:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(65043),l=a(21197),n=a(59255),r=a(70579);function o(){const[e,t]=(0,s.useState)(!1);return(0,r.jsxs)("div",{className:"flex flex-col h-screen",children:[(0,r.jsx)(l.A,{isSidebarOpen:e,setSidebarOpen:t}),(0,r.jsxs)("div",{className:"flex flex-grow mt-20",children:[(0,r.jsx)("div",{children:(0,r.jsx)(n.A,{isSidebarOpen:e})}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 rounded-full border-cyan-500 border-t-transparent animate-spin"}),(0,r.jsx)("p",{className:"mt-3 text-lg font-semibold text-gray-700",children:"Loading..."})]})})]})]})}}}]);
//# sourceMappingURL=4014.d65f8839.chunk.js.map